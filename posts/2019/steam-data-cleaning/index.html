<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="Nik Davis">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Steam Data Cleaning in Python | Nik Davis</title>

    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="alternate" type="application/atom+xml" title="Nik Davis blog atom feed" href="/feeds/all.atom.xml" />

    <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700'>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
    <link rel="stylesheet" href="/theme/css/style.css"/>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    
<!-- <link rel="stylesheet" type="text/css" href="/theme/css/ipynb.css"/> -->
<!-- <link rel="stylesheet" type="text/css" href="/theme/css/ipynb-from-download.css"/> -->
</head>

<body>
    <nav class="navbar navbar-expand-md navbar-dark">
        <a class="navbar-brand" href="/" title="Home">Nik Davis</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
            <span class="navbar-toggler-icon"></span>
        </button>
        
        <div class="collapse navbar-collapse" id="collapsibleNavbar">
            <ul class="navbar-nav ml-md-auto">
                    <li class="nav-item">
                        <a class="nav-link social" href="http://github.com/nik-davis" rel="me" target="_blank"><i class="fab fa-github"></i></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link social" href="http://twitter.com/nikdavis0" rel="me" target="_blank"><i class="fab fa-twitter"></i></a>
                    </li>                    <li class="nav-item">
                        <a class="nav-link social" href="https://www.linkedin.com/in/nik-davis" rel="me" target="_blank"><i class="fab fa-linkedin-in"></i></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link social" href="https://stackoverflow.com/users/10202890/nik-davis" rel="me" target="_blank"><i class="fab fa-stack-overflow"></i></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/pages/about.html" title="About">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/archives.html" title="Archive">Archive</a>
                    </li>
            </ul>
        </div>
    </nav>

    <div id="wrap">
<div class="container post">
    <article>
        <header>
            <h1>Steam Data Cleaning in Python</h1>
            <time datetime="article.date.isoformat()" pubdate>Tue 11 June 2019</time>
        </header>

        <div class="article_content">
            <p><em>This post forms part of a larger series on downloading, processing and analysing data from the Steam store. <a href="https://nik-davis.github.io/tag/steam.html">See all posts here</a>.</em></p>
<p><em>View original notebook on <a href="https://github.com/nik-davis/steam-data-science-project">github</a> (<a href="http://nik-davis.github.io/notebooks/steam/2-data-cleaning-steam.ipynb">Download</a>). Datasets available on <a href="https://www.kaggle.com/nikdavis/datasets">Kaggle</a>.</em></p>
<p>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://nik-davis.github.io/images/steam_logo_white.jpg" alt="steam_logo"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">


<p>In the first part of this project, we downloaded and generated data sets from the Steam Store API and SteamSpy API. We now need to take this raw data and prepare it in a process commonly referred to as <a href="https://en.wikipedia.org/wiki/Data_cleansing">data cleaning</a>.</p>
<p>Currently the downloaded data is not in a very useful state. Many of the columns contain lengthy strings or missing values, which hinder analysis and are especially crippling to any machine learning techniques we may wish to implement. Data cleaning involves handling missing values, tidying up values, and ensuring data is neatly and consistently formatted.</p>


<p>Data cleaning is often cited as being the lengthiest part of any project. As such, it will be broken up into sections. We will begin by taking care of the columns in the steam data that are easiest to deal with and outlining a framework for the process. Of course it could all be completed in one go and a lot more concisely, however we'll be stepping through all the reasons for each decision and building the process iteratively.</p>
<p>The main aims of this project are to investigate various sales and play-time statistics for games from the Steam store, and see how different features of games affect the success of those games. Keeping this in mind will help inform our decisions about how to handle the various columns in our data set, however it may be a good idea to keep columns which may not seem useful to this particular project in order to provide a robust dataset for future projects.</p>
<p>Towards the end of this section, we'll take care of columns that involve exporting data of some kind. Some columns will require much more in-depth processing and cleaning, or provide information that may be a useful topic for another time. We'll clean some of these slightly, then export them separately from the clean dataset.</p>
<p>As a separate post, we'll take a look at an optimisation problem, walking through the process of handling one particular column.</p>
<p>Once that is complete we will repeat the whole cleaning process for the SteamSpy data and combine the results, finishing with a complete data set ready for analysis.</p>
<p>To follow along or perform your own cleaning, the raw data can be found and downloaded on <a href="https://www.kaggle.com/nikdavis/steam-store-raw">Kaggle</a>.</p>
<h2 id="API-references:">API references:<a class="anchor-link" href="#API-references:">&#182;</a></h2><ul>
<li><a href="https://partner.steamgames.com/doc/webapi">https://partner.steamgames.com/doc/webapi</a></li>
<li><a href="https://wiki.teamfortress.com/wiki/User:RJackson/StorefrontAPI">https://wiki.teamfortress.com/wiki/User:RJackson/StorefrontAPI</a></li>
<li><a href="https://steamapi.xpaw.me/#">https://steamapi.xpaw.me/#</a></li>
<li><a href="https://steamspy.com/api.php">https://steamspy.com/api.php</a></li>
</ul>
<h2 id="Import-Libraries-and-Inspect-Data">Import Libraries and Inspect Data<a class="anchor-link" href="#Import-Libraries-and-Inspect-Data">&#182;</a></h2><p>To begin with, we'll import the required libraries and set customisation options, then take a look at the previously downloaded data by reading it into a pandas dataframe.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># standard library imports</span>
<span class="kn">from</span> <span class="nn">ast</span> <span class="k">import</span> <span class="n">literal_eval</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="c1"># third-party imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># customisations</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;max_columns&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># read in downloaded data</span>
<span class="n">raw_steam_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/raw/steam_app_data.csv&#39;</span><span class="p">)</span>

<span class="c1"># print out number of rows and columns</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rows:&#39;</span><span class="p">,</span> <span class="n">raw_steam_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Columns:&#39;</span><span class="p">,</span> <span class="n">raw_steam_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># view first five rows</span>
<span class="n">raw_steam_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Rows: 29235
Columns: 39
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[2]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>type</th>
      <th>name</th>
      <th>steam_appid</th>
      <th>required_age</th>
      <th>is_free</th>
      <th>controller_support</th>
      <th>dlc</th>
      <th>detailed_description</th>
      <th>about_the_game</th>
      <th>short_description</th>
      <th>fullgame</th>
      <th>supported_languages</th>
      <th>header_image</th>
      <th>website</th>
      <th>pc_requirements</th>
      <th>mac_requirements</th>
      <th>linux_requirements</th>
      <th>legal_notice</th>
      <th>drm_notice</th>
      <th>ext_user_account_notice</th>
      <th>developers</th>
      <th>publishers</th>
      <th>demos</th>
      <th>price_overview</th>
      <th>packages</th>
      <th>package_groups</th>
      <th>platforms</th>
      <th>metacritic</th>
      <th>reviews</th>
      <th>categories</th>
      <th>genres</th>
      <th>screenshots</th>
      <th>movies</th>
      <th>recommendations</th>
      <th>achievements</th>
      <th>release_date</th>
      <th>support_info</th>
      <th>background</th>
      <th>content_descriptors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>game</td>
      <td>Counter-Strike</td>
      <td>10</td>
      <td>0.0</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Play the world's number 1 online action game. ...</td>
      <td>Play the world's number 1 online action game. ...</td>
      <td>Play the world's number 1 online action game. ...</td>
      <td>NaN</td>
      <td>English&lt;strong&gt;*&lt;/strong&gt;, French&lt;strong&gt;*&lt;/st...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/10/...</td>
      <td>NaN</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>['Valve']</td>
      <td>['Valve']</td>
      <td>NaN</td>
      <td>{'currency': 'GBP', 'initial': 719, 'final': 7...</td>
      <td>[7]</td>
      <td>[{'name': 'default', 'title': 'Buy Counter-Str...</td>
      <td>{'windows': True, 'mac': True, 'linux': True}</td>
      <td>{'score': 88, 'url': 'https://www.metacritic.c...</td>
      <td>NaN</td>
      <td>[{'id': 1, 'description': 'Multi-player'}, {'i...</td>
      <td>[{'id': '1', 'description': 'Action'}]</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 65735}</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '1 Nov, 2000'}</td>
      <td>{'url': 'http://steamcommunity.com/app/10', 'e...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/10/...</td>
      <td>{'ids': [2, 5], 'notes': 'Includes intense vio...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>game</td>
      <td>Team Fortress Classic</td>
      <td>20</td>
      <td>0.0</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>One of the most popular online action games of...</td>
      <td>One of the most popular online action games of...</td>
      <td>One of the most popular online action games of...</td>
      <td>NaN</td>
      <td>English, French, German, Italian, Spanish - Sp...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/20/...</td>
      <td>NaN</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>['Valve']</td>
      <td>['Valve']</td>
      <td>NaN</td>
      <td>{'currency': 'GBP', 'initial': 399, 'final': 3...</td>
      <td>[29]</td>
      <td>[{'name': 'default', 'title': 'Buy Team Fortre...</td>
      <td>{'windows': True, 'mac': True, 'linux': True}</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[{'id': 1, 'description': 'Multi-player'}, {'i...</td>
      <td>[{'id': '1', 'description': 'Action'}]</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 2802}</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '1 Apr, 1999'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/20/...</td>
      <td>{'ids': [2, 5], 'notes': 'Includes intense vio...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>game</td>
      <td>Day of Defeat</td>
      <td>30</td>
      <td>0.0</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Enlist in an intense brand of Axis vs. Allied ...</td>
      <td>Enlist in an intense brand of Axis vs. Allied ...</td>
      <td>Enlist in an intense brand of Axis vs. Allied ...</td>
      <td>NaN</td>
      <td>English, French, German, Italian, Spanish - Spain</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/30/...</td>
      <td>http://www.dayofdefeat.com/</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>['Valve']</td>
      <td>['Valve']</td>
      <td>NaN</td>
      <td>{'currency': 'GBP', 'initial': 399, 'final': 3...</td>
      <td>[30]</td>
      <td>[{'name': 'default', 'title': 'Buy Day of Defe...</td>
      <td>{'windows': True, 'mac': True, 'linux': True}</td>
      <td>{'score': 79, 'url': 'https://www.metacritic.c...</td>
      <td>NaN</td>
      <td>[{'id': 1, 'description': 'Multi-player'}, {'i...</td>
      <td>[{'id': '1', 'description': 'Action'}]</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 1992}</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '1 May, 2003'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/30/...</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
    <tr>
      <th>3</th>
      <td>game</td>
      <td>Deathmatch Classic</td>
      <td>40</td>
      <td>0.0</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Enjoy fast-paced multiplayer gaming with Death...</td>
      <td>Enjoy fast-paced multiplayer gaming with Death...</td>
      <td>Enjoy fast-paced multiplayer gaming with Death...</td>
      <td>NaN</td>
      <td>English, French, German, Italian, Spanish - Sp...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/40/...</td>
      <td>NaN</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>['Valve']</td>
      <td>['Valve']</td>
      <td>NaN</td>
      <td>{'currency': 'GBP', 'initial': 399, 'final': 3...</td>
      <td>[31]</td>
      <td>[{'name': 'default', 'title': 'Buy Deathmatch ...</td>
      <td>{'windows': True, 'mac': True, 'linux': True}</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[{'id': 1, 'description': 'Multi-player'}, {'i...</td>
      <td>[{'id': '1', 'description': 'Action'}]</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 931}</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '1 Jun, 2001'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/40/...</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
    <tr>
      <th>4</th>
      <td>game</td>
      <td>Half-Life: Opposing Force</td>
      <td>50</td>
      <td>0.0</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Return to the Black Mesa Research Facility as ...</td>
      <td>Return to the Black Mesa Research Facility as ...</td>
      <td>Return to the Black Mesa Research Facility as ...</td>
      <td>NaN</td>
      <td>English, French, German, Korean</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/50/...</td>
      <td>NaN</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>['Gearbox Software']</td>
      <td>['Valve']</td>
      <td>NaN</td>
      <td>{'currency': 'GBP', 'initial': 399, 'final': 3...</td>
      <td>[32]</td>
      <td>[{'name': 'default', 'title': 'Buy Half-Life: ...</td>
      <td>{'windows': True, 'mac': True, 'linux': True}</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[{'id': 2, 'description': 'Single-player'}, {'...</td>
      <td>[{'id': '1', 'description': 'Action'}]</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 4355}</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '1 Nov, 1999'}</td>
      <td>{'url': 'https://help.steampowered.com', 'emai...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/50/...</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From a quick inspection of the data, we can see that we have a mixture of numeric and string columns, plenty of missing values, and a number of columns that look to be stored as dictionaries or lists.</p>
<p>We can chain the <code>isnull()</code> and <code>sum()</code> methods to easily see how many missing values we have in each column. Immediately we can see that a number of columns have over 20,000 rows with missing data, and in a data set of roughly 30,000 rows these are unlikely to provide any meaningful information.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">null_counts</span> <span class="o">=</span> <span class="n">raw_steam_data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">null_counts</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[3]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>type                         149
name                           1
steam_appid                    0
required_age                 149
is_free                      149
controller_support         23237
dlc                        24260
detailed_description         175
about_the_game               175
short_description            175
fullgame                   29235
supported_languages          163
header_image                 149
website                     9983
pc_requirements              149
mac_requirements             149
linux_requirements           149
legal_notice               19168
drm_notice                 29077
ext_user_account_notice    28723
developers                   264
publishers                   149
demos                      27096
price_overview              3712
packages                    3370
package_groups               149
platforms                    149
metacritic                 26254
reviews                    23330
categories                   714
genres                       196
screenshots                  177
movies                      2078
recommendations            22507
achievements                2381
release_date                 149
support_info                 149
background                   177
content_descriptors          149
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Initial-Processing">Initial Processing<a class="anchor-link" href="#Initial-Processing">&#182;</a></h2><p>We will most likely have to handle each column individually, so we will write some functions to keep our methodology organised, and help iteratively develop the process.</p>
<p>Our first function will remove the columns with more than 50% missing values, taking care of the columns with high null counts. We can do this by running a filter on the dataframe, as seen below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">threshold</span> <span class="o">=</span> <span class="n">raw_steam_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Drop columns with more than </span><span class="si">{}</span><span class="s1"> missing rows&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">threshold</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">drop_rows</span> <span class="o">=</span> <span class="n">raw_steam_data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">null_counts</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Columns to drop: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">drop_rows</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Drop columns with more than 14617 missing rows

Columns to drop: [&#39;controller_support&#39;, &#39;dlc&#39;, &#39;fullgame&#39;, &#39;legal_notice&#39;, &#39;drm_notice&#39;, &#39;ext_user_account_notice&#39;, &#39;demos&#39;, &#39;metacritic&#39;, &#39;reviews&#39;, &#39;recommendations&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can then look at the type and name columns, thinning out our data set a little by removing apps without either.</p>
<p>In the data collection stage, if no information was returned from an app's API request, only the name and appid was stored. We can easily identify these apps by looking at rows with missing data in the <code>type</code> column, as all other apps have a value here. As seen below, these rows contain no other information so we can safely remove them.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rows to remove:&#39;</span><span class="p">,</span> <span class="n">raw_steam_data</span><span class="p">[</span><span class="n">raw_steam_data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># preview rows with missing type data</span>
<span class="n">raw_steam_data</span><span class="p">[</span><span class="n">raw_steam_data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Rows to remove: 149
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[5]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>type</th>
      <th>name</th>
      <th>steam_appid</th>
      <th>required_age</th>
      <th>is_free</th>
      <th>controller_support</th>
      <th>dlc</th>
      <th>detailed_description</th>
      <th>about_the_game</th>
      <th>short_description</th>
      <th>fullgame</th>
      <th>supported_languages</th>
      <th>header_image</th>
      <th>website</th>
      <th>pc_requirements</th>
      <th>mac_requirements</th>
      <th>linux_requirements</th>
      <th>legal_notice</th>
      <th>drm_notice</th>
      <th>ext_user_account_notice</th>
      <th>developers</th>
      <th>publishers</th>
      <th>demos</th>
      <th>price_overview</th>
      <th>packages</th>
      <th>package_groups</th>
      <th>platforms</th>
      <th>metacritic</th>
      <th>reviews</th>
      <th>categories</th>
      <th>genres</th>
      <th>screenshots</th>
      <th>movies</th>
      <th>recommendations</th>
      <th>achievements</th>
      <th>release_date</th>
      <th>support_info</th>
      <th>background</th>
      <th>content_descriptors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>26</th>
      <td>NaN</td>
      <td>Half-Life: Opposing Force</td>
      <td>852</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>147</th>
      <td>NaN</td>
      <td>Half-Life: Opposing Force</td>
      <td>4330</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>256</th>
      <td>NaN</td>
      <td>Half-Life: Opposing Force</td>
      <td>8740</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can look at the counts of unique values in a column by using the pandas <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.value_counts.html">Series.value_counts</a> method. By checking the value counts we see that all rows either have a missing value, as noted above, or 'game' in the <code>type</code> column.</p>
<p>Once the null rows are removed, we'll be able to remove this column as it doesn't provide us with any more useful information.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">raw_steam_data</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>game    29086
NaN       149
Name: type, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Taking a look now at the name column, we can check for rows which either have a null value or a string containing 'none'. This isn't recognised as a null value but should be treated as such.</p>
<p>We achieve this by combining boolean filters using brackets and a vertical bar, <code>|</code>, symbolising a logical 'or'.</p>
<p>There are only four rows which match these criteria, and they appear to be missing a lot of data in other columns so we should definitely remove them.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">raw_steam_data</span><span class="p">[(</span><span class="n">raw_steam_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span> <span class="o">|</span> <span class="p">(</span><span class="n">raw_steam_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>type</th>
      <th>name</th>
      <th>steam_appid</th>
      <th>required_age</th>
      <th>is_free</th>
      <th>controller_support</th>
      <th>dlc</th>
      <th>detailed_description</th>
      <th>about_the_game</th>
      <th>short_description</th>
      <th>fullgame</th>
      <th>supported_languages</th>
      <th>header_image</th>
      <th>website</th>
      <th>pc_requirements</th>
      <th>mac_requirements</th>
      <th>linux_requirements</th>
      <th>legal_notice</th>
      <th>drm_notice</th>
      <th>ext_user_account_notice</th>
      <th>developers</th>
      <th>publishers</th>
      <th>demos</th>
      <th>price_overview</th>
      <th>packages</th>
      <th>package_groups</th>
      <th>platforms</th>
      <th>metacritic</th>
      <th>reviews</th>
      <th>categories</th>
      <th>genres</th>
      <th>screenshots</th>
      <th>movies</th>
      <th>recommendations</th>
      <th>achievements</th>
      <th>release_date</th>
      <th>support_info</th>
      <th>background</th>
      <th>content_descriptors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4918</th>
      <td>game</td>
      <td>none</td>
      <td>339860</td>
      <td>0.0</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>English&lt;strong&gt;*&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;*&lt;/strong...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/339...</td>
      <td>NaN</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>[]</td>
      <td>[]</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>['']</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[]</td>
      <td>{'windows': True, 'mac': False, 'linux': False}</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[{'id': 2, 'description': 'Single-player'}, {'...</td>
      <td>[{'id': '25', 'description': 'Adventure'}, {'i...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>{'total': 3, 'highlighted': [{'name': 'Master ...</td>
      <td>{'coming_soon': False, 'date': '27 Feb, 2015'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>NaN</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
    <tr>
      <th>6779</th>
      <td>game</td>
      <td>none</td>
      <td>385020</td>
      <td>0.0</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>- discontinued - (please remove)</td>
      <td>- discontinued - (please remove)</td>
      <td>- discontinued - (please remove)</td>
      <td>NaN</td>
      <td>English, French, Italian, German, Spanish - Sp...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/385...</td>
      <td>NaN</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>['none']</td>
      <td>['']</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[]</td>
      <td>{'windows': True, 'mac': True, 'linux': True}</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[{'id': 2, 'description': 'Single-player'}, {'...</td>
      <td>[{'id': '4', 'description': 'Casual'}, {'id': ...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '4 Nov, 2015'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>NaN</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
    <tr>
      <th>7235</th>
      <td>game</td>
      <td>NaN</td>
      <td>396420</td>
      <td>0.0</td>
      <td>True</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Spookeningは3Dの恐怖ゲームで、あなたは毎夜に死んでゴーストとして復活します。&lt;b...</td>
      <td>Spookeningは3Dの恐怖ゲームで、あなたは毎夜に死んでゴーストとして復活します。&lt;b...</td>
      <td>Spookeningは3Dの恐怖ゲームで、あなたは毎夜に死んでゴーストとして復活します。 村...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/396...</td>
      <td>NaN</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>[]</td>
      <td>[]</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>['']</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[]</td>
      <td>{'windows': True, 'mac': False, 'linux': False}</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '1 Nov, 2016'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>NaN</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
    <tr>
      <th>7350</th>
      <td>game</td>
      <td>none</td>
      <td>398970</td>
      <td>0.0</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>English&lt;strong&gt;*&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;*&lt;/strong...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/398...</td>
      <td>NaN</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>['none']</td>
      <td>['none']</td>
      <td>[{'appid': 516340, 'description': ''}]</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[]</td>
      <td>{'windows': True, 'mac': True, 'linux': True}</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[{'id': 2, 'description': 'Single-player'}, {'...</td>
      <td>[{'id': '25', 'description': 'Adventure'}, {'i...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>{'total': 35, 'highlighted': [{'name': "They'v...</td>
      <td>{'coming_soon': False, 'date': '5 Nov, 2015'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>NaN</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we know for certain that all AppIDs should be unique, any rows with the same ID need to be handled.</p>
<p>We can easily view duplicated rows using the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.duplicated.html">DataFrame.duplicated()</a> method of pandas. We can pass <code>keep=False</code> to view all duplicated rows, or leave the defaults (<code>keep='first'</code>) to skip over the first row and just show the rest of the duplicates. We can also pass a column label into <code>subset</code> if we want to filter by a single column.</p>
<p>As we only want to remove the extra rows, we can keep the default behaviour.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">duplicate_rows</span> <span class="o">=</span> <span class="n">raw_steam_data</span><span class="p">[</span><span class="n">raw_steam_data</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Duplicate rows to remove:&#39;</span><span class="p">,</span> <span class="n">duplicate_rows</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">duplicate_rows</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Duplicate rows to remove: 7
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[8]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>type</th>
      <th>name</th>
      <th>steam_appid</th>
      <th>required_age</th>
      <th>is_free</th>
      <th>controller_support</th>
      <th>dlc</th>
      <th>detailed_description</th>
      <th>about_the_game</th>
      <th>short_description</th>
      <th>fullgame</th>
      <th>supported_languages</th>
      <th>header_image</th>
      <th>website</th>
      <th>pc_requirements</th>
      <th>mac_requirements</th>
      <th>linux_requirements</th>
      <th>legal_notice</th>
      <th>drm_notice</th>
      <th>ext_user_account_notice</th>
      <th>developers</th>
      <th>publishers</th>
      <th>demos</th>
      <th>price_overview</th>
      <th>packages</th>
      <th>package_groups</th>
      <th>platforms</th>
      <th>metacritic</th>
      <th>reviews</th>
      <th>categories</th>
      <th>genres</th>
      <th>screenshots</th>
      <th>movies</th>
      <th>recommendations</th>
      <th>achievements</th>
      <th>release_date</th>
      <th>support_info</th>
      <th>background</th>
      <th>content_descriptors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>31</th>
      <td>game</td>
      <td>SiN Episodes: Emergence</td>
      <td>1300</td>
      <td>0.0</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>You are John Blade, commander of HardCorps, an...</td>
      <td>You are John Blade, commander of HardCorps, an...</td>
      <td>You are John Blade, commander of HardCorps, an...</td>
      <td>NaN</td>
      <td>English, Russian, French</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/130...</td>
      <td>NaN</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>[]</td>
      <td>[]</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>['Ritual Entertainment']</td>
      <td>['Ritual Entertainment']</td>
      <td>NaN</td>
      <td>{'currency': 'GBP', 'initial': 719, 'final': 7...</td>
      <td>[70]</td>
      <td>[{'name': 'default', 'title': 'Buy SiN Episode...</td>
      <td>{'windows': True, 'mac': False, 'linux': False}</td>
      <td>{'score': 75, 'url': 'https://www.metacritic.c...</td>
      <td>NaN</td>
      <td>[{'id': 2, 'description': 'Single-player'}, {'...</td>
      <td>[{'id': '1', 'description': 'Action'}]</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 265}</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '10 May, 2006'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/130...</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
    <tr>
      <th>32</th>
      <td>game</td>
      <td>SiN Episodes: Emergence</td>
      <td>1300</td>
      <td>0.0</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>You are John Blade, commander of HardCorps, an...</td>
      <td>You are John Blade, commander of HardCorps, an...</td>
      <td>You are John Blade, commander of HardCorps, an...</td>
      <td>NaN</td>
      <td>English, Russian, French</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/130...</td>
      <td>NaN</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>[]</td>
      <td>[]</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>['Ritual Entertainment']</td>
      <td>['Ritual Entertainment']</td>
      <td>NaN</td>
      <td>{'currency': 'GBP', 'initial': 719, 'final': 7...</td>
      <td>[70]</td>
      <td>[{'name': 'default', 'title': 'Buy SiN Episode...</td>
      <td>{'windows': True, 'mac': False, 'linux': False}</td>
      <td>{'score': 75, 'url': 'https://www.metacritic.c...</td>
      <td>NaN</td>
      <td>[{'id': 2, 'description': 'Single-player'}, {'...</td>
      <td>[{'id': '1', 'description': 'Action'}]</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 265}</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '10 May, 2006'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/130...</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
    <tr>
      <th>356</th>
      <td>game</td>
      <td>Jagged Alliance 2 Gold</td>
      <td>1620</td>
      <td>0.0</td>
      <td>False</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>&lt;p&gt;The small country of Arulco has been taken ...</td>
      <td>&lt;p&gt;The small country of Arulco has been taken ...</td>
      <td>The small country of Arulco has been taken ove...</td>
      <td>NaN</td>
      <td>English</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/162...</td>
      <td>http://www.jaggedalliance2.com/</td>
      <td>{'minimum': '&lt;p&gt;&lt;strong&gt;Minimum Configuration:...</td>
      <td>[]</td>
      <td>[]</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>['Strategy First']</td>
      <td>['Strategy First']</td>
      <td>NaN</td>
      <td>{'currency': 'GBP', 'initial': 1499, 'final': ...</td>
      <td>[94]</td>
      <td>[{'name': 'default', 'title': 'Buy Jagged Alli...</td>
      <td>{'windows': True, 'mac': False, 'linux': False}</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[{'id': 2, 'description': 'Single-player'}]</td>
      <td>[{'id': '2', 'description': 'Strategy'}]</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '6 Jul, 2006'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/162...</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We're now ready to define functions implementing the filters we just looked at. This allows us to easily make changes in the future if we want to alter how the columns are handled, or want to choose a different cut-off threshold for getting rid of columns, for example.</p>
<p>We also define a general purpose <code>process</code> function which will run all the processing functions we create on the data set. This will allow us to slowly add to it as we develop more functions and ensure we're cleaning the correct dataframe.</p>
<p>Finally we run this function on the raw data, inspecting the first few rows and viewing how many rows and columns have been removed.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">drop_null_cols</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Drop columns with more than a certain proportion of missing values (Default 50%).&quot;&quot;&quot;</span>
    <span class="n">cutoff_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">*</span> <span class="n">thresh</span>
    
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="n">cutoff_count</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">process_name_type</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove null values in name and type columns, and remove type column.&quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">]</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>
    

<span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Process data set. Will eventually contain calls to all functions we write.&quot;&quot;&quot;</span>
    
    <span class="c1"># Copy the input dataframe to avoid accidentally modifying original data</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="c1"># Remove duplicate rows - all appids should be unique</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
    
    <span class="c1"># Remove collumns with more than 50% null values</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">drop_null_cols</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    
    <span class="c1"># Process rest of columns</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_name_type</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>

<span class="nb">print</span><span class="p">(</span><span class="n">raw_steam_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">initial_processing</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">raw_steam_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">initial_processing</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">initial_processing</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(29235, 39)
(29075, 28)
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[9]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>steam_appid</th>
      <th>required_age</th>
      <th>is_free</th>
      <th>detailed_description</th>
      <th>about_the_game</th>
      <th>short_description</th>
      <th>supported_languages</th>
      <th>header_image</th>
      <th>website</th>
      <th>pc_requirements</th>
      <th>mac_requirements</th>
      <th>linux_requirements</th>
      <th>developers</th>
      <th>publishers</th>
      <th>price_overview</th>
      <th>packages</th>
      <th>package_groups</th>
      <th>platforms</th>
      <th>categories</th>
      <th>genres</th>
      <th>screenshots</th>
      <th>movies</th>
      <th>achievements</th>
      <th>release_date</th>
      <th>support_info</th>
      <th>background</th>
      <th>content_descriptors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Counter-Strike</td>
      <td>10</td>
      <td>0.0</td>
      <td>False</td>
      <td>Play the world's number 1 online action game. ...</td>
      <td>Play the world's number 1 online action game. ...</td>
      <td>Play the world's number 1 online action game. ...</td>
      <td>English&lt;strong&gt;*&lt;/strong&gt;, French&lt;strong&gt;*&lt;/st...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/10/...</td>
      <td>NaN</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>['Valve']</td>
      <td>['Valve']</td>
      <td>{'currency': 'GBP', 'initial': 719, 'final': 7...</td>
      <td>[7]</td>
      <td>[{'name': 'default', 'title': 'Buy Counter-Str...</td>
      <td>{'windows': True, 'mac': True, 'linux': True}</td>
      <td>[{'id': 1, 'description': 'Multi-player'}, {'i...</td>
      <td>[{'id': '1', 'description': 'Action'}]</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '1 Nov, 2000'}</td>
      <td>{'url': 'http://steamcommunity.com/app/10', 'e...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/10/...</td>
      <td>{'ids': [2, 5], 'notes': 'Includes intense vio...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Team Fortress Classic</td>
      <td>20</td>
      <td>0.0</td>
      <td>False</td>
      <td>One of the most popular online action games of...</td>
      <td>One of the most popular online action games of...</td>
      <td>One of the most popular online action games of...</td>
      <td>English, French, German, Italian, Spanish - Sp...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/20/...</td>
      <td>NaN</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>['Valve']</td>
      <td>['Valve']</td>
      <td>{'currency': 'GBP', 'initial': 399, 'final': 3...</td>
      <td>[29]</td>
      <td>[{'name': 'default', 'title': 'Buy Team Fortre...</td>
      <td>{'windows': True, 'mac': True, 'linux': True}</td>
      <td>[{'id': 1, 'description': 'Multi-player'}, {'i...</td>
      <td>[{'id': '1', 'description': 'Action'}]</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '1 Apr, 1999'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/20/...</td>
      <td>{'ids': [2, 5], 'notes': 'Includes intense vio...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Day of Defeat</td>
      <td>30</td>
      <td>0.0</td>
      <td>False</td>
      <td>Enlist in an intense brand of Axis vs. Allied ...</td>
      <td>Enlist in an intense brand of Axis vs. Allied ...</td>
      <td>Enlist in an intense brand of Axis vs. Allied ...</td>
      <td>English, French, German, Italian, Spanish - Spain</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/30/...</td>
      <td>http://www.dayofdefeat.com/</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>['Valve']</td>
      <td>['Valve']</td>
      <td>{'currency': 'GBP', 'initial': 399, 'final': 3...</td>
      <td>[30]</td>
      <td>[{'name': 'default', 'title': 'Buy Day of Defe...</td>
      <td>{'windows': True, 'mac': True, 'linux': True}</td>
      <td>[{'id': 1, 'description': 'Multi-player'}, {'i...</td>
      <td>[{'id': '1', 'description': 'Action'}]</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '1 May, 2003'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/30/...</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Deathmatch Classic</td>
      <td>40</td>
      <td>0.0</td>
      <td>False</td>
      <td>Enjoy fast-paced multiplayer gaming with Death...</td>
      <td>Enjoy fast-paced multiplayer gaming with Death...</td>
      <td>Enjoy fast-paced multiplayer gaming with Death...</td>
      <td>English, French, German, Italian, Spanish - Sp...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/40/...</td>
      <td>NaN</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>['Valve']</td>
      <td>['Valve']</td>
      <td>{'currency': 'GBP', 'initial': 399, 'final': 3...</td>
      <td>[31]</td>
      <td>[{'name': 'default', 'title': 'Buy Deathmatch ...</td>
      <td>{'windows': True, 'mac': True, 'linux': True}</td>
      <td>[{'id': 1, 'description': 'Multi-player'}, {'i...</td>
      <td>[{'id': '1', 'description': 'Action'}]</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '1 Jun, 2001'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/40/...</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Half-Life: Opposing Force</td>
      <td>50</td>
      <td>0.0</td>
      <td>False</td>
      <td>Return to the Black Mesa Research Facility as ...</td>
      <td>Return to the Black Mesa Research Facility as ...</td>
      <td>Return to the Black Mesa Research Facility as ...</td>
      <td>English, French, German, Korean</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/50/...</td>
      <td>NaN</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>['Gearbox Software']</td>
      <td>['Valve']</td>
      <td>{'currency': 'GBP', 'initial': 399, 'final': 3...</td>
      <td>[32]</td>
      <td>[{'name': 'default', 'title': 'Buy Half-Life: ...</td>
      <td>{'windows': True, 'mac': True, 'linux': True}</td>
      <td>[{'id': 2, 'description': 'Single-player'}, {'...</td>
      <td>[{'id': '1', 'description': 'Action'}]</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '1 Nov, 1999'}</td>
      <td>{'url': 'https://help.steampowered.com', 'emai...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/50/...</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Processing-Age">Processing Age<a class="anchor-link" href="#Processing-Age">&#182;</a></h2><p>Next we'll look at the <code>required_age</code> column. By looking at the value counts we can see that values are already stored as integers, and the values range from 0 to 20, with one likely error (1818). There are no missing values in this column, but the vast majority have a value of 0. We'll clean the column anyway, but this probably means it won't be of much use in analysis as there is little variance in the data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">initial_processing</span><span class="p">[</span><span class="s1">&#39;required_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[10]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.0       28431
1.0           1
3.0          10
4.0           2
5.0           1
6.0           1
7.0           8
10.0          3
11.0          4
12.0         72
13.0         21
14.0          4
15.0         39
16.0        141
17.0         47
18.0        288
20.0          1
1818.0        1
Name: required_age, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Whilst fairly useful in its current state, we may benefit from reducing the number of categories that ages fall into. For example, instead of comparing games rated as 5, 6, 7 or 8, we could compare games rated 5+ or 8+.</p>
<p>To decide which categories (or bins) we should use, we will look at the <a href="https://pegi.info/">PEGI age ratings</a> as this is the system used in the United Kingdom, where we're performing our analysis. Ratings fall into one of five categories (3, 7, 12, 16, 18), defining the minimum age recommended to play a game.</p>
<p>Using this to inform our decision, we can use the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.cut.html">pandas.cut</a> function to sort our data into each of these categories. Rows with 0 may mean they are unrated, unstated as in missing, or rated as suitable for everyone. Because we can't tell we'll leave these as they are. As the erroneous row (1818) is most likely meant to be rated 18 anyway, we can set the upper bound above this value to catch it inside this category.</p>
<p>Below we define a <code>process_age</code> function to handle this, and inspect the output.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process_age</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Format ratings in age column to be in line with the PEGI Age Ratings system.&quot;&quot;&quot;</span>
    <span class="c1"># PEGI Age ratings: 3, 7, 12, 16, 18</span>
    <span class="n">cut_points</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">2000</span><span class="p">]</span>
    <span class="n">label_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">18</span><span class="p">]</span>
    
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;required_age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;required_age&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">cut_points</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">label_values</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>


<span class="n">age_df</span> <span class="o">=</span> <span class="n">process_age</span><span class="p">(</span><span class="n">initial_processing</span><span class="p">)</span>
<span class="n">age_df</span><span class="p">[</span><span class="s1">&#39;required_age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[11]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0     28431
3        11
7        12
12       79
16      205
18      337
Name: required_age, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Processing-the-Platforms-Column">Processing the Platforms Column<a class="anchor-link" href="#Processing-the-Platforms-Column">&#182;</a></h2><p>Whilst we could look at the next column in the dataframe, <code>is_free</code>, it would make sense that this is linked to the <code>price_overview</code> column. Ultimately we may wish to combine these columns into one, where free games would have a price of 0.</p>
<p>Looking at the <code>price_overview</code> column, we can see it is stored in a dictionary-like structure, with multiple keys and values. Handling both of these together might be somewhat trickty, so instead we'll look at a simpler example.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">age_df</span><span class="p">[</span><span class="s1">&#39;price_overview&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[12]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0    {&#39;currency&#39;: &#39;GBP&#39;, &#39;initial&#39;: 719, &#39;final&#39;: 7...
1    {&#39;currency&#39;: &#39;GBP&#39;, &#39;initial&#39;: 399, &#39;final&#39;: 3...
2    {&#39;currency&#39;: &#39;GBP&#39;, &#39;initial&#39;: 399, &#39;final&#39;: 3...
3    {&#39;currency&#39;: &#39;GBP&#39;, &#39;initial&#39;: 399, &#39;final&#39;: 3...
4    {&#39;currency&#39;: &#39;GBP&#39;, &#39;initial&#39;: 399, &#39;final&#39;: 3...
Name: price_overview, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>platforms</code> column appears to contain a key for each of the main operating systems - windows, mac and linux - and a corresponding boolean value, set to True or False depending on the availability on that platform. This should be a reasonably straighforward place to start. We can separate this data out into three columns - one for each platform - filled with boolean values.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">age_df</span><span class="p">[</span><span class="s1">&#39;platforms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[13]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0    {&#39;windows&#39;: True, &#39;mac&#39;: True, &#39;linux&#39;: True}
1    {&#39;windows&#39;: True, &#39;mac&#39;: True, &#39;linux&#39;: True}
2    {&#39;windows&#39;: True, &#39;mac&#39;: True, &#39;linux&#39;: True}
3    {&#39;windows&#39;: True, &#39;mac&#39;: True, &#39;linux&#39;: True}
4    {&#39;windows&#39;: True, &#39;mac&#39;: True, &#39;linux&#39;: True}
Name: platforms, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So far the cleaning process has been relatively simple, mainly requiring checking for null values and dropping some rows or columns. Already we can see that handling the platforms will be a little more complex.</p>
<p>Our first hurdle is getting python to recognise the data in the columns as dictionaries rather than just strings. This will allow us to access the different values separately, without having to do some unnecessarily complicated string formatting. As we can see below, even though the data looks like a dictionary it is in fact stored as a string.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">platforms_first_row</span> <span class="o">=</span> <span class="n">age_df</span><span class="p">[</span><span class="s1">&#39;platforms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">platforms_first_row</span><span class="p">))</span>

<span class="n">platforms_first_row</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;str&#39;&gt;
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[14]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#34;{&#39;windows&#39;: True, &#39;mac&#39;: True, &#39;linux&#39;: True}&#34;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can get around this using the handy <a href="https://docs.python.org/3/library/ast.html#ast.literal_eval">literal_eval</a> function from the built-in <code>ast</code> module. As the name suggests, this will allow us to evaluate the string, and then index into it as a 
dictionary.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">eval_first_row</span> <span class="o">=</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">platforms_first_row</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">eval_first_row</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eval_first_row</span><span class="p">)</span>

<span class="n">eval_first_row</span><span class="p">[</span><span class="s1">&#39;windows&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;dict&#39;&gt;
{&#39;windows&#39;: True, &#39;mac&#39;: True, &#39;linux&#39;: True}
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[15]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We also need to check for missing values, but fortunately it appears there aren't any in this column.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">age_df</span><span class="p">[</span><span class="s1">&#39;platforms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[16]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As for formatting the output, let's keep things simple and return a list of supported platforms. Another option would be to create a column for each platform with a corresponding True/False value for each row, something we can keep in mind for the future.</p>
<p>We can create the desired list by calling the <a href="https://docs.python.org/3/library/stdtypes.html#str.join">str.join()</a> method on a string, and passing an iterable into the function. In this case, we can pass the keys of the row, as seen below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># create string of keys, joined on a semi-colon</span>
<span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">eval_first_row</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[17]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#39;windows;mac;linux&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We also need to inspect the value of each row, and only end up with the keys that have a value of <code>True</code>, skipping those which are <code>False</code>. The example below shows how we can do this using a list comprehension.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">platforms</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;windows&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;mac&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;linux&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>

<span class="c1"># list comprehension</span>
<span class="nb">print</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">platforms</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">platforms</span><span class="p">[</span><span class="n">x</span><span class="p">]])</span>

<span class="c1"># using list comprehension in join</span>
<span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">platforms</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">platforms</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;windows&#39;, &#39;mac&#39;]
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[18]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#39;windows;mac&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Putting this all together, we can use the pandas <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.apply.html">Series.apply</a> method to process the rows.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process_platforms</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Split platforms column into separate boolean columns for each platform.&quot;&quot;&quot;</span>
    <span class="c1"># evaluate values in platforms column, so can index into dictionaries</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">parse_platforms</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        
        <span class="n">d</span> <span class="o">=</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">platform</span> <span class="k">for</span> <span class="n">platform</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="n">platform</span><span class="p">])</span>
    
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;platforms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;platforms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">parse_platforms</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>


<span class="n">platforms_df</span> <span class="o">=</span> <span class="n">process_platforms</span><span class="p">(</span><span class="n">age_df</span><span class="p">)</span>
<span class="n">platforms_df</span><span class="p">[</span><span class="s1">&#39;platforms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[19]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>windows              19887
windows;mac;linux     4851
windows;mac           3687
windows;linux          643
mac                      5
mac;linux                1
linux                    1
Name: platforms, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Processing-Price">Processing Price<a class="anchor-link" href="#Processing-Price">&#182;</a></h2><p>Now we have built up some intuition around how to deal with data stored as dictionaries, let's return to the <code>is_free</code> and <code>price_overview</code> columns as we should now be able to handle them.</p>
<p>First let's check how many null values there are in <code>price_overview</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">platforms_df</span><span class="p">[</span><span class="s1">&#39;price_overview&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[20]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>3559</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Whilst that looks like a lot, we have to consider the impact that the <code>is_free</code> column might be having. Before jumping to conclusions let's check if there any rows with <code>is_free</code> marked as True and null values in the <code>price_overview</code> column.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">free_and_null_price</span> <span class="o">=</span> <span class="n">platforms_df</span><span class="p">[(</span><span class="n">platforms_df</span><span class="p">[</span><span class="s1">&#39;is_free&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">platforms_df</span><span class="p">[</span><span class="s1">&#39;price_overview&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())]</span>

<span class="n">free_and_null_price</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[21]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>2713</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It turns out this accounts for most of the missing values in the <code>price_overview</code> column, meaning we can handle these by setting the final price as 0. This makes intuitive sense - free games wouldn't have a price.</p>
<p>This means that there are almost 850 rows which aren't free but have null values in the <code>price_overview</code> column. Let's investigate those next.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">not_free_and_null_price</span> <span class="o">=</span> <span class="n">platforms_df</span><span class="p">[(</span><span class="n">platforms_df</span><span class="p">[</span><span class="s1">&#39;is_free&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">platforms_df</span><span class="p">[</span><span class="s1">&#39;price_overview&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())]</span>

<span class="n">not_free_and_null_price</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[22]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>steam_appid</th>
      <th>required_age</th>
      <th>is_free</th>
      <th>detailed_description</th>
      <th>about_the_game</th>
      <th>short_description</th>
      <th>supported_languages</th>
      <th>header_image</th>
      <th>website</th>
      <th>pc_requirements</th>
      <th>mac_requirements</th>
      <th>linux_requirements</th>
      <th>developers</th>
      <th>publishers</th>
      <th>price_overview</th>
      <th>packages</th>
      <th>package_groups</th>
      <th>platforms</th>
      <th>categories</th>
      <th>genres</th>
      <th>screenshots</th>
      <th>movies</th>
      <th>achievements</th>
      <th>release_date</th>
      <th>support_info</th>
      <th>background</th>
      <th>content_descriptors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>63</th>
      <td>The Ship: Single Player</td>
      <td>2420</td>
      <td>0</td>
      <td>False</td>
      <td>For PC gamers who enjoy multiplayer games with...</td>
      <td>For PC gamers who enjoy multiplayer games with...</td>
      <td>The Ship is a murder mystery alternative to tr...</td>
      <td>English, French, German, Italian, Spanish - Sp...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/242...</td>
      <td>http://www.blazinggriffin.com/games/the-ship-m...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt; 1.8 GHz...</td>
      <td>[]</td>
      <td>[]</td>
      <td>['Outerlight Ltd.']</td>
      <td>['Blazing Griffin Ltd.']</td>
      <td>NaN</td>
      <td>[56669]</td>
      <td>[{'name': 'default', 'title': 'Buy The Ship: S...</td>
      <td>windows</td>
      <td>[{'id': 2, 'description': 'Single-player'}]</td>
      <td>[{'id': '1', 'description': 'Action'}, {'id': ...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>[{'id': 2035597, 'name': 'the Ship:  Intro', '...</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '20 Nov, 2006'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/242...</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
    <tr>
      <th>75</th>
      <td>RollerCoaster Tycoon® 3: Platinum</td>
      <td>2700</td>
      <td>0</td>
      <td>False</td>
      <td>Rollercoaster Tycoon 3 Platinum combines the e...</td>
      <td>Rollercoaster Tycoon 3 Platinum combines the e...</td>
      <td>Rollercoaster Tycoon 3 Platinum combines the e...</td>
      <td>English, French, Italian, German, Spanish - Sp...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/270...</td>
      <td>http://www.atari.com/rollercoastertycoon/us/in...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum: &lt;/strong&gt;&lt;br&gt;\t\...</td>
      <td>{'minimum': '&lt;ul class="bb_ul"&gt;&lt;li&gt;&lt;strong&gt;OS:...</td>
      <td>[]</td>
      <td>['Frontier', 'Aspyr (Mac)']</td>
      <td>['Atari', 'Aspyr (Mac)']</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[]</td>
      <td>windows;mac</td>
      <td>[{'id': 2, 'description': 'Single-player'}]</td>
      <td>[{'id': '28', 'description': 'Simulation'}, {'...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '12 Mar, 2008'}</td>
      <td>{'url': 'http://www.atari.com/support/atari', ...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/270...</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
    <tr>
      <th>220</th>
      <td>BioShock™</td>
      <td>7670</td>
      <td>0</td>
      <td>False</td>
      <td>&lt;h1&gt;Special Offer&lt;/h1&gt;&lt;p&gt;Buying BioShock™ also...</td>
      <td>BioShock is a shooter unlike any you've ever p...</td>
      <td>BioShock is a shooter unlike any you've ever p...</td>
      <td>English&lt;strong&gt;*&lt;/strong&gt;, French&lt;strong&gt;*&lt;/st...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/767...</td>
      <td>http://www.BioShockGame.com</td>
      <td>{'minimum': '&lt;h2 class="bb_tag"&gt;&lt;strong&gt;Minimu...</td>
      <td>{'minimum': 'Please See BioShock Remastered'}</td>
      <td>[]</td>
      <td>['2K Boston', '2K Australia']</td>
      <td>['2K']</td>
      <td>NaN</td>
      <td>[451, 127633]</td>
      <td>[{'name': 'default', 'title': 'Buy BioShock™',...</td>
      <td>windows</td>
      <td>[{'id': 2, 'description': 'Single-player'}, {'...</td>
      <td>[{'id': '1', 'description': 'Action'}, {'id': ...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '21 Aug, 2007'}</td>
      <td>{'url': 'support.2k.com', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/767...</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
    <tr>
      <th>234</th>
      <td>Sam &amp; Max 101: Culture Shock</td>
      <td>8200</td>
      <td>0</td>
      <td>False</td>
      <td>&lt;strong&gt;Sam &amp;amp; Max: Episode 1 - Culture Sho...</td>
      <td>&lt;strong&gt;Sam &amp;amp; Max: Episode 1 - Culture Sho...</td>
      <td>Sam &amp;amp; Max: Episode 1 - Culture Shock - The...</td>
      <td>English, French, German, Italian</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/820...</td>
      <td>http://store.steampowered.com/app/901660/</td>
      <td>{'minimum': 'Windows XP or Vista, 1.5GHz proce...</td>
      <td>[]</td>
      <td>[]</td>
      <td>['Telltale Games']</td>
      <td>['Telltale Games']</td>
      <td>NaN</td>
      <td>[357, 539]</td>
      <td>[{'name': 'default', 'title': 'Buy Sam &amp; Max 1...</td>
      <td>windows</td>
      <td>[{'id': 2, 'description': 'Single-player'}]</td>
      <td>[{'id': '1', 'description': 'Action'}, {'id': ...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '15 Jun, 2007'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/820...</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
    <tr>
      <th>235</th>
      <td>Sam &amp; Max 102: Situation: Comedy</td>
      <td>8210</td>
      <td>0</td>
      <td>False</td>
      <td>&lt;strong&gt;Sam &amp;amp; Max: Episode 2 - Situation: ...</td>
      <td>&lt;strong&gt;Sam &amp;amp; Max: Episode 2 - Situation: ...</td>
      <td>Sam &amp;amp; Max: Episode 2 - Situation: Comedy -...</td>
      <td>English, German, Italian</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/821...</td>
      <td>http://store.steampowered.com/app/901660/</td>
      <td>{'minimum': 'Windows XP or Vista, 1.5GHz proce...</td>
      <td>[]</td>
      <td>[]</td>
      <td>['Telltale Games']</td>
      <td>['Telltale Games']</td>
      <td>NaN</td>
      <td>[358, 539]</td>
      <td>[{'name': 'default', 'title': 'Buy Sam &amp; Max 1...</td>
      <td>windows</td>
      <td>[{'id': 2, 'description': 'Single-player'}]</td>
      <td>[{'id': '1', 'description': 'Action'}, {'id': ...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '15 Jun, 2007'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/821...</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first few rows contain some big, well-known games which appear to have pretty complete data. It looks like we can rule out data errors, so let's dig a little deeper and see if we can find out what is going on.</p>
<p>We'll start by looking at the store pages for some of these titles. The url to an app on the steam website follows this structure:</p>

<pre><code>https://store.steampowered.com/app/[steam_appid]

</code></pre>
<p>This means we can easily generate these links using our above filter. We'll wrap it up in a function in case we want to use it later.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">print_steam_links</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Print links to store page for apps in a dataframe.&quot;&quot;&quot;</span>
    <span class="n">url_base</span> <span class="o">=</span> <span class="s2">&quot;https://store.steampowered.com/app/&quot;</span>
    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">appid</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;steam_appid&#39;</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">url_base</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">appid</span><span class="p">))</span>
        

<span class="n">print_steam_links</span><span class="p">(</span><span class="n">not_free_and_null_price</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>The Ship: Single Player: https://store.steampowered.com/app/2420
RollerCoaster Tycoon® 3: Platinum: https://store.steampowered.com/app/2700
BioShock™: https://store.steampowered.com/app/7670
Sam &amp; Max 101: Culture Shock: https://store.steampowered.com/app/8200
Sam &amp; Max 102: Situation: Comedy: https://store.steampowered.com/app/8210
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For these games we can conclude that:</p>
<ul>
<li>The Ship: Single Player is a tutorial, and comes as part of The Ship: Murder Party</li>
<li>RollerCoaster Tycoon 3: Platinum has been removed from steam (and another game website: <a href="https://www.gog.com/">GOG</a>)  <ul>
<li>"A spokesperson for GOG told Eurogamer it pulled the game "due to expiring licensing rights", and stressed it'll talk with "new distribution rights holders" to bring the game back as soon as possible." Source: <a href="https://www.eurogamer.net/articles/2018-05-09-rollercoaster-tycoon-3-pulled-from-steam-gog">Eurogamer</a></li>
</ul>
</li>
<li>BioShock has been replaced by BioShock Remastered</li>
<li>Sam &amp; Max 101 is sold as part of a season, and this can be found in the <code>package_groups</code> column</li>
</ul>
<p>So we have a couple of options here. We could just drop these rows, we could try to figure out the price based on the <code>package_groups</code> column, or we could leave them for now and return to them later. We'll leave them for now, handling the two price columns, then take a look at the packages next. It may also be that some of these rows are removed later in the cleaning process for other reasons.</p>
<p>If we want to find rows similar to these and deal with each case individually, we could use the <code>.str.contains()</code> method, as seen below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">platforms_df</span><span class="p">[</span><span class="n">platforms_df</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;BioShock™&quot;</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[24]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>steam_appid</th>
      <th>required_age</th>
      <th>is_free</th>
      <th>detailed_description</th>
      <th>about_the_game</th>
      <th>short_description</th>
      <th>supported_languages</th>
      <th>header_image</th>
      <th>website</th>
      <th>pc_requirements</th>
      <th>mac_requirements</th>
      <th>linux_requirements</th>
      <th>developers</th>
      <th>publishers</th>
      <th>price_overview</th>
      <th>packages</th>
      <th>package_groups</th>
      <th>platforms</th>
      <th>categories</th>
      <th>genres</th>
      <th>screenshots</th>
      <th>movies</th>
      <th>achievements</th>
      <th>release_date</th>
      <th>support_info</th>
      <th>background</th>
      <th>content_descriptors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>220</th>
      <td>BioShock™</td>
      <td>7670</td>
      <td>0</td>
      <td>False</td>
      <td>&lt;h1&gt;Special Offer&lt;/h1&gt;&lt;p&gt;Buying BioShock™ also...</td>
      <td>BioShock is a shooter unlike any you've ever p...</td>
      <td>BioShock is a shooter unlike any you've ever p...</td>
      <td>English&lt;strong&gt;*&lt;/strong&gt;, French&lt;strong&gt;*&lt;/st...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/767...</td>
      <td>http://www.BioShockGame.com</td>
      <td>{'minimum': '&lt;h2 class="bb_tag"&gt;&lt;strong&gt;Minimu...</td>
      <td>{'minimum': 'Please See BioShock Remastered'}</td>
      <td>[]</td>
      <td>['2K Boston', '2K Australia']</td>
      <td>['2K']</td>
      <td>NaN</td>
      <td>[451, 127633]</td>
      <td>[{'name': 'default', 'title': 'Buy BioShock™',...</td>
      <td>windows</td>
      <td>[{'id': 2, 'description': 'Single-player'}, {'...</td>
      <td>[{'id': '1', 'description': 'Action'}, {'id': ...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '21 Aug, 2007'}</td>
      <td>{'url': 'support.2k.com', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/767...</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
    <tr>
      <th>7734</th>
      <td>BioShock™ Remastered</td>
      <td>409710</td>
      <td>18</td>
      <td>False</td>
      <td>&lt;h1&gt;Special Offer&lt;/h1&gt;&lt;p&gt;Buying BioShock™ Rema...</td>
      <td>BioShock is a shooter unlike any you've ever p...</td>
      <td>BioShock is a shooter unlike any other, loaded...</td>
      <td>English&lt;strong&gt;*&lt;/strong&gt;, French&lt;strong&gt;*&lt;/st...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/409...</td>
      <td>http://www.BioShockGame.com</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>['2K Boston', '2K Australia', 'Blind Squirrel'...</td>
      <td>['2K', 'Feral Interactive (Mac)']</td>
      <td>{'currency': 'GBP', 'initial': 999, 'final': 9...</td>
      <td>[451, 127633]</td>
      <td>[{'name': 'default', 'title': 'Buy BioShock™ R...</td>
      <td>windows;mac</td>
      <td>[{'id': 2, 'description': 'Single-player'}, {'...</td>
      <td>[{'id': '1', 'description': 'Action'}, {'id': ...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 65, 'highlighted': [{'name': 'Comple...</td>
      <td>{'coming_soon': False, 'date': '15 Sep, 2016'}</td>
      <td>{'url': 'support.2k.com', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/409...</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
    <tr>
      <th>7735</th>
      <td>BioShock™ 2 Remastered</td>
      <td>409720</td>
      <td>18</td>
      <td>False</td>
      <td>&lt;h1&gt;Special Offer&lt;/h1&gt;&lt;p&gt;Buying BioShock 2™ Re...</td>
      <td>BioShock 2 provides players with the perfect b...</td>
      <td>In BioShock 2, you step into the boots of the ...</td>
      <td>English&lt;strong&gt;*&lt;/strong&gt;, French&lt;strong&gt;*&lt;/st...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/409...</td>
      <td>http://www.bioshockgame.com/</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>['2K Marin', '2K China', 'Digital Extremes', '...</td>
      <td>['2K']</td>
      <td>{'currency': 'GBP', 'initial': 1399, 'final': ...</td>
      <td>[81419, 127633]</td>
      <td>[{'name': 'default', 'title': 'Buy BioShock™ 2...</td>
      <td>windows</td>
      <td>[{'id': 2, 'description': 'Single-player'}, {'...</td>
      <td>[{'id': '1', 'description': 'Action'}, {'id': ...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 53, 'highlighted': [{'name': "Daddy'...</td>
      <td>{'coming_soon': False, 'date': '15 Sep, 2016'}</td>
      <td>{'url': 'support.2k.com', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/409...</td>
      <td>{'ids': [5], 'notes': None}</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we need to figure out how to process the column.</p>
<p>If we take a look at the data for the first row, we can see that there are a variety of formats in which the price is stored. There is a currency, GBP, which is perfect as we are performing our analysis in the UK. Next we have a number of different values for the price, so which one do we use?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">platforms_df</span><span class="p">[</span><span class="s1">&#39;price_overview&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[25]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#34;{&#39;currency&#39;: &#39;GBP&#39;, &#39;initial&#39;: 719, &#39;final&#39;: 719, &#39;discount_percent&#39;: 0, &#39;initial_formatted&#39;: &#39;&#39;, &#39;final_formatted&#39;: &#39;£7.19&#39;}&#34;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we inspect another row, we see that there is an active discount, applying an 80% price reduction to the title. It looks like <code>initial</code> contains the normal price before discount, and <code>final</code> contains the discounted price. <code>initial_formatted</code> and <code>final_formatted</code> contain the price formatted and displayed in the currency. We don't have to worry about these last two, as we'll be storing the price as a float (or integer) and if we wanted, we could format it like this when printing.</p>
<p>With all this in mind, it looks like we'll be checking the value under the <code>currency</code> key, and using the value in the <code>initial</code> key.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">platforms_df</span><span class="p">[</span><span class="s1">&#39;price_overview&#39;</span><span class="p">][</span><span class="mi">37</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[26]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#34;{&#39;currency&#39;: &#39;GBP&#39;, &#39;initial&#39;: 2299, &#39;final&#39;: 459, &#39;discount_percent&#39;: 80, &#39;initial_formatted&#39;: &#39;£22.99&#39;, &#39;final_formatted&#39;: &#39;£4.59&#39;}&#34;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now the preliminary investigation is complete we can begin definining our function.</p>
<p>We start by evaluating the strings using <code>literal_eval</code> as before, however if there is a null value we return a properly formatted dictionary with -1 for the <code>initial</code> value. This will allow us to fill in a value of 0 for free games, then be left with an easily targetable value for the actual null rows.</p>
<p>Next we create <code>currency</code> and <code>price</code> columns from the dictionary in the <code>price_overview</code> column. We define an anonymous function on the fly using a <a href="https://docs.python.org/3/tutorial/controlflow.html?highlight=lambda#lambda-expressions">lambda</a> expression, returning the value in each key.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process_price</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">parse_price</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;currency&#39;</span><span class="p">:</span> <span class="s1">&#39;GBP&#39;</span><span class="p">,</span> <span class="s1">&#39;initial&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
    
    <span class="c1"># evaluate as dictionary and set to -1 if missing</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;price_overview&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;price_overview&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">parse_price</span><span class="p">)</span>
    
    <span class="c1"># Create columns from currency and initial values</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;currency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;price_overview&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;currency&#39;</span><span class="p">])</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;price_overview&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;initial&#39;</span><span class="p">])</span>
    
    <span class="c1"># Set price of free games to 0</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;is_free&#39;</span><span class="p">],</span> <span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">return</span> <span class="n">df</span>

<span class="n">price_data</span> <span class="o">=</span> <span class="n">process_price</span><span class="p">(</span><span class="n">platforms_df</span><span class="p">)[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;currency&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">]]</span>
<span class="n">price_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[27]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>currency</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Counter-Strike</td>
      <td>GBP</td>
      <td>719</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Team Fortress Classic</td>
      <td>GBP</td>
      <td>399</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Day of Defeat</td>
      <td>GBP</td>
      <td>399</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Deathmatch Classic</td>
      <td>GBP</td>
      <td>399</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Half-Life: Opposing Force</td>
      <td>GBP</td>
      <td>399</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We're almost finished, but let's check if any games don't have GBP listed as the currency.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">price_data</span><span class="p">[</span><span class="n">price_data</span><span class="p">[</span><span class="s1">&#39;currency&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;GBP&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[28]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>currency</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>991</th>
      <td>Robin Hood: The Legend of Sherwood</td>
      <td>USD</td>
      <td>799</td>
    </tr>
    <tr>
      <th>5767</th>
      <td>Assassin’s Creed® Chronicles: India</td>
      <td>EUR</td>
      <td>999</td>
    </tr>
    <tr>
      <th>27593</th>
      <td>Mortal Kombat 11</td>
      <td>USD</td>
      <td>5999</td>
    </tr>
    <tr>
      <th>27995</th>
      <td>Pagan Online</td>
      <td>EUR</td>
      <td>2699</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For some reason there are four games listed in either USD or EUR. We could use the current exchange rate to try and convert them into GBP, however as there are only four rows it's easier and safer to simply drop them.</p>
<p>We can also divide the prices by 100 so they are displayed as floats in pounds.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process_price</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Process price_overview column into formatted price column.&quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">parse_price</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;currency&#39;</span><span class="p">:</span> <span class="s1">&#39;GBP&#39;</span><span class="p">,</span> <span class="s1">&#39;initial&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
    
    <span class="c1"># evaluate as dictionary and set to -1 if missing</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;price_overview&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;price_overview&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">parse_price</span><span class="p">)</span>
    
    <span class="c1"># create columns from currency and initial values</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;currency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;price_overview&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;currency&#39;</span><span class="p">])</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;price_overview&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;initial&#39;</span><span class="p">])</span>
    
    <span class="c1"># set price of free games to 0</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;is_free&#39;</span><span class="p">],</span> <span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="c1"># remove non-GBP rows</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;currency&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;GBP&#39;</span><span class="p">]</span>
    
    <span class="c1"># change price to display in pounds (only applying to rows with a value greater than 0)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">/=</span> <span class="mi">100</span>
    
    <span class="c1"># remove columns no longer needed</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;is_free&#39;</span><span class="p">,</span> <span class="s1">&#39;currency&#39;</span><span class="p">,</span> <span class="s1">&#39;price_overview&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>


<span class="n">price_df</span> <span class="o">=</span> <span class="n">process_price</span><span class="p">(</span><span class="n">platforms_df</span><span class="p">)</span>
<span class="n">price_df</span><span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[29]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Counter-Strike</td>
      <td>7.19</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Team Fortress Classic</td>
      <td>3.99</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Day of Defeat</td>
      <td>3.99</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Deathmatch Classic</td>
      <td>3.99</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Half-Life: Opposing Force</td>
      <td>3.99</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Processing-Packages">Processing Packages<a class="anchor-link" href="#Processing-Packages">&#182;</a></h2><p>We can now take a look at the <code>packages</code> and <code>package_groups</code> columns to help decide what to do with rows that are missing price data. We're not incredibly interested in the columns themselves, as they don't appear to provide much new useful information, except which games come with others as part of a bundle.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># temporarily set a pandas option using with and option_context</span>
<span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">option_context</span><span class="p">(</span><span class="s2">&quot;display.max_colwidth&quot;</span><span class="p">,</span> <span class="mi">500</span><span class="p">):</span>
    <span class="n">display</span><span class="p">(</span><span class="n">price_df</span><span class="p">[[</span><span class="s1">&#39;steam_appid&#39;</span><span class="p">,</span> <span class="s1">&#39;packages&#39;</span><span class="p">,</span> <span class="s1">&#39;package_groups&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>steam_appid</th>
      <th>packages</th>
      <th>package_groups</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>[7]</td>
      <td>[{'name': 'default', 'title': 'Buy Counter-Strike', 'description': '', 'selection_text': 'Select a purchase option', 'save_text': '', 'display_type': 0, 'is_recurring_subscription': 'false', 'subs': [{'packageid': 7, 'percent_savings_text': '', 'percent_savings': 0, 'option_text': 'Counter-Strike: Condition Zero - £7.19', 'option_description': '', 'can_get_free_license': '0', 'is_free_license': False, 'price_in_cents_with_discount': 719}]}]</td>
      <td>7.19</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>[29]</td>
      <td>[{'name': 'default', 'title': 'Buy Team Fortress Classic', 'description': '', 'selection_text': 'Select a purchase option', 'save_text': '', 'display_type': 0, 'is_recurring_subscription': 'false', 'subs': [{'packageid': 29, 'percent_savings_text': '', 'percent_savings': 0, 'option_text': 'Team Fortress Classic - £3.99', 'option_description': '', 'can_get_free_license': '0', 'is_free_license': False, 'price_in_cents_with_discount': 399}]}]</td>
      <td>3.99</td>
    </tr>
    <tr>
      <th>2</th>
      <td>30</td>
      <td>[30]</td>
      <td>[{'name': 'default', 'title': 'Buy Day of Defeat', 'description': '', 'selection_text': 'Select a purchase option', 'save_text': '', 'display_type': 0, 'is_recurring_subscription': 'false', 'subs': [{'packageid': 30, 'percent_savings_text': '', 'percent_savings': 0, 'option_text': 'Day of Defeat - £3.99', 'option_description': '', 'can_get_free_license': '0', 'is_free_license': False, 'price_in_cents_with_discount': 399}]}]</td>
      <td>3.99</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Overall we have 846 rows with missing price data, which we previously set to -1.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">price_df</span><span class="p">[</span><span class="n">price_df</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>846
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can split these rows into two categories: those with <code>package_groups</code> data and those without.</p>
<p>If we take a quick look at the <code>package_groups</code> column we see that there appear to be no null values. On closer inspection, we can find that rows without data are actually stored as empty lists.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Null counts:&#39;</span><span class="p">,</span> <span class="n">price_df</span><span class="p">[</span><span class="s1">&#39;package_groups&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Empty list counts:&#39;</span><span class="p">,</span> <span class="n">price_df</span><span class="p">[</span><span class="n">price_df</span><span class="p">[</span><span class="s1">&#39;package_groups&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;[]&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Null counts: 0
Empty list counts: 3353
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using a combination of filters, we can find out how many rows have both missing <code>price</code> and <code>package_group</code> data and investigate. We'll count the rows and print links to some of the store pages and look for patterns.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">missing_price_and_package</span> <span class="o">=</span> <span class="n">price_df</span><span class="p">[(</span><span class="n">price_df</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">price_df</span><span class="p">[</span><span class="s1">&#39;package_groups&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;[]&quot;</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of rows:&#39;</span><span class="p">,</span> <span class="n">missing_price_and_package</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First few rows:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">print_steam_links</span><span class="p">(</span><span class="n">missing_price_and_package</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Last few rows:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">print_steam_links</span><span class="p">(</span><span class="n">missing_price_and_package</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:</span><span class="o">-</span><span class="mi">5</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of rows: 799 

First few rows:

RollerCoaster Tycoon® 3: Platinum: https://store.steampowered.com/app/2700
Beijing 2008™ - The Official Video Game of the Olympic Games: https://store.steampowered.com/app/10520
LUMINES™ Advance Pack: https://store.steampowered.com/app/11920
Midnight Club 2: https://store.steampowered.com/app/12160
Age of Booty™: https://store.steampowered.com/app/21600

Last few rows:

RoboVirus: https://store.steampowered.com/app/1001870
soko loco deluxe: https://store.steampowered.com/app/1003730
POCKET CAR : VRGROUND: https://store.steampowered.com/app/1004710
The Princess, the Stray Cat, and Matters of the Heart: https://store.steampowered.com/app/1010600
Mr Boom&#39;s Firework Factory: https://store.steampowered.com/app/1013670
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Most of the games - 799 of 846 - with missing price data fall into the above category. This probably means they can be safely removed.</p>
<p>From following the links for the first few rows to the store page, it looks like they are currently unavailable or have been delisted from the store. Looking at the last few rows, it appears most of them haven't yet been released and haven't had a price set. We'll take care of all the unreleased games when we clean the <code>release_date</code> column, but we can remove all of these apps here.</p>
<p>Let's now take a look at the rows that have missing price data but do have <code>package_groups</code> data. We may be interested in keeping these rows and extracting price data from the package data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">missing_price_have_package</span> <span class="o">=</span> <span class="n">price_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">price_df</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">price_df</span><span class="p">[</span><span class="s1">&#39;package_groups&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;[]&quot;</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;steam_appid&#39;</span><span class="p">,</span> <span class="s1">&#39;package_groups&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">]]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of rows:&#39;</span><span class="p">,</span> <span class="n">missing_price_have_package</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First few rows:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">print_steam_links</span><span class="p">(</span><span class="n">missing_price_have_package</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Last few rows:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">print_steam_links</span><span class="p">(</span><span class="n">missing_price_have_package</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:</span><span class="o">-</span><span class="mi">5</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of rows: 47 

First few rows:

The Ship: Single Player: https://store.steampowered.com/app/2420
BioShock™: https://store.steampowered.com/app/7670
Sam &amp; Max 101: Culture Shock: https://store.steampowered.com/app/8200
Sam &amp; Max 102: Situation: Comedy: https://store.steampowered.com/app/8210
Sam &amp; Max 103: The Mole, the Mob and the Meatball: https://store.steampowered.com/app/8220

Last few rows:

Viscera Cleanup Detail: Shadow Warrior: https://store.steampowered.com/app/255520
Space Hulk: Deathwing: https://store.steampowered.com/app/298900
7,62 Hard Life: https://store.steampowered.com/app/306290
Letter Quest: Grimm&#39;s Journey: https://store.steampowered.com/app/328730
Rad Rodgers: World One: https://store.steampowered.com/app/353580
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Looking at a selection of these rows, the games appear to be: supersceded by a newer release or remaster, part of a bigger bundle of games or episodic, or included by purchasing another game.</p>
<p>Whilst we could extract prices from the <code>package_groups</code> data, the most sensible option seems to be removing these rows. There are only 47 rows this applies to, and any with a newer release will still have the re-release in the data.</p>
<p>Since our logic interacts heavily with the price data we will update the <code>process_price</code> function rather than creating a new one.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process_price</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Process price_overview column into formatted price column, and take care of package columns.&quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">parse_price</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;currency&#39;</span><span class="p">:</span> <span class="s1">&#39;GBP&#39;</span><span class="p">,</span> <span class="s1">&#39;initial&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
    
    <span class="c1"># evaluate as dictionary and set to -1 if missing</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;price_overview&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;price_overview&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">parse_price</span><span class="p">)</span>
    
    <span class="c1"># create columns from currency and initial values</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;currency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;price_overview&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;currency&#39;</span><span class="p">])</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;price_overview&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;initial&#39;</span><span class="p">])</span>
    
    <span class="c1"># set price of free games to 0</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;is_free&#39;</span><span class="p">],</span> <span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="c1"># remove non-GBP rows</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;currency&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;GBP&#39;</span><span class="p">]</span>
    
    <span class="c1"># remove rows where price is -1</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="c1"># change price to display in pounds (can apply to all now -1 rows removed)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">/=</span> <span class="mi">100</span>
    
    <span class="c1"># remove columns no longer needed</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;is_free&#39;</span><span class="p">,</span> <span class="s1">&#39;currency&#39;</span><span class="p">,</span> <span class="s1">&#39;price_overview&#39;</span><span class="p">,</span> <span class="s1">&#39;packages&#39;</span><span class="p">,</span> <span class="s1">&#39;package_groups&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>


<span class="n">price_df</span> <span class="o">=</span> <span class="n">process_price</span><span class="p">(</span><span class="n">platforms_df</span><span class="p">)</span>
<span class="n">price_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[35]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>steam_appid</th>
      <th>required_age</th>
      <th>detailed_description</th>
      <th>about_the_game</th>
      <th>short_description</th>
      <th>supported_languages</th>
      <th>header_image</th>
      <th>website</th>
      <th>pc_requirements</th>
      <th>mac_requirements</th>
      <th>linux_requirements</th>
      <th>developers</th>
      <th>publishers</th>
      <th>platforms</th>
      <th>categories</th>
      <th>genres</th>
      <th>screenshots</th>
      <th>movies</th>
      <th>achievements</th>
      <th>release_date</th>
      <th>support_info</th>
      <th>background</th>
      <th>content_descriptors</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Counter-Strike</td>
      <td>10</td>
      <td>0</td>
      <td>Play the world's number 1 online action game. ...</td>
      <td>Play the world's number 1 online action game. ...</td>
      <td>Play the world's number 1 online action game. ...</td>
      <td>English&lt;strong&gt;*&lt;/strong&gt;, French&lt;strong&gt;*&lt;/st...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/10/...</td>
      <td>NaN</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>['Valve']</td>
      <td>['Valve']</td>
      <td>windows;mac;linux</td>
      <td>[{'id': 1, 'description': 'Multi-player'}, {'i...</td>
      <td>[{'id': '1', 'description': 'Action'}]</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '1 Nov, 2000'}</td>
      <td>{'url': 'http://steamcommunity.com/app/10', 'e...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/10/...</td>
      <td>{'ids': [2, 5], 'notes': 'Includes intense vio...</td>
      <td>7.19</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Team Fortress Classic</td>
      <td>20</td>
      <td>0</td>
      <td>One of the most popular online action games of...</td>
      <td>One of the most popular online action games of...</td>
      <td>One of the most popular online action games of...</td>
      <td>English, French, German, Italian, Spanish - Sp...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/20/...</td>
      <td>NaN</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>['Valve']</td>
      <td>['Valve']</td>
      <td>windows;mac;linux</td>
      <td>[{'id': 1, 'description': 'Multi-player'}, {'i...</td>
      <td>[{'id': '1', 'description': 'Action'}]</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '1 Apr, 1999'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/20/...</td>
      <td>{'ids': [2, 5], 'notes': 'Includes intense vio...</td>
      <td>3.99</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Day of Defeat</td>
      <td>30</td>
      <td>0</td>
      <td>Enlist in an intense brand of Axis vs. Allied ...</td>
      <td>Enlist in an intense brand of Axis vs. Allied ...</td>
      <td>Enlist in an intense brand of Axis vs. Allied ...</td>
      <td>English, French, German, Italian, Spanish - Spain</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/30/...</td>
      <td>http://www.dayofdefeat.com/</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>['Valve']</td>
      <td>['Valve']</td>
      <td>windows;mac;linux</td>
      <td>[{'id': 1, 'description': 'Multi-player'}, {'i...</td>
      <td>[{'id': '1', 'description': 'Action'}]</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '1 May, 2003'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/30/...</td>
      <td>{'ids': [], 'notes': None}</td>
      <td>3.99</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Deathmatch Classic</td>
      <td>40</td>
      <td>0</td>
      <td>Enjoy fast-paced multiplayer gaming with Death...</td>
      <td>Enjoy fast-paced multiplayer gaming with Death...</td>
      <td>Enjoy fast-paced multiplayer gaming with Death...</td>
      <td>English, French, German, Italian, Spanish - Sp...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/40/...</td>
      <td>NaN</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>['Valve']</td>
      <td>['Valve']</td>
      <td>windows;mac;linux</td>
      <td>[{'id': 1, 'description': 'Multi-player'}, {'i...</td>
      <td>[{'id': '1', 'description': 'Action'}]</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '1 Jun, 2001'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/40/...</td>
      <td>{'ids': [], 'notes': None}</td>
      <td>3.99</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Half-Life: Opposing Force</td>
      <td>50</td>
      <td>0</td>
      <td>Return to the Black Mesa Research Facility as ...</td>
      <td>Return to the Black Mesa Research Facility as ...</td>
      <td>Return to the Black Mesa Research Facility as ...</td>
      <td>English, French, German, Korean</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/50/...</td>
      <td>NaN</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>['Gearbox Software']</td>
      <td>['Valve']</td>
      <td>windows;mac;linux</td>
      <td>[{'id': 2, 'description': 'Single-player'}, {'...</td>
      <td>[{'id': '1', 'description': 'Action'}]</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '1 Nov, 1999'}</td>
      <td>{'url': 'https://help.steampowered.com', 'emai...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/50/...</td>
      <td>{'ids': [], 'notes': None}</td>
      <td>3.99</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The next columns in the data are descriptive columns - <code>detailed_description</code>, <code>about_the_game</code> and <code>short_description</code>. We won't be handling them now, instead returning to them later on when we deal with export columns. These are columns where we will export all or some of the data to a separate csv file as part of the cleaning.</p>
<h2 id="Processing-Langauges">Processing Langauges<a class="anchor-link" href="#Processing-Langauges">&#182;</a></h2><p>Beyond that, the next column is <code>supported_languages</code>. As we will be performing the analysis for an English company, we will only be interested in games available in English. Whilst we could remove non-english game at this stage, instead we will create a column marking english games with a boolean value - True or False.</p>
<p>We begin as usual by looking for rows with null values.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">price_df</span><span class="p">[</span><span class="s1">&#39;supported_languages&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[36]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>4</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Taking a closer look at these apps, it doesn't look like there's anything wrong with them. It may be that the data simply wasn't supplied. As there are only 4 rows affected we will go ahead and remove these from the data set.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">price_df</span><span class="p">[</span><span class="n">price_df</span><span class="p">[</span><span class="s1">&#39;supported_languages&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[37]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>steam_appid</th>
      <th>required_age</th>
      <th>detailed_description</th>
      <th>about_the_game</th>
      <th>short_description</th>
      <th>supported_languages</th>
      <th>header_image</th>
      <th>website</th>
      <th>pc_requirements</th>
      <th>mac_requirements</th>
      <th>linux_requirements</th>
      <th>developers</th>
      <th>publishers</th>
      <th>platforms</th>
      <th>categories</th>
      <th>genres</th>
      <th>screenshots</th>
      <th>movies</th>
      <th>achievements</th>
      <th>release_date</th>
      <th>support_info</th>
      <th>background</th>
      <th>content_descriptors</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4866</th>
      <td>Subsiege</td>
      <td>338640</td>
      <td>0</td>
      <td>&lt;img src="https://steamcdn-a.akamaihd.net/stea...</td>
      <td>&lt;img src="https://steamcdn-a.akamaihd.net/stea...</td>
      <td>Subsiege is an intense real-time tactic game w...</td>
      <td>NaN</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/338...</td>
      <td>http://subsiege-game.com/</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>[]</td>
      <td>[]</td>
      <td>['Icebird Studios']</td>
      <td>['Icebird Studios']</td>
      <td>windows</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>[{'id': 256729398, 'name': 'Release Trailer', ...</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '7 Sep, 2018'}</td>
      <td>{'url': 'http://subsiege-game.com/', 'email': ...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/338...</td>
      <td>{'ids': [], 'notes': None}</td>
      <td>17.89</td>
    </tr>
    <tr>
      <th>14560</th>
      <td>MARS VR(全球使命VR)</td>
      <td>596560</td>
      <td>0</td>
      <td>1.\t4K level audio-visual experience &lt;br /&gt;\r\...</td>
      <td>1.\t4K level audio-visual experience &lt;br /&gt;\r\...</td>
      <td>Welcome to 《Mars VR》. This is an immersive fir...</td>
      <td>NaN</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/596...</td>
      <td>http://qqsm.zygames.com/</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>['Ying Pei Digital Technology Shanghai Co., Li...</td>
      <td>['SHANGHAI ZHENYOU TECHNOLOGY CO.,LTD']</td>
      <td>windows</td>
      <td>[{'id': 2, 'description': 'Single-player'}]</td>
      <td>[{'id': '73', 'description': 'Violent'}, {'id'...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>[{'id': 256681371, 'name': 'marsvr', 'thumbnai...</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '5 Apr, 2017'}</td>
      <td>{'url': 'http://www.zygames.com/contact', 'ema...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/596...</td>
      <td>{'ids': [], 'notes': None}</td>
      <td>1.99</td>
    </tr>
    <tr>
      <th>16386</th>
      <td>Numberline 2</td>
      <td>654970</td>
      <td>0</td>
      <td>NumberLine 2 is the continuation of the popula...</td>
      <td>NumberLine 2 is the continuation of the popula...</td>
      <td>NumberLine 2 is the continuation of the popula...</td>
      <td>NaN</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/654...</td>
      <td>NaN</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>[]</td>
      <td>[]</td>
      <td>['V34D4R', 'Egor Magurin']</td>
      <td>['Indovers Studio']</td>
      <td>windows</td>
      <td>[{'id': 2, 'description': 'Single-player'}]</td>
      <td>[{'id': '4', 'description': 'Casual'}, {'id': ...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>[{'id': 256687192, 'name': 'Numberline 2 Trail...</td>
      <td>{'total': 60, 'highlighted': [{'name': '1st le...</td>
      <td>{'coming_soon': False, 'date': '14 Jul, 2017'}</td>
      <td>{'url': '', 'email': 'radaew.zhenya@yandex.ru'}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/654...</td>
      <td>{'ids': [], 'notes': None}</td>
      <td>1.59</td>
    </tr>
    <tr>
      <th>26855</th>
      <td>SNUSE 221</td>
      <td>948070</td>
      <td>0</td>
      <td>&lt;strong&gt; Hey. My name is *&amp;amp;#!$.&lt;br&gt;Today I...</td>
      <td>&lt;strong&gt; Hey. My name is *&amp;amp;#!$.&lt;br&gt;Today I...</td>
      <td>Hey. My name is *&amp;amp;#!$. Today I will tell y...</td>
      <td>NaN</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/948...</td>
      <td>NaN</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>[]</td>
      <td>[]</td>
      <td>['SNUSE GM']</td>
      <td>['SNUSE GM']</td>
      <td>windows</td>
      <td>[{'id': 2, 'description': 'Single-player'}]</td>
      <td>[{'id': '25', 'description': 'Adventure'}, {'i...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>[{'id': 256745662, 'name': 'snuse', 'thumbnail...</td>
      <td>{'total': 0}</td>
      <td>{'coming_soon': False, 'date': '2 Apr, 2019'}</td>
      <td>{'url': 'vk.com/nilow_i', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/948...</td>
      <td>{'ids': [], 'notes': None}</td>
      <td>0.79</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next we'll take a look at the structure of the column. By looking at the value for the first row and the values for the most common rows, it looks like languages are stored as a string which can be anything from a comma-separated list of languages to a mix of html and headings. It seems reasonably safe to assume that if the app is in English, the word English will appear somewhere in this string. With this in mind we can simply search the string and return a value based on the result.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">price_df</span><span class="p">[</span><span class="s1">&#39;supported_languages&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">price_df</span><span class="p">[</span><span class="s1">&#39;supported_languages&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>English&lt;strong&gt;*&lt;/strong&gt;, French&lt;strong&gt;*&lt;/strong&gt;, German&lt;strong&gt;*&lt;/strong&gt;, Italian&lt;strong&gt;*&lt;/strong&gt;, Spanish - Spain&lt;strong&gt;*&lt;/strong&gt;, Simplified Chinese&lt;strong&gt;*&lt;/strong&gt;, Traditional Chinese&lt;strong&gt;*&lt;/strong&gt;, Korean&lt;strong&gt;*&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;*&lt;/strong&gt;languages with full audio support
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[38]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>English                                                                                                        8512
English&lt;strong&gt;*&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;*&lt;/strong&gt;languages with full audio support                               7409
English, Russian                                                                                                707
English, Simplified Chinese                                                                                     280
English, Japanese                                                                                               235
English&lt;strong&gt;*&lt;/strong&gt;, Russian&lt;strong&gt;*&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;*&lt;/strong&gt;languages with full audio support     222
English, French, Italian, German, Spanish - Spain                                                               180
English, German                                                                                                 161
Simplified Chinese                                                                                              157
English, French                                                                                                 143
Name: supported_languages, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It looks like English-only games make up a little over half the rows in our dataset (~16,000), and English plus other languages make up many more. We could create columns for any of the other languages by string searching, but for simplicity we'll focus on just the English ones.</p>
<p>Using the Series.apply method once again, we can check if the string 'english' appears in each row. We'll return a 1 if 'english' is found and 0 otherwise. Whilst we could use True/False, a binary 1/0 can be interpreted as a boolean value and saves a little space in the csv file.</p>
<p>Inside the lambda function, the variable <code>x</code> will take on the value of each row as the expression is evaluated. We apply the <code>lower()</code> string method so capitalisation doesn't matter.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process_language</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Process supported_languages column into a boolean &#39;is english&#39; column.&quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="c1"># drop rows with missing language data</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;supported_languages&#39;</span><span class="p">])</span>
    
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;english&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;supported_languages&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="s1">&#39;english&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;supported_languages&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>


<span class="n">language_df</span> <span class="o">=</span> <span class="n">process_language</span><span class="p">(</span><span class="n">price_df</span><span class="p">)</span>
<span class="n">language_df</span><span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;english&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[39]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>english</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Counter-Strike</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Team Fortress Classic</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Day of Defeat</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Deathmatch Classic</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Half-Life: Opposing Force</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Before moving on, we can take a quick look at the results and see that most of the apps support English.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;english&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[40]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1    27699
0      522
Name: english, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Processing-Developers-and-Publishers">Processing Developers and Publishers<a class="anchor-link" href="#Processing-Developers-and-Publishers">&#182;</a></h2><p>We'll skip over the next few columns and take a look at the <code>developers</code> and <code>publishers</code> columns. They will most likely contain similar information so we can look at them together.</p>
<p>We'll start by checking the null counts, noticing that while the publishers column doesn't appear to have any null values, if we search for empty lists we see that we have over 200 'hidden' null values.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[41]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Developers null counts:&#39;</span><span class="p">,</span> <span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;developers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Developers empty list counts:&#39;</span><span class="p">,</span> <span class="n">language_df</span><span class="p">[</span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;developers&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;[&#39;&#39;]&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Publishers null counts:&#39;</span><span class="p">,</span> <span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;publishers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Publishers empty list counts:&#39;</span><span class="p">,</span> <span class="n">language_df</span><span class="p">[</span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;publishers&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;[&#39;&#39;]&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Developers null counts: 104
Developers empty list counts: 0

Publishers null counts: 0
Publishers empty list counts: 213
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ultimately we want a data set with no missing values. That means we have a few options for dealing with these two columns:</p>
<ul>
<li>Remove all rows missing either developer or publisher information</li>
<li>Impute missing information by replacing the missing column with the column we have (i.e. if developers is missing, fill it with the value in publishers)</li>
<li>Fill missing information with 'Unknown' or 'None'</li>
</ul>
<p>We can investigate some of the rows with missing data to help inform our decision.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">no_dev</span> <span class="o">=</span> <span class="n">language_df</span><span class="p">[</span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;developers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total games missing developer:&#39;</span><span class="p">,</span> <span class="n">no_dev</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">print_steam_links</span><span class="p">(</span><span class="n">no_dev</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>

<span class="n">no_pub</span> <span class="o">=</span> <span class="n">language_df</span><span class="p">[</span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;publishers&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;[&#39;&#39;]&quot;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Total games missing publisher:&#39;</span><span class="p">,</span> <span class="n">no_pub</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">print_steam_links</span><span class="p">(</span><span class="n">no_pub</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>

<span class="n">no_dev_or_pub</span> <span class="o">=</span> <span class="n">language_df</span><span class="p">[(</span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;developers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;publishers&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;[&#39;&#39;]&quot;</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Total games missing developer and publisher:&#39;</span><span class="p">,</span> <span class="n">no_dev_or_pub</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">print_steam_links</span><span class="p">(</span><span class="n">no_dev_or_pub</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Total games missing developer: 104 

Tycoon City: New York: https://store.steampowered.com/app/9730
Nikopol: Secrets of the Immortals: https://store.steampowered.com/app/11370
Crash Time 2: https://store.steampowered.com/app/11390
Hunting Unlimited 2010: https://store.steampowered.com/app/12690
18 Wheels of Steel: Extreme Trucker: https://store.steampowered.com/app/33730

Total games missing publisher: 213 

RIP - Trilogy™: https://store.steampowered.com/app/2540
Vigil: Blood Bitterness™: https://store.steampowered.com/app/2570
Bullet Candy: https://store.steampowered.com/app/6600
AudioSurf: https://store.steampowered.com/app/12900
Everyday Shooter: https://store.steampowered.com/app/16300

Total games missing developer and publisher: 67 

PlayClaw 5 - Game Recording and Streaming: https://store.steampowered.com/app/237370
Artemis Spaceship Bridge Simulator: https://store.steampowered.com/app/247350
A Walk in the Dark: https://store.steampowered.com/app/248730
Forge Quest: https://store.steampowered.com/app/249950
Vox: https://store.steampowered.com/app/252770
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It appears we are looking at a mix of titles, smaller ones especially, and some of the smaller indie titles may have been self-published. Others simply have wrong or missing data, found by searching for the titles elsewhere. As our priority is creating a clean data set, and there are only a few hundred rows, it will be fine to remove them from the data.</p>
<p>Let's take a look at the structure of the data. Below we inspect some rows near the beginning of the dataframe. It looks like both columns are stored as lists which can have one or multiple values. We'll have to evaluate the rows as before, so they are recognised as lists, then index into them accordingly.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[43]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">language_df</span><span class="p">[[</span><span class="s1">&#39;developers&#39;</span><span class="p">,</span> <span class="s1">&#39;publishers&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">24</span><span class="p">:</span><span class="mi">28</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[43]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>developers</th>
      <th>publishers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>24</th>
      <td>['Valve']</td>
      <td>['Valve']</td>
    </tr>
    <tr>
      <th>25</th>
      <td>['Valve', 'Hidden Path Entertainment']</td>
      <td>['Valve']</td>
    </tr>
    <tr>
      <th>27</th>
      <td>['Mark Healey']</td>
      <td>['Mark Healey']</td>
    </tr>
    <tr>
      <th>28</th>
      <td>['Tripwire Interactive']</td>
      <td>['Tripwire Interactive']</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we have some single values and some multiple, we have to decide how to handle them. Here are some potential solutions:</p>
<ul>
<li>Create a column for each value in the list (i.e. developer_1, developer_2)</li>
<li>Create a column with the first value in the list and a column with the rest of the values (i.e. developer_1, other_developers)</li>
<li>Create a column with the first value in the list and disregard the rest</li>
<li>Combine all values into one column, simply unpacking the list</li>
</ul>
<p>Let's begin defining our function, and take a look at how many rows have multiple developers or publishers. After evaluating each row, we can find the length of the lists in each row by using the <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.len.html">Series.str.len()</a> method. By filtering only rows where the list has more than one element, we can find the number of rows with more than one value in each column.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[44]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process_developers_and_publishers</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="c1"># remove rows with missing data</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;developers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;publishers&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;[&#39;&#39;]&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;developers&#39;</span><span class="p">,</span> <span class="s1">&#39;publishers&#39;</span><span class="p">]:</span>
        <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        
        <span class="c1"># filter dataframe to rows with lists longer than 1, and store the number of rows</span>
        <span class="n">num_rows</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rows in </span><span class="si">{}</span><span class="s1"> column with multiple values:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">col</span><span class="p">),</span> <span class="n">num_rows</span><span class="p">)</span>

<span class="n">process_developers_and_publishers</span><span class="p">(</span><span class="n">language_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Rows in developers column with multiple values: 1720
Rows in publishers column with multiple values: 884
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It turns out that the vast majority have only one value for these columns. If we went with the first or second solutions above, we'd be left with columns with mostly missing data. We could go with the third option, but the first value in the list isn't necessarily the most important, and this seems unfair if multiple teams were involved.</p>
<p>The best way forward seems to be the fourth option - if there are multiple values we combine them into the same column. We'll create a list in this case, calling str.join() as we did before. If we pass a list with only one value, we get a string with just that value. If we pass a list with multiple values, we get a string-separated list as desired. We can see this below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[45]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;one item&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[45]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#39;one item&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[46]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;multiple&#39;</span><span class="p">,</span> <span class="s1">&#39;different&#39;</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[46]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#39;multiple, different, items&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can't join on a comma as a number of developers and publishers have a comma in their name, a couple of which can be seen below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[47]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">language_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;developers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;steam_appid&#39;</span><span class="p">,</span> <span class="s1">&#39;developers&#39;</span><span class="p">,</span> <span class="s1">&#39;publishers&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[47]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>steam_appid</th>
      <th>developers</th>
      <th>publishers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>25</th>
      <td>730</td>
      <td>['Valve', 'Hidden Path Entertainment']</td>
      <td>['Valve']</td>
    </tr>
    <tr>
      <th>66</th>
      <td>2520</td>
      <td>['CINEMAX, s.r.o.']</td>
      <td>['CINEMAX, s.r.o.']</td>
    </tr>
    <tr>
      <th>73</th>
      <td>2630</td>
      <td>['Infinity Ward', 'Aspyr (Mac)']</td>
      <td>['Activision', 'Aspyr (Mac)']</td>
    </tr>
    <tr>
      <th>97</th>
      <td>3300</td>
      <td>['PopCap Games, Inc.']</td>
      <td>['PopCap Games, Inc.']</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Instead we can join on a semi-colon (<code>;</code>). We have 3 rows which contain a semi-colon in their name, so we'll remove these. We'll be able to identify and split individual developer/publisher names in the future by handling it this way.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">language_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;developers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;steam_appid&#39;</span><span class="p">,</span> <span class="s1">&#39;developers&#39;</span><span class="p">,</span> <span class="s1">&#39;publishers&#39;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[48]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>steam_appid</th>
      <th>developers</th>
      <th>publishers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9550</th>
      <td>460210</td>
      <td>['bool games;']</td>
      <td>['bool games;']</td>
    </tr>
    <tr>
      <th>13489</th>
      <td>568480</td>
      <td>[';)', 'Quickdraw Studios']</td>
      <td>['Quickdraw Studios']</td>
    </tr>
    <tr>
      <th>16871</th>
      <td>665890</td>
      <td>['Semicolon;']</td>
      <td>['Semicolon;']</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are also a small number of columns that have <code>['NA']</code> or <code>['N/A']</code> for publisher. These are some really well hidden null values, and they didn't actually surface until much later in the original development process. This helps highlight the iterative nature of data cleaning - you may discover errors in rows or data that went previously undiscovered, and have to go back and update or correct them.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[49]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">language_df</span><span class="p">[(</span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;publishers&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;[&#39;NA&#39;]&quot;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">language_df</span><span class="p">[</span><span class="s1">&#39;publishers&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;[&#39;N/A&#39;]&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[49]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>12</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we're ready to finish the function we started. We'll abandon the for loop, as there is not too much repetition, and run it on the data as always.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[50]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process_developers_and_publishers</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parse columns as semicolon-separated string.&quot;&quot;&quot;</span>
    <span class="c1"># remove rows with missing data (~ means not)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;developers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;publishers&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;[&#39;&#39;]&quot;</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;developers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">))</span> <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;publishers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">))]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;publishers&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;[&#39;NA&#39;]&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;publishers&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;[&#39;N/A&#39;]&quot;</span><span class="p">)]</span>
    
    <span class="c1"># create list for each</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;developer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;developers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;publisher&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;publishers&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;developers&#39;</span><span class="p">,</span> <span class="s1">&#39;publishers&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>

<span class="n">dev_pub_df</span> <span class="o">=</span> <span class="n">process_developers_and_publishers</span><span class="p">(</span><span class="n">language_df</span><span class="p">)</span>
<span class="n">dev_pub_df</span><span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;steam_appid&#39;</span><span class="p">,</span> <span class="s1">&#39;developer&#39;</span><span class="p">,</span> <span class="s1">&#39;publisher&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[50]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>steam_appid</th>
      <th>developer</th>
      <th>publisher</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Counter-Strike</td>
      <td>10</td>
      <td>Valve</td>
      <td>Valve</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Team Fortress Classic</td>
      <td>20</td>
      <td>Valve</td>
      <td>Valve</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Day of Defeat</td>
      <td>30</td>
      <td>Valve</td>
      <td>Valve</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Deathmatch Classic</td>
      <td>40</td>
      <td>Valve</td>
      <td>Valve</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Half-Life: Opposing Force</td>
      <td>50</td>
      <td>Gearbox Software</td>
      <td>Valve</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Processing-Categories-and-Genres">Processing Categories and Genres<a class="anchor-link" href="#Processing-Categories-and-Genres">&#182;</a></h2><p>We'll take a look at the <code>categories</code> and <code>genres</code> columns next. Below we take a look at the null counts and structure of the data. Both appear to be a list of dictionaries containing an id and description key-value pair. Similar to our handling of developers and publishers, it may be best to extract just the descriptions into a list for now. We could make a list of the IDs, keeping track of the corresponding description externally, but that seems overly complex for our purposes.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[51]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Categories:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Null values:&#39;</span><span class="p">,</span> <span class="n">dev_pub_df</span><span class="p">[</span><span class="s1">&#39;categories&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dev_pub_df</span><span class="p">[</span><span class="s1">&#39;categories&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Genres:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Null values:&#39;</span><span class="p">,</span> <span class="n">dev_pub_df</span><span class="p">[</span><span class="s1">&#39;genres&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dev_pub_df</span><span class="p">[</span><span class="s1">&#39;genres&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dev_pub_df</span><span class="p">[</span><span class="s1">&#39;genres&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1000</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Categories:

Null values: 509

[{&#39;id&#39;: 1, &#39;description&#39;: &#39;Multi-player&#39;}, {&#39;id&#39;: 36, &#39;description&#39;: &#39;Online Multi-Player&#39;}, {&#39;id&#39;: 37, &#39;description&#39;: &#39;Local Multi-Player&#39;}, {&#39;id&#39;: 8, &#39;description&#39;: &#39;Valve Anti-Cheat enabled&#39;}]

Genres:

Null values: 37

[{&#39;id&#39;: &#39;1&#39;, &#39;description&#39;: &#39;Action&#39;}]
[{&#39;id&#39;: &#39;3&#39;, &#39;description&#39;: &#39;RPG&#39;}, {&#39;id&#39;: &#39;2&#39;, &#39;description&#39;: &#39;Strategy&#39;}]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Before we begin defining a function we'll inspect some of the null rows, then we can decide how to handle them.</p>
<p>Using the pandas <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.sample.html">DataFrame.sample</a> method, we can randomly sample a number of rows from the dataset. We set a random_state so the output is the same each time.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[52]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_steam_links</span><span class="p">(</span><span class="n">dev_pub_df</span><span class="p">[</span><span class="n">dev_pub_df</span><span class="p">[</span><span class="s1">&#39;categories&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Driver Booster 3 for STEAM: https://store.steampowered.com/app/403040
Swanky Paint: https://store.steampowered.com/app/432030
ResumeMaker® Professional Deluxe 20: https://store.steampowered.com/app/707280
CyberLink PhotoDirector 9 Ultra: https://store.steampowered.com/app/679550
OVRdrop: https://store.steampowered.com/app/586210
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>All of the above rows with null categories data are applications or software of some kind, and not actually games. It would definitely be best to remove these, as we are interested in analysing games from the steam store.</p>
<p>Below we take a look at rows with missing genres data. There doesn't seem to be anything wrong with these games, and it suggests that genre data simply wasn't supplied. As there are only 37 rows affected, we'll remove these rows to keep our dataset complete.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[53]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_steam_links</span><span class="p">(</span><span class="n">dev_pub_df</span><span class="p">[</span><span class="n">dev_pub_df</span><span class="p">[</span><span class="s1">&#39;genres&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Antagonist: https://store.steampowered.com/app/585260
Lonelyland VR: https://store.steampowered.com/app/542620
ChessBase 13 Academy: https://store.steampowered.com/app/377340
Sonic the Hedgehog 4 - Episode I: https://store.steampowered.com/app/202530
VEHICLES FURY: https://store.steampowered.com/app/749290
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we did for the developer and publisher columns, we can create an anonymous function and join the results on a semicolon. Inside the function we use a list comprehension to traverse each dictionary and extract the value under the <code>description</code> key, as seen below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[54]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">example_category</span> <span class="o">=</span> <span class="s2">&quot;[{&#39;id&#39;: 1, &#39;description&#39;: &#39;Multi-player&#39;}, {&#39;id&#39;: 36, &#39;description&#39;: &#39;Online Multi-Player&#39;}, {&#39;id&#39;: 37, &#39;description&#39;: &#39;Local Multi-Player&#39;}]&quot;</span>

<span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">example_category</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[54]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[&#39;Multi-player&#39;, &#39;Online Multi-Player&#39;, &#39;Local Multi-Player&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We then use the apply function again to turn each column into a simple delimited list.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[55]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process_categories_and_genres</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;categories&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;genres&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())]</span>
    
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;categories&#39;</span><span class="p">,</span> <span class="s1">&#39;genres&#39;</span><span class="p">]:</span>
        <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
    
    <span class="k">return</span> <span class="n">df</span>

<span class="n">cat_gen_df</span> <span class="o">=</span> <span class="n">process_categories_and_genres</span><span class="p">(</span><span class="n">dev_pub_df</span><span class="p">)</span>
<span class="n">cat_gen_df</span><span class="p">[[</span><span class="s1">&#39;steam_appid&#39;</span><span class="p">,</span> <span class="s1">&#39;categories&#39;</span><span class="p">,</span> <span class="s1">&#39;genres&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[55]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>steam_appid</th>
      <th>categories</th>
      <th>genres</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>Multi-player;Online Multi-Player;Local Multi-P...</td>
      <td>Action</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>Multi-player;Online Multi-Player;Local Multi-P...</td>
      <td>Action</td>
    </tr>
    <tr>
      <th>2</th>
      <td>30</td>
      <td>Multi-player;Valve Anti-Cheat enabled</td>
      <td>Action</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>Multi-player;Online Multi-Player;Local Multi-P...</td>
      <td>Action</td>
    </tr>
    <tr>
      <th>4</th>
      <td>50</td>
      <td>Single-player;Multi-player;Valve Anti-Cheat en...</td>
      <td>Action</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Processing-Achievements-and-Content-Descriptors">Processing Achievements and Content Descriptors<a class="anchor-link" href="#Processing-Achievements-and-Content-Descriptors">&#182;</a></h2><p>The final columns we will take a look at before moving on to export columns are <code>achievements</code> and <code>content_descriptors</code>. Let's take a look at the null counts for each column and a small sample of rows.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[56]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Achievements null counts:&#39;</span><span class="p">,</span> <span class="n">cat_gen_df</span><span class="p">[</span><span class="s1">&#39;achievements&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Content Decsriptors null counts:&#39;</span><span class="p">,</span> <span class="n">cat_gen_df</span><span class="p">[</span><span class="s1">&#39;content_descriptors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="n">cat_gen_df</span><span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;achievements&#39;</span><span class="p">,</span> <span class="s1">&#39;content_descriptors&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">13</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Achievements null counts: 1856
Content Decsriptors null counts: 0
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[56]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>achievements</th>
      <th>content_descriptors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>Half-Life: Blue Shift</td>
      <td>{'total': 0}</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Half-Life 2</td>
      <td>{'total': 33, 'highlighted': [{'name': 'Defian...</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Counter-Strike: Source</td>
      <td>{'total': 147, 'highlighted': [{'name': 'Someo...</td>
      <td>{'ids': [2, 5], 'notes': 'Includes intense vio...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Half-Life: Source</td>
      <td>{'total': 0}</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Day of Defeat: Source</td>
      <td>{'total': 54, 'highlighted': [{'name': 'Double...</td>
      <td>{'ids': [], 'notes': None}</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It looks like both columns are stored as dictionaries, with standard formats if no details are provided or exist.</p>
<p>Below we take a closer look at a single row from the achievements column.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[57]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">literal_eval</span><span class="p">(</span><span class="n">cat_gen_df</span><span class="p">[</span><span class="s1">&#39;achievements&#39;</span><span class="p">][</span><span class="mi">9</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[57]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>{&#39;total&#39;: 33,
 &#39;highlighted&#39;: [{&#39;name&#39;: &#39;Defiant&#39;,
   &#39;path&#39;: &#39;https://steamcdn-a.akamaihd.net/steamcommunity/public/images/apps/220/hl2_hit_cancop_withcan.jpg&#39;},
  {&#39;name&#39;: &#39;Submissive&#39;,
   &#39;path&#39;: &#39;https://steamcdn-a.akamaihd.net/steamcommunity/public/images/apps/220/hl2_put_canintrash.jpg&#39;},
  {&#39;name&#39;: &#39;Malcontent&#39;,
   &#39;path&#39;: &#39;https://steamcdn-a.akamaihd.net/steamcommunity/public/images/apps/220/hl2_escape_apartmentraid.jpg&#39;},
  {&#39;name&#39;: &#39;What cat?&#39;,
   &#39;path&#39;: &#39;https://steamcdn-a.akamaihd.net/steamcommunity/public/images/apps/220/hl2_break_miniteleporter.jpg&#39;},
  {&#39;name&#39;: &#39;Trusty Hardware&#39;,
   &#39;path&#39;: &#39;https://steamcdn-a.akamaihd.net/steamcommunity/public/images/apps/220/hl2_get_crowbar.jpg&#39;},
  {&#39;name&#39;: &#39;Barnacle Bowling&#39;,
   &#39;path&#39;: &#39;https://steamcdn-a.akamaihd.net/steamcommunity/public/images/apps/220/hl2_kill_barnacleswithbarrel.jpg&#39;},
  {&#39;name&#39;: &#34;Anchor&#39;s Aweigh!&#34;,
   &#39;path&#39;: &#39;https://steamcdn-a.akamaihd.net/steamcommunity/public/images/apps/220/hl2_get_airboat.jpg&#39;},
  {&#39;name&#39;: &#39;Heavy Weapons&#39;,
   &#39;path&#39;: &#39;https://steamcdn-a.akamaihd.net/steamcommunity/public/images/apps/220/hl2_get_airboatgun.jpg&#39;},
  {&#39;name&#39;: &#39;Vorticough&#39;,
   &#39;path&#39;: &#39;https://steamcdn-a.akamaihd.net/steamcommunity/public/images/apps/220/hl2_find_vortigauntcave.jpg&#39;},
  {&#39;name&#39;: &#39;Revenge!&#39;,
   &#39;path&#39;: &#39;https://steamcdn-a.akamaihd.net/steamcommunity/public/images/apps/220/hl2_kill_chopper.jpg&#39;}]}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are two keys in the top level of the dictionary: <code>total</code> and <code>highlighted</code>. The highlighted column looks too specific, being a selection of achievements specific to that game, so we will remove it. It may be worthwhile extracting the <code>total</code> value though.</p>
<p>Now let's take a look at the <code>content_descriptors</code> column.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[58]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat_gen_df</span><span class="p">[</span><span class="s1">&#39;content_descriptors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[58]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>{&#39;ids&#39;: [], &#39;notes&#39;: None}                                                                                                                                                                  25398
{&#39;ids&#39;: [2, 5], &#39;notes&#39;: None}                                                                                                                                                                427
{&#39;ids&#39;: [1, 5], &#39;notes&#39;: None}                                                                                                                                                                250
{&#39;ids&#39;: [5], &#39;notes&#39;: None}                                                                                                                                                                   127
{&#39;ids&#39;: [1, 2, 5], &#39;notes&#39;: None}                                                                                                                                                             122
{&#39;ids&#39;: [2, 5], &#39;notes&#39;: &#39;This Game may contain content not appropriate for all ages, or may not be appropriate for viewing at work: Frequent Violence or Gore, General Mature Content&#39;}        8
Name: content_descriptors, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Content descriptors contain age-related warnings about the content of a game. They are identified by a numeric ID number, with optional notes supplied. Almost 26,000 rows have an empty list, indicating either no content descriptors or none provided. We already have the <code>required_age</code> column, which gives us similar information. Because of this, and because the rows are highly specific to each game, we will drop this column entirely.</p>
<p>Let's now define a function, taking a look at the value counts to verify everything went as expected.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[59]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process_achievements_and_descriptors</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parse as total number of achievements.&quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;content_descriptors&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">parse_achievements</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">:</span>
            <span class="c1"># missing data, assume has no achievements</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># else has data, so can extract and return number under total</span>
            <span class="k">return</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="s1">&#39;total&#39;</span><span class="p">]</span>
        
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;achievements&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;achievements&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">parse_achievements</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>

<span class="n">achiev_df</span> <span class="o">=</span> <span class="n">process_achievements_and_descriptors</span><span class="p">(</span><span class="n">cat_gen_df</span><span class="p">)</span>
<span class="n">achiev_df</span><span class="p">[</span><span class="s1">&#39;achievements&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[59]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0     11966
10      697
12      624
20      579
15      500
Name: achievements, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It looks like we were successful. We'll leave this column as it is for now, however we may wish to consider grouping the values together in bins, like we did for the age column. This is a decision we can make during the feature engineering stage of our analysis, and we can decide at that point if it will be more useful.</p>
<p>Let's now add these functions into the <code>process</code> function and run it on the raw data. This isn't strictly necessary but it will keep things organised and ensure we don't accidentally skip running a function.</p>
<p>We'll then inspect everything we've completed so far. As you will see, there is still plenty more left to do.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[60]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Process data set. Will eventually contain calls to all functions we write.&quot;&quot;&quot;</span>
    
    <span class="c1"># Copy the input dataframe to avoid accidentally modifying original data</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="c1"># Remove duplicate rows - all appids should be unique</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
    
    <span class="c1"># Remove collumns with more than 50% null values</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">drop_null_cols</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    
    <span class="c1"># Process columns</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_name_type</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_age</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_platforms</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_price</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_language</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_developers_and_publishers</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_categories_and_genres</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_achievements_and_descriptors</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>

<span class="n">partially_clean</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">raw_steam_data</span><span class="p">)</span>
<span class="n">partially_clean</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[60]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>steam_appid</th>
      <th>required_age</th>
      <th>detailed_description</th>
      <th>about_the_game</th>
      <th>short_description</th>
      <th>header_image</th>
      <th>website</th>
      <th>pc_requirements</th>
      <th>mac_requirements</th>
      <th>linux_requirements</th>
      <th>platforms</th>
      <th>categories</th>
      <th>genres</th>
      <th>screenshots</th>
      <th>movies</th>
      <th>achievements</th>
      <th>release_date</th>
      <th>support_info</th>
      <th>background</th>
      <th>price</th>
      <th>english</th>
      <th>developer</th>
      <th>publisher</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Counter-Strike</td>
      <td>10</td>
      <td>0</td>
      <td>Play the world's number 1 online action game. ...</td>
      <td>Play the world's number 1 online action game. ...</td>
      <td>Play the world's number 1 online action game. ...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/10/...</td>
      <td>NaN</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>windows;mac;linux</td>
      <td>Multi-player;Online Multi-Player;Local Multi-P...</td>
      <td>Action</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>0</td>
      <td>{'coming_soon': False, 'date': '1 Nov, 2000'}</td>
      <td>{'url': 'http://steamcommunity.com/app/10', 'e...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/10/...</td>
      <td>7.19</td>
      <td>1</td>
      <td>Valve</td>
      <td>Valve</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Team Fortress Classic</td>
      <td>20</td>
      <td>0</td>
      <td>One of the most popular online action games of...</td>
      <td>One of the most popular online action games of...</td>
      <td>One of the most popular online action games of...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/20/...</td>
      <td>NaN</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>windows;mac;linux</td>
      <td>Multi-player;Online Multi-Player;Local Multi-P...</td>
      <td>Action</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>0</td>
      <td>{'coming_soon': False, 'date': '1 Apr, 1999'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/20/...</td>
      <td>3.99</td>
      <td>1</td>
      <td>Valve</td>
      <td>Valve</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Day of Defeat</td>
      <td>30</td>
      <td>0</td>
      <td>Enlist in an intense brand of Axis vs. Allied ...</td>
      <td>Enlist in an intense brand of Axis vs. Allied ...</td>
      <td>Enlist in an intense brand of Axis vs. Allied ...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/30/...</td>
      <td>http://www.dayofdefeat.com/</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>windows;mac;linux</td>
      <td>Multi-player;Valve Anti-Cheat enabled</td>
      <td>Action</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>0</td>
      <td>{'coming_soon': False, 'date': '1 May, 2003'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/30/...</td>
      <td>3.99</td>
      <td>1</td>
      <td>Valve</td>
      <td>Valve</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Deathmatch Classic</td>
      <td>40</td>
      <td>0</td>
      <td>Enjoy fast-paced multiplayer gaming with Death...</td>
      <td>Enjoy fast-paced multiplayer gaming with Death...</td>
      <td>Enjoy fast-paced multiplayer gaming with Death...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/40/...</td>
      <td>NaN</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>windows;mac;linux</td>
      <td>Multi-player;Online Multi-Player;Local Multi-P...</td>
      <td>Action</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>0</td>
      <td>{'coming_soon': False, 'date': '1 Jun, 2001'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/40/...</td>
      <td>3.99</td>
      <td>1</td>
      <td>Valve</td>
      <td>Valve</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Half-Life: Opposing Force</td>
      <td>50</td>
      <td>0</td>
      <td>Return to the Black Mesa Research Facility as ...</td>
      <td>Return to the Black Mesa Research Facility as ...</td>
      <td>Return to the Black Mesa Research Facility as ...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/50/...</td>
      <td>NaN</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>windows;mac;linux</td>
      <td>Single-player;Multi-player;Valve Anti-Cheat en...</td>
      <td>Action</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>0</td>
      <td>{'coming_soon': False, 'date': '1 Nov, 1999'}</td>
      <td>{'url': 'https://help.steampowered.com', 'emai...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/50/...</td>
      <td>3.99</td>
      <td>1</td>
      <td>Gearbox Software</td>
      <td>Valve</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Export-Columns">Export Columns<a class="anchor-link" href="#Export-Columns">&#182;</a></h2><p>There are a number of columns containing information that is either not useful to the current project or is too complex to be useful for now. We may wish to incorporate them into a future project, but for now we will export the columns to separate files and remove them from the dataset.</p>
<h3 id="Processing-Description-Columns">Processing Description Columns<a class="anchor-link" href="#Processing-Description-Columns">&#182;</a></h3><p>We have a series of columns with descriptive text about each game: <code>detailed_description</code>, <code>about_the_game</code> and <code>short_description</code>. As the column names imply, these provide information about each game in string format. This is great for humans' understanding, but when it comes to machines is a lot trickier.</p>
<p>These columns could be used as the basis for an interesting <a href="https://en.wikipedia.org/wiki/Recommender_system">recommender system</a> or <a href="https://en.wikipedia.org/wiki/Sentiment_analysis">sentiment analysis</a> project, however they are not required in our current project. We'll be removing them as they take up large amounts of space, and will only serve to slow down any computation on the data.</p>
<p>We'll briefly inspect the columns, in case of anomalies, and export just the description data to a separate file.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[61]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">partially_clean</span><span class="p">[[</span><span class="s1">&#39;detailed_description&#39;</span><span class="p">,</span> <span class="s1">&#39;about_the_game&#39;</span><span class="p">,</span> <span class="s1">&#39;short_description&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[61]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>detailed_description    14
about_the_game          14
short_description       14
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have 14 rows with missing data for these columns, and chances are the 14 rows with missing <code>detailed_description</code> are the rows with missing <code>about_the_game</code> and <code>short_description</code> data too.</p>
<p>By inspecting the individual rows below, we can see that this is true - all rows with missing data in one description column have missing data in the others as well.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[62]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">partially_clean</span><span class="p">[</span><span class="n">partially_clean</span><span class="p">[</span><span class="s1">&#39;detailed_description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[62]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>steam_appid</th>
      <th>required_age</th>
      <th>detailed_description</th>
      <th>about_the_game</th>
      <th>short_description</th>
      <th>header_image</th>
      <th>website</th>
      <th>pc_requirements</th>
      <th>mac_requirements</th>
      <th>linux_requirements</th>
      <th>platforms</th>
      <th>categories</th>
      <th>genres</th>
      <th>screenshots</th>
      <th>movies</th>
      <th>achievements</th>
      <th>release_date</th>
      <th>support_info</th>
      <th>background</th>
      <th>price</th>
      <th>english</th>
      <th>developer</th>
      <th>publisher</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>97</th>
      <td>Bejeweled 2 Deluxe</td>
      <td>3300</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/330...</td>
      <td>NaN</td>
      <td>{'minimum': '&lt;p&gt;&lt;strong&gt;Minimum Requirements:&lt;...</td>
      <td>{'minimum': '&lt;ul&gt;\n\t&lt;li&gt;&lt;strong&gt;OS:&lt;/strong&gt; ...</td>
      <td>[]</td>
      <td>windows;mac</td>
      <td>Single-player</td>
      <td>Casual</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>0</td>
      <td>{'coming_soon': False, 'date': '30 Aug, 2006'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/330...</td>
      <td>4.25</td>
      <td>1</td>
      <td>PopCap Games, Inc.</td>
      <td>PopCap Games, Inc.</td>
    </tr>
    <tr>
      <th>98</th>
      <td>Chuzzle Deluxe</td>
      <td>3310</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/331...</td>
      <td>NaN</td>
      <td>{'minimum': '&lt;p&gt;&lt;strong&gt;Minimum Requirements:&lt;...</td>
      <td>{'minimum': '&lt;ul&gt;\n\t&lt;li&gt;&lt;strong&gt;OS:&lt;/strong&gt; ...</td>
      <td>[]</td>
      <td>windows;mac</td>
      <td>Single-player</td>
      <td>Casual</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>0</td>
      <td>{'coming_soon': False, 'date': '30 Aug, 2006'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/331...</td>
      <td>4.25</td>
      <td>1</td>
      <td>PopCap Games, Inc.</td>
      <td>PopCap Games, Inc.</td>
    </tr>
    <tr>
      <th>99</th>
      <td>Insaniquarium Deluxe</td>
      <td>3320</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/332...</td>
      <td>NaN</td>
      <td>{'minimum': '&lt;strong&gt;Minimum Requirements:&lt;/st...</td>
      <td>[]</td>
      <td>[]</td>
      <td>windows</td>
      <td>Single-player</td>
      <td>Casual</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>0</td>
      <td>{'coming_soon': False, 'date': '30 Aug, 2006'}</td>
      <td>{'url': '', 'email': ''}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/332...</td>
      <td>4.25</td>
      <td>1</td>
      <td>PopCap Games, Inc.</td>
      <td>PopCap Games, Inc.</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Interestingly, all of these titles are games from 2006 developed and published by PopCap Games. My best guess is that they were developed previously and all added to the Steam store in one go after Valve allowed third-party titles.</p>
<p>We'll remove these rows, as well as any with a description of less than 20 characters, like those below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[63]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">partially_clean</span><span class="p">[</span><span class="n">partially_clean</span><span class="p">[</span><span class="s1">&#39;detailed_description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">20</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[63]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>steam_appid</th>
      <th>required_age</th>
      <th>detailed_description</th>
      <th>about_the_game</th>
      <th>short_description</th>
      <th>header_image</th>
      <th>website</th>
      <th>pc_requirements</th>
      <th>mac_requirements</th>
      <th>linux_requirements</th>
      <th>platforms</th>
      <th>categories</th>
      <th>genres</th>
      <th>screenshots</th>
      <th>movies</th>
      <th>achievements</th>
      <th>release_date</th>
      <th>support_info</th>
      <th>background</th>
      <th>price</th>
      <th>english</th>
      <th>developer</th>
      <th>publisher</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10420</th>
      <td>Penguins Cretins</td>
      <td>490990</td>
      <td>0</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/490...</td>
      <td>NaN</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>windows</td>
      <td>Single-player;Multi-player;Online Multi-Player...</td>
      <td>Action;Adventure;Casual;Indie;Massively Multip...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>NaN</td>
      <td>0</td>
      <td>{'coming_soon': False, 'date': '22 Jun, 2016'}</td>
      <td>{'url': '', 'email': 'support@hfmgames.net'}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/490...</td>
      <td>1.69</td>
      <td>1</td>
      <td>HFM Games</td>
      <td>HFM Games</td>
    </tr>
    <tr>
      <th>19938</th>
      <td>拼词游戏 2017</td>
      <td>745840</td>
      <td>0</td>
      <td>带一点恐怖元素的休闲游戏</td>
      <td>带一点恐怖元素的休闲游戏</td>
      <td>一款有一点恐怖元素的休闲益智游戏。</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/745...</td>
      <td>NaN</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>[]</td>
      <td>windows;mac</td>
      <td>Single-player</td>
      <td>Adventure;Indie</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>[{'id': 256699963, 'name': 'alpha', 'thumbnail...</td>
      <td>11</td>
      <td>{'coming_soon': False, 'date': '29 Nov, 2017'}</td>
      <td>{'url': '', 'email': '12668934@qq.com'}</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/745...</td>
      <td>0.79</td>
      <td>0</td>
      <td>Mianwotu</td>
      <td>Mianwotu</td>
    </tr>
    <tr>
      <th>21937</th>
      <td>God Test</td>
      <td>797660</td>
      <td>0</td>
      <td>God Test</td>
      <td>God Test</td>
      <td>God Test</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/797...</td>
      <td>NaN</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>[]</td>
      <td>[]</td>
      <td>windows</td>
      <td>Multi-player;Online Multi-Player;MMO;Online Co...</td>
      <td>Action;Massively Multiplayer;RPG;Strategy</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>{'coming_soon': False, 'date': '18 Apr, 2018'}</td>
      <td>{'url': '', 'email': 'insanegamedev@outlook.com'}</td>
      <td>NaN</td>
      <td>0.00</td>
      <td>1</td>
      <td>God Test</td>
      <td>God Test</td>
    </tr>
    <tr>
      <th>26219</th>
      <td>В поисках Атлантиды</td>
      <td>925640</td>
      <td>0</td>
      <td>Интересная игра</td>
      <td>Интересная игра</td>
      <td>Atlantis</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/925...</td>
      <td>https://vk.com/atlantisforever</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>[]</td>
      <td>[]</td>
      <td>windows</td>
      <td>Single-player;Steam Achievements</td>
      <td>Adventure;Casual;Indie;Early Access</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>[{'id': 256725871, 'name': 'Game', 'thumbnail'...</td>
      <td>1</td>
      <td>{'coming_soon': False, 'date': '1 Nov, 2018'}</td>
      <td>{'url': 'https://vk.com/atlantisforever', 'ema...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/925...</td>
      <td>1.69</td>
      <td>0</td>
      <td>Dmitr Che</td>
      <td>Dmitr Che</td>
    </tr>
    <tr>
      <th>26356</th>
      <td>东方百问~TouHouAsked</td>
      <td>930840</td>
      <td>0</td>
      <td>Null</td>
      <td>Null</td>
      <td>Null</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/930...</td>
      <td>https://asked.touhou.ren/</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>[]</td>
      <td>[]</td>
      <td>windows</td>
      <td>Single-player;Steam Achievements</td>
      <td>Casual;Indie;Strategy;Early Access</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>[{'id': 256726640, 'name': 'TouHouAsked', 'thu...</td>
      <td>2</td>
      <td>{'coming_soon': False, 'date': '7 Oct, 2018'}</td>
      <td>{'url': 'https://asked.touhou.ren', 'email': '...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/930...</td>
      <td>0.79</td>
      <td>0</td>
      <td>Root Nine Studio</td>
      <td>Root Nine Studio</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To handle exporting the data to file, we'll write a reusable function which we can call upon for future columns. We will include the <code>steam_appid</code> column as it will allow us to match up these rows with rows in our primary dataset later on, using a merge (like a join in SQL).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[64]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">export_data</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Export dataframe to csv file, filename prepended with &#39;steam_&#39;.</span>
<span class="sd">    </span>
<span class="sd">    filename : str without file extension</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="s1">&#39;../data/exports/steam_&#39;</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span>
    
    <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="n">print_name</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exported </span><span class="si">{}</span><span class="s2"> to &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">print_name</span><span class="p">,</span> <span class="n">filepath</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can now define a function to process and export the description columns.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[65]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process_descriptions</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">export</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Export descriptions to external csv file then remove these columns.&quot;&quot;&quot;</span>
    <span class="c1"># remove rows with missing description data</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;detailed_description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="c1"># remove rows with unusually small description</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;detailed_description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">]</span>
    
    <span class="c1"># by default we don&#39;t export, useful if calling function later</span>
    <span class="k">if</span> <span class="n">export</span><span class="p">:</span>
        <span class="c1"># create dataframe of description columns</span>
        <span class="n">description_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;steam_appid&#39;</span><span class="p">,</span> <span class="s1">&#39;detailed_description&#39;</span><span class="p">,</span> <span class="s1">&#39;about_the_game&#39;</span><span class="p">,</span> <span class="s1">&#39;short_description&#39;</span><span class="p">]]</span>
        
        <span class="n">export_data</span><span class="p">(</span><span class="n">description_data</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;description_data&#39;</span><span class="p">)</span>
    
    <span class="c1"># drop description columns from main dataframe</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;detailed_description&#39;</span><span class="p">,</span> <span class="s1">&#39;about_the_game&#39;</span><span class="p">,</span> <span class="s1">&#39;short_description&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>

<span class="n">desc_df</span> <span class="o">=</span> <span class="n">process_descriptions</span><span class="p">(</span><span class="n">partially_clean</span><span class="p">,</span> <span class="n">export</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Exported description data to &#39;../data/exports/steam_description_data.csv&#39;
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[66]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># inspect exported data</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/exports/steam_description_data.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[66]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>steam_appid</th>
      <th>detailed_description</th>
      <th>about_the_game</th>
      <th>short_description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>Play the world's number 1 online action game. ...</td>
      <td>Play the world's number 1 online action game. ...</td>
      <td>Play the world's number 1 online action game. ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>One of the most popular online action games of...</td>
      <td>One of the most popular online action games of...</td>
      <td>One of the most popular online action games of...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>30</td>
      <td>Enlist in an intense brand of Axis vs. Allied ...</td>
      <td>Enlist in an intense brand of Axis vs. Allied ...</td>
      <td>Enlist in an intense brand of Axis vs. Allied ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>Enjoy fast-paced multiplayer gaming with Death...</td>
      <td>Enjoy fast-paced multiplayer gaming with Death...</td>
      <td>Enjoy fast-paced multiplayer gaming with Death...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>50</td>
      <td>Return to the Black Mesa Research Facility as ...</td>
      <td>Return to the Black Mesa Research Facility as ...</td>
      <td>Return to the Black Mesa Research Facility as ...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Processing-Media-Columns">Processing Media Columns<a class="anchor-link" href="#Processing-Media-Columns">&#182;</a></h3><p>Similar to the description columns, we have three columns that contain links to various images: <code>header_image</code>, <code>screenshots</code> and <code>background</code>. Whilst we won't be needing this data in this project, it could open the door to some interesting image analysis in the future. We will treat these columns in almost the same way, exporting the contents to a csv file then removing them from the dataset.</p>
<p>Again, let's check for missing values.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[67]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">image_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;header_image&#39;</span><span class="p">,</span> <span class="s1">&#39;screenshots&#39;</span><span class="p">,</span> <span class="s1">&#39;background&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">image_cols</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">col</span><span class="o">+</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">desc_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="n">desc_df</span><span class="p">[</span><span class="n">image_cols</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>header_image: 0
screenshots: 4
background: 4
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[67]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>header_image</th>
      <th>screenshots</th>
      <th>background</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/10/...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/10/...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/20/...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/20/...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/30/...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/30/...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/40/...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/40/...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/50/...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/50/...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As with the description columns, it is likely that the 4 rows with no <code>screenshots</code> data are the same rows with no <code>background</code> data. There are so few that it is probably safe to remove them.</p>
<p>Before we make up our made let's inspect the rows.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[68]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">no_screenshots</span> <span class="o">=</span> <span class="n">desc_df</span><span class="p">[</span><span class="n">desc_df</span><span class="p">[</span><span class="s1">&#39;screenshots&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>

<span class="n">print_steam_links</span><span class="p">(</span><span class="n">no_screenshots</span><span class="p">)</span>

<span class="n">no_screenshots</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>The Light Empire: https://store.steampowered.com/app/416220
Girl and Goblin: https://store.steampowered.com/app/880510
Arida: Backland&#39;s Awakening: https://store.steampowered.com/app/907760
Nukalypse: The Final War: https://store.steampowered.com/app/947940
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[68]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>steam_appid</th>
      <th>required_age</th>
      <th>header_image</th>
      <th>website</th>
      <th>pc_requirements</th>
      <th>mac_requirements</th>
      <th>linux_requirements</th>
      <th>platforms</th>
      <th>categories</th>
      <th>genres</th>
      <th>screenshots</th>
      <th>movies</th>
      <th>achievements</th>
      <th>release_date</th>
      <th>support_info</th>
      <th>background</th>
      <th>price</th>
      <th>english</th>
      <th>developer</th>
      <th>publisher</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7970</th>
      <td>The Light Empire</td>
      <td>416220</td>
      <td>0</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/416...</td>
      <td>NaN</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>[]</td>
      <td>[]</td>
      <td>windows</td>
      <td>Single-player;Steam Achievements</td>
      <td>Indie;RPG;Simulation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4</td>
      <td>{'coming_soon': False, 'date': '2 Dec, 2015'}</td>
      <td>{'url': '', 'email': 'Jemy.TLE@outlook.com'}</td>
      <td>NaN</td>
      <td>4.79</td>
      <td>1</td>
      <td>Jemy</td>
      <td>Jemy</td>
    </tr>
    <tr>
      <th>24874</th>
      <td>Girl and Goblin</td>
      <td>880510</td>
      <td>0</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/880...</td>
      <td>NaN</td>
      <td>{'minimum': '&lt;strong&gt;最低配置:&lt;/strong&gt;&lt;br&gt;&lt;ul cla...</td>
      <td>[]</td>
      <td>[]</td>
      <td>windows</td>
      <td>Single-player;Steam Achievements;Steam Trading...</td>
      <td>Adventure;Casual;RPG;Strategy</td>
      <td>NaN</td>
      <td>[{'id': 256739772, 'name': '3', 'thumbnail': '...</td>
      <td>1552</td>
      <td>{'coming_soon': False, 'date': '5 Jan, 2019'}</td>
      <td>{'url': '', 'email': 'smagician13@yahoo.com'}</td>
      <td>NaN</td>
      <td>0.79</td>
      <td>1</td>
      <td>Inverse Game</td>
      <td>Inverse Game</td>
    </tr>
    <tr>
      <th>25696</th>
      <td>Arida: Backland's Awakening</td>
      <td>907760</td>
      <td>0</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/907...</td>
      <td>http://www.aridagame.com</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>windows;mac</td>
      <td>Single-player;Steam Achievements;Full controll...</td>
      <td>Adventure;Indie</td>
      <td>NaN</td>
      <td>[{'id': 256729551, 'name': 'Teaser Beta 2018',...</td>
      <td>0</td>
      <td>{'coming_soon': True, 'date': ''}</td>
      <td>{'url': 'http://www.aridagame.com', 'email': '...</td>
      <td>NaN</td>
      <td>0.00</td>
      <td>1</td>
      <td>Aoca Game Lab</td>
      <td>Aoca Game Lab</td>
    </tr>
    <tr>
      <th>26851</th>
      <td>Nukalypse: The Final War</td>
      <td>947940</td>
      <td>0</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/947...</td>
      <td>NaN</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>windows</td>
      <td>Single-player;Steam Achievements</td>
      <td>Action;Indie;Early Access</td>
      <td>NaN</td>
      <td>[{'id': 256745274, 'name': 'Nukalypse: The Fin...</td>
      <td>0</td>
      <td>{'coming_soon': True, 'date': 'Oct 2019'}</td>
      <td>{'url': '', 'email': 'nukalypse@gmail.com'}</td>
      <td>NaN</td>
      <td>0.00</td>
      <td>1</td>
      <td>Zion Games Studio</td>
      <td>Zion Games Studio</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we predicted, the rows without screenshots are also the rows without a background. It looks like two are unreleased, and if we'd dealt with the <code>release_date</code> column already these would already be removed. One was released recently (5 Jan, 2019), and perhaps didn't have screenshots at the time of downloading, and one simply doesn't have any. As we suspected, it's safe to remove all these rows.</p>
<p>There is also a <code>movies</code> column with similar data. Whilst having more missing values, presumably for games without videos, it appears to contain names, thumbnails and links to various videos and trailers. It's unlikely we'll need them but we can include them in the export and remove them from our data set.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[69]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Movies null values:&#39;</span><span class="p">,</span> <span class="n">desc_df</span><span class="p">[</span><span class="s1">&#39;movies&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">desc_df</span><span class="p">[</span><span class="n">desc_df</span><span class="p">[</span><span class="s1">&#39;movies&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()][</span><span class="s1">&#39;movies&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Movies null values: 1708

</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[69]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#34;[{&#39;id&#39;: 904, &#39;name&#39;: &#39;Half-Life 2 Trailer&#39;, &#39;thumbnail&#39;: &#39;https://steamcdn-a.akamaihd.net/steam/apps/904/movie.jpg?t=1507237301&#39;, &#39;webm&#39;: {&#39;480&#39;: &#39;http://steamcdn-a.akamaihd.net/steam/apps/904/movie480.webm?t=1507237301&#39;, &#39;max&#39;: &#39;http://steamcdn-a.akamaihd.net/steam/apps/904/movie_max.webm?t=1507237301&#39;}, &#39;highlight&#39;: True}, {&#39;id&#39;: 5724, &#39;name&#39;: &#39;Free Yourself&#39;, &#39;thumbnail&#39;: &#39;https://steamcdn-a.akamaihd.net/steam/apps/5724/movie.293x165.jpg?t=1507237311&#39;, &#39;webm&#39;: {&#39;480&#39;: &#39;http://steamcdn-a.akamaihd.net/steam/apps/5724/movie480.webm?t=1507237311&#39;, &#39;max&#39;: &#39;http://steamcdn-a.akamaihd.net/steam/apps/5724/movie_max.webm?t=1507237311&#39;}, &#39;highlight&#39;: False}]&#34;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can now put this all together and define a <code>process_media</code> function.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[70]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process_media</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">export</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove media columns from dataframe, optionally exporting them to csv first.&quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;screenshots&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="n">export</span><span class="p">:</span>
        <span class="n">media_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;steam_appid&#39;</span><span class="p">,</span> <span class="s1">&#39;header_image&#39;</span><span class="p">,</span> <span class="s1">&#39;screenshots&#39;</span><span class="p">,</span> <span class="s1">&#39;background&#39;</span><span class="p">,</span> <span class="s1">&#39;movies&#39;</span><span class="p">]]</span>
        
        <span class="n">export_data</span><span class="p">(</span><span class="n">media_data</span><span class="p">,</span> <span class="s1">&#39;media_data&#39;</span><span class="p">)</span>
        
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;header_image&#39;</span><span class="p">,</span> <span class="s1">&#39;screenshots&#39;</span><span class="p">,</span> <span class="s1">&#39;background&#39;</span><span class="p">,</span> <span class="s1">&#39;movies&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>

<span class="n">media_df</span> <span class="o">=</span> <span class="n">process_media</span><span class="p">(</span><span class="n">desc_df</span><span class="p">,</span> <span class="n">export</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Exported media data to &#39;../data/exports/steam_media_data.csv&#39;
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[71]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># inspect exported data</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/exports/steam_media_data.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[71]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>steam_appid</th>
      <th>header_image</th>
      <th>screenshots</th>
      <th>background</th>
      <th>movies</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/10/...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/10/...</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/20/...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/20/...</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>30</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/30/...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/30/...</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/40/...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/40/...</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>50</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/50/...</td>
      <td>[{'id': 0, 'path_thumbnail': 'https://steamcdn...</td>
      <td>https://steamcdn-a.akamaihd.net/steam/apps/50/...</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Before we move on, we can inspect the memory savings of removing these columns by comparing the output of the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.info.html">DataFrame.info</a> method. If we pass <code>memory_usage="deep"</code> we get the true memory usage of each DataFrame. Without this, pandas estimates the amount used. This is because of the way python stores object (string) columns under the hood. Essentially python keeps track of a list of pointers which point to the actual strings in memory. It's a bit like if you hid a bunch of items around the house, and kept a list of where everything was. You couldn't tell the total size of everything just by looking at the list, but you could take a rough guess. Only by following the list and inspecting each individual item could you get an exact figure.</p>
<p>The blog post '<a href="https://jakevdp.github.io/blog/2014/05/09/why-python-is-slow/">Why Python Is Slow</a>' goes into more detail, but all we need to be aware of is that by passing the parameter we ensure we get the true value of memory usage. We also pass <code>verbose=False</code> to truncate unnecessary output.</p>
<p>We can see that already we have shrunk the memory usage from 285 MB to just under 55 MB. This is great because in general, the smaller the memory footprint the faster our code will run in future. And of course, we're not finished yet.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[72]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Before removing data:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">achiev_df</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">memory_usage</span><span class="o">=</span><span class="s2">&quot;deep&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Data with descriptions and media removed:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">media_df</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">memory_usage</span><span class="o">=</span><span class="s2">&quot;deep&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Before removing data:

&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 27414 entries, 0 to 29234
Columns: 24 entries, name to publisher
dtypes: category(1), float64(1), int64(3), object(19)
memory usage: 285.0 MB

Data with descriptions and media removed:

&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 27391 entries, 0 to 29234
Columns: 17 entries, name to publisher
dtypes: category(1), float64(1), int64(3), object(12)
memory usage: 54.2 MB
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Website-and-Support-Info">Website and Support Info<a class="anchor-link" href="#Website-and-Support-Info">&#182;</a></h3><p>Next we will look at the <code>website</code> and <code>support_info</code> columns. Seen below, they both contain links to external websites. The website column is simply stored as a string whereas the support info column is stored as a dictionary of <code>url</code> and <code>email</code>.</p>
<p>There are a large number of rows with no website listed, and while there are no null values in the <code>support_info</code> column, it looks like many will have empty <code>url</code> and <code>email</code> values inside the data.</p>
<p>For our dataset we'll be dropping both these columns, as they are far too specific to be useful in our analysis. As you may have guessed, we will extract and export this data as we have done before. If not useful, it could be interesting at a later date.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[73]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;website null counts:&#39;</span><span class="p">,</span> <span class="n">media_df</span><span class="p">[</span><span class="s1">&#39;website&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;support_info null counts:&#39;</span><span class="p">,</span> <span class="n">media_df</span><span class="p">[</span><span class="s1">&#39;support_info&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">option_context</span><span class="p">(</span><span class="s2">&quot;display.max_colwidth&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span> <span class="c1"># ensures strings not cut short</span>
    <span class="n">display</span><span class="p">(</span><span class="n">media_df</span><span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;website&#39;</span><span class="p">,</span> <span class="s1">&#39;support_info&#39;</span><span class="p">]][</span><span class="mi">75</span><span class="p">:</span><span class="mi">80</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>website null counts: 9328
support_info null counts: 0
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>website</th>
      <th>support_info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>82</th>
      <td>X: Beyond the Frontier</td>
      <td>http://www.egosoft.com/games/x/info_en.php</td>
      <td>{'url': '', 'email': ''}</td>
    </tr>
    <tr>
      <th>83</th>
      <td>X: Tension</td>
      <td>http://www.egosoft.com/games/x_tension/info_en.php</td>
      <td>{'url': '', 'email': ''}</td>
    </tr>
    <tr>
      <th>84</th>
      <td>X Rebirth</td>
      <td>http://www.egosoft.com/games/x_rebirth/info_en.php</td>
      <td>{'url': 'http://www.egosoft.com/support/index_en.php', 'email': 'info@egosoft.com'}</td>
    </tr>
    <tr>
      <th>85</th>
      <td>688(I) Hunter/Killer</td>
      <td>NaN</td>
      <td>{'url': 'http://strategyfirst.com/products/support.html', 'email': ''}</td>
    </tr>
    <tr>
      <th>86</th>
      <td>Fleet Command</td>
      <td>NaN</td>
      <td>{'url': 'http://strategyfirst.com/products/support.html', 'email': ''}</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We're going to split the support info into two separate columns. We'll keep all the code that parses the columns inside the export <code>if</code> statement, so it only runs if we wish to export to csv. We don't need to worry that the rows with missing website data contain <code>NaN</code> whereas the other two columns contain a blank string (<code>''</code>) for missing data, as once we have exported to csv they will be represented the same way.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[74]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process_info</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">export</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Drop support information from dataframe, optionally exporting beforehand.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">export</span><span class="p">:</span>
        <span class="n">support_info</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;steam_appid&#39;</span><span class="p">,</span> <span class="s1">&#39;website&#39;</span><span class="p">,</span> <span class="s1">&#39;support_info&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        
        <span class="n">support_info</span><span class="p">[</span><span class="s1">&#39;support_info&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">support_info</span><span class="p">[</span><span class="s1">&#39;support_info&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">support_info</span><span class="p">[</span><span class="s1">&#39;support_url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">support_info</span><span class="p">[</span><span class="s1">&#39;support_info&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">])</span>
        <span class="n">support_info</span><span class="p">[</span><span class="s1">&#39;support_email&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">support_info</span><span class="p">[</span><span class="s1">&#39;support_info&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">])</span>
        
        <span class="n">support_info</span> <span class="o">=</span> <span class="n">support_info</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;support_info&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="c1"># only keep rows with at least one piece of information</span>
        <span class="n">support_info</span> <span class="o">=</span> <span class="n">support_info</span><span class="p">[(</span><span class="n">support_info</span><span class="p">[</span><span class="s1">&#39;website&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">|</span> <span class="p">(</span><span class="n">support_info</span><span class="p">[</span><span class="s1">&#39;support_url&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">support_info</span><span class="p">[</span><span class="s1">&#39;support_email&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">)]</span>

        <span class="n">export_data</span><span class="p">(</span><span class="n">support_info</span><span class="p">,</span> <span class="s1">&#39;support_info&#39;</span><span class="p">)</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;website&#39;</span><span class="p">,</span> <span class="s1">&#39;support_info&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>


<span class="n">info_df</span> <span class="o">=</span> <span class="n">process_info</span><span class="p">(</span><span class="n">media_df</span><span class="p">,</span> <span class="n">export</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Exported support info to &#39;../data/exports/steam_support_info.csv&#39;
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[75]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># inspect exported file</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/exports/steam_support_info.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[75]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>steam_appid</th>
      <th>website</th>
      <th>support_url</th>
      <th>support_email</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>NaN</td>
      <td>http://steamcommunity.com/app/10</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>30</td>
      <td>http://www.dayofdefeat.com/</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>50</td>
      <td>NaN</td>
      <td>https://help.steampowered.com</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>70</td>
      <td>http://www.half-life.com/</td>
      <td>http://steamcommunity.com/app/70</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>80</td>
      <td>NaN</td>
      <td>http://steamcommunity.com/app/80</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="System-Requirements">System Requirements<a class="anchor-link" href="#System-Requirements">&#182;</a></h3><p>As you may have noticed, there are three columns containing the system specifications required to run each game on each platform. These columns are <code>pc_requirements</code>, <code>mac_requirements</code>, and <code>linux_requirements</code>. As computing power has increased over the years, this information won't be of particular use in this analysis. It could be fascinating to use as a proxy of how computers have developed over the years, so we'll want to export the data, but we won't be keeping it in this dataset.</p>
<p>Taking a look at the null counts, it looks like there is data for every row.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[76]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">requirements_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pc_requirements&#39;</span><span class="p">,</span> <span class="s1">&#39;mac_requirements&#39;</span><span class="p">,</span> <span class="s1">&#39;linux_requirements&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;null counts:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">requirements_cols</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">col</span><span class="o">+</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">info_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>null counts:

pc_requirements: 0
mac_requirements: 0
linux_requirements: 0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>However if we look at the data a little more closely, we see that some rows actually store an empty list. These won't appear as null rows, but once evaluated won't provide any information, so can be treated as null values.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[77]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">info_df</span><span class="p">[[</span><span class="s1">&#39;steam_appid&#39;</span><span class="p">,</span> <span class="s1">&#39;pc_requirements&#39;</span><span class="p">,</span> <span class="s1">&#39;mac_requirements&#39;</span><span class="p">,</span> <span class="s1">&#39;linux_requirements&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[77]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>steam_appid</th>
      <th>pc_requirements</th>
      <th>mac_requirements</th>
      <th>linux_requirements</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>29230</th>
      <td>1065230</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>[]</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>29231</th>
      <td>1065570</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>[]</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>29232</th>
      <td>1065650</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>[]</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>29233</th>
      <td>1066700</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>29234</th>
      <td>1069460</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>{'minimum': '&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul ...</td>
      <td>[]</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By using a simple boolean filter and checking the shape pararater, we can get a count for how many empty lists there are.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[78]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Empty list counts:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">requirements_cols</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">col</span><span class="o">+</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">info_df</span><span class="p">[</span><span class="n">info_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;[]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Empty list counts:

pc_requirements: 13
mac_requirements: 16141
linux_requirements: 19025
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That's over half of the rows for both mac and linux requirements. That probably means that there is not enough data in these two columns to be too useful.</p>
<p>It turns out that most games are developed solely for windows, with the growth in mac and linux ports only growing in recent years. Naturally it would make sense that any games that aren't supported on mac or linux would not have corresponding requirements.</p>
<p>As we have already cleaned the platforms column, we can check how many rows actually have missing data by comparing rows with empty lists in the requirements column with data in the platform column. If a row has an empty list in the requirements column but the platforms column shows it is supported, it means the data is missing.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[79]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mac_requirements&#39;</span><span class="p">,</span> <span class="s1">&#39;linux_requirements&#39;</span><span class="p">]:</span>
    <span class="n">platform</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">platform</span><span class="o">+</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">info_df</span><span class="p">[(</span><span class="n">info_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;[]&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">info_df</span><span class="p">[</span><span class="s1">&#39;platforms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">platform</span><span class="p">))]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>mac: 133
linux: 154
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Whilst not an insignificant number, this means that the vast majority of rows are as they should be, and we're not looking at too many data errors.</p>
<p>Let's also have a look for missing values in the pc/windows column.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[80]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;windows:&#39;</span><span class="p">,</span> <span class="n">info_df</span><span class="p">[(</span><span class="n">info_df</span><span class="p">[</span><span class="s1">&#39;pc_requirements&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;[]&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">info_df</span><span class="p">[</span><span class="s1">&#39;platforms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;windows&#39;</span><span class="p">))]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>windows: 9
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Only 9 rows have missing system requirements. We can take a look at some of them below, and follow the links to the steam pages to try and discover if anything is amiss.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[81]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">missing_windows_requirements</span> <span class="o">=</span> <span class="n">info_df</span><span class="p">[(</span><span class="n">info_df</span><span class="p">[</span><span class="s1">&#39;pc_requirements&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;[]&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">info_df</span><span class="p">[</span><span class="s1">&#39;platforms&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;windows&#39;</span><span class="p">))]</span>

<span class="n">print_steam_links</span><span class="p">(</span><span class="n">missing_windows_requirements</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Uplink: https://store.steampowered.com/app/1510
Battlestations: Midway: https://store.steampowered.com/app/6870
Grand Theft Auto 2: https://store.steampowered.com/app/12180
Shift 2 Unleashed: https://store.steampowered.com/app/47920
iBomber Defense: https://store.steampowered.com/app/104000
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There doesn't appear to be any common issue in these rows - some of the games are quite old but that's about it. It may simply be that no requirements were supplied when the games were added to the steam store.</p>
<p>We can assume that a cross-platform game will have similar requirements in terms of hardware for each platform it supports. With this in mind we can focus on the <code>pc_requirements</code> column, and use the <code>platforms</code> column to tell us which other platforms are supported.</p>
<p>Now we will take a look at a couple of rows from the dataset, to observe the structure of the stored data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[82]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">info_df</span><span class="p">[</span><span class="s1">&#39;pc_requirements&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">info_df</span><span class="p">[</span><span class="s1">&#39;pc_requirements&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2000</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">info_df</span><span class="p">[</span><span class="s1">&#39;pc_requirements&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">15000</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>&#34;{&#39;minimum&#39;: &#39;\\r\\n\\t\\t\\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/strong&gt; 500 mhz processor, 96mb ram, 16mb video card, Windows XP, Mouse, Keyboard, Internet Connection&lt;br /&gt;&lt;/p&gt;\\r\\n\\t\\t\\t&lt;p&gt;&lt;strong&gt;Recommended:&lt;/strong&gt; 800 mhz processor, 128mb ram, 32mb+ video card, Windows XP, Mouse, Keyboard, Internet Connection&lt;br /&gt;&lt;/p&gt;\\r\\n\\t\\t\\t&#39;}&#34;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>&#39;{\&#39;minimum\&#39;: \&#39;&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul class=&#34;bb_ul&#34;&gt;&lt;li&gt;&lt;strong&gt;OS:&lt;/strong&gt; Microsoft® Windows® XP, Windows Server 2008, Windows Vista® Home Premium, Business, Ultimate, or Enterprise (including 64 bit editions) with Service Pack 2, Windows 7, or Windows 8 Classic&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Processor:&lt;/strong&gt; 2.33GHz or faster x86-compatible processor, or Intel Atom™ 1.6GHz or faster processor for netbook class devices&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Memory:&lt;/strong&gt; 2 GB RAM&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Storage:&lt;/strong&gt; 1400 MB available space&lt;/li&gt;&lt;/ul&gt;\&#39;, \&#39;recommended\&#39;: \&#39;&lt;strong&gt;Recommended:&lt;/strong&gt;&lt;br&gt;&lt;ul class=&#34;bb_ul&#34;&gt;&lt;li&gt;&lt;strong&gt;OS:&lt;/strong&gt; Microsoft® Windows® XP, Windows Server 2008, Windows Vista® Home Premium, Business, Ultimate, or Enterprise (including 64 bit editions) with Service Pack 2, Windows 7, or Windows 8 Classic&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Processor:&lt;/strong&gt; 2.33GHz or faster x86-compatible processor, or Intel Atom™ 1.6GHz or faster processor for netbook class devices&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Memory:&lt;/strong&gt; 4 GB RAM&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Storage:&lt;/strong&gt; 1400 MB available space&lt;/li&gt;&lt;/ul&gt;\&#39;}&#39;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>&#39;{\&#39;minimum\&#39;: \&#39;&lt;strong&gt;Minimum:&lt;/strong&gt;&lt;br&gt;&lt;ul class=&#34;bb_ul&#34;&gt;&lt;li&gt;Requires a 64-bit processor and operating system&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;OS:&lt;/strong&gt; Windows 8 / 10 - 64-bit&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Processor:&lt;/strong&gt; 2Ghz Intel CPU&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Memory:&lt;/strong&gt; 2 GB RAM&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Graphics:&lt;/strong&gt; 1024MB VRAM&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;DirectX:&lt;/strong&gt; Version 9.0&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Network:&lt;/strong&gt; Broadband Internet connection&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Storage:&lt;/strong&gt; 10 GB available space&lt;/li&gt;&lt;/ul&gt;\&#39;, \&#39;recommended\&#39;: \&#39;&lt;strong&gt;Recommended:&lt;/strong&gt;&lt;br&gt;&lt;ul class=&#34;bb_ul&#34;&gt;&lt;li&gt;Requires a 64-bit processor and operating system&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;OS:&lt;/strong&gt; Windows 10 - 64-bit&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Processor:&lt;/strong&gt; 2.60Ghz Intel Core i7 CPU&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Memory:&lt;/strong&gt; 16 GB RAM&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Graphics:&lt;/strong&gt; 4GB VRAM&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Network:&lt;/strong&gt; Broadband Internet connection&lt;br&gt;&lt;/li&gt;&lt;li&gt;&lt;strong&gt;Storage:&lt;/strong&gt; 10 GB available space&lt;/li&gt;&lt;/ul&gt;\&#39;}&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The data is stored as a dictionary, as we've seen before. There is definitely a key for <code>minimum</code>, but apart from that it is hard to see at a glance. The strings are full of html formatting, which is presumably parsed to display the information on the website. It also looks like there are different categories like <code>Processor</code> and <code>Memory</code> for some of the rows.</p>
<p>Let's take a stab and cleaning out some of the unnessecary formatting and see if it becomes clearer.</p>
<p>By creating a dataframe from a selection of rows, we can easily and quickly make changes using the pandas .str accessor, allowing us to use python string formatting and regular expressions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[83]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">view_requirements</span> <span class="o">=</span> <span class="n">info_df</span><span class="p">[</span><span class="s1">&#39;pc_requirements&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">15000</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">view_requirements</span> <span class="o">=</span> <span class="p">(</span><span class="n">view_requirements</span>
                         <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">[rtn]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                         <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&lt;[pbr]{1,2}&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
                         <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&lt;[\/&quot;=\w\s]+&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">view_requirements</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
    <span class="n">display</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>&#34;{&#39;minimum&#39;: &#39; Minimum: 500 mhz processor, 96mb ram, 16mb video card, Windows XP, Mouse, Keyboard, Internet Connection Recommended: 800 mhz processor, 128mb ram, 32mb+ video card, Windows XP, Mouse, Keyboard, Internet Connection&#39;}&#34;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>&#34;{&#39;minimum&#39;: &#39;Minimum: OS: Microsoft® Windows® XP, Windows Server 2008, Windows Vista® Home Premium, Business, Ultimate, or Enterprise (including 64 bit editions) with Service Pack 2, Windows 7, or Windows 8 Classic Processor: 2.33GHz or faster x86-compatible processor, or Intel Atom™ 1.6GHz or faster processor for netbook class devices Memory: 2 GB RAM Storage: 1400 MB available space&#39;, &#39;recommended&#39;: &#39;Recommended: OS: Microsoft® Windows® XP, Windows Server 2008, Windows Vista® Home Premium, Business, Ultimate, or Enterprise (including 64 bit editions) with Service Pack 2, Windows 7, or Windows 8 Classic Processor: 2.33GHz or faster x86-compatible processor, or Intel Atom™ 1.6GHz or faster processor for netbook class devices Memory: 4 GB RAM Storage: 1400 MB available space&#39;}&#34;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>&#34;{&#39;minimum&#39;: &#39;Minimum: Requires a 64-bit processor and operating system OS: Windows 8 / 10 - 64-bit Processor: 2Ghz Intel CPU Memory: 2 GB RAM Graphics: 1024MB VRAM DirectX: Version 9.0 Network: Broadband Internet connection Storage: 10 GB available space&#39;, &#39;recommended&#39;: &#39;Recommended: Requires a 64-bit processor and operating system OS: Windows 10 - 64-bit Processor: 2.60Ghz Intel Core i7 CPU Memory: 16 GB RAM Graphics: 4GB VRAM Network: Broadband Internet connection Storage: 10 GB available space&#39;}&#34;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can now see more clearly the contents and structure of these rows. Some rows have both <code>Minimum</code> and <code>Recommended</code> requirements inside a <code>minimum</code> key, and some have separate <code>minimum</code> and <code>recommended</code> keys. Some have headings like <code>Processor:</code> and <code>Storage:</code> before various components, others simply have a list of components. Some state particular speeds for components, like 2 Ghz CPU, others state specific models, like 'Intel Core 2 Duo', amongst this information.</p>
<p>It seems like it would be possible to extract invidivual component information from this data, however it would be a lengthy and complex process worthy of another project. With that in mind, it seems best to proceed by slightly cleaning the data before exporting it, but not trying to deal with individual components right now.</p>
<p>We'll export the raw data, and split out the data in the <code>minimum</code> and <code>recommended</code> keys. This will mean lots of rows still have recommended data hidden inside the minimum key, but this will do for now.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[84]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process_requirements</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">export</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">export</span><span class="p">:</span>
        <span class="n">requirements</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;steam_appid&#39;</span><span class="p">,</span> <span class="s1">&#39;pc_requirements&#39;</span><span class="p">,</span> <span class="s1">&#39;mac_requirements&#39;</span><span class="p">,</span> <span class="s1">&#39;linux_requirements&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        
        <span class="c1"># remove rows with missing pc requirements</span>
        <span class="n">requirements</span> <span class="o">=</span> <span class="n">requirements</span><span class="p">[</span><span class="n">requirements</span><span class="p">[</span><span class="s1">&#39;pc_requirements&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;[]&#39;</span><span class="p">]</span>
        
        <span class="n">requirements</span><span class="p">[</span><span class="s1">&#39;requirements_clean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">requirements</span><span class="p">[</span><span class="s1">&#39;pc_requirements&#39;</span><span class="p">]</span>
                                                  <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">[rtn]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                                                  <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&lt;[pbr]{1,2}&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
                                                  <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&lt;[\/&quot;=\w\s]+&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                                             <span class="p">)</span>
        
        <span class="n">requirements</span><span class="p">[</span><span class="s1">&#39;requirements_clean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">requirements</span><span class="p">[</span><span class="s1">&#39;requirements_clean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        
        <span class="c1"># split out minimum and recommended into separate columns</span>
        <span class="n">requirements</span><span class="p">[</span><span class="s1">&#39;minimum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">requirements</span><span class="p">[</span><span class="s1">&#39;requirements_clean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;minimum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Minimum:&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;minimum&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">requirements</span><span class="p">[</span><span class="s1">&#39;recommended&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">requirements</span><span class="p">[</span><span class="s1">&#39;requirements_clean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;recommended&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Recommended:&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;recommended&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        
        <span class="n">requirements</span> <span class="o">=</span> <span class="n">requirements</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;requirements_clean&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">export_data</span><span class="p">(</span><span class="n">requirements</span><span class="p">,</span> <span class="s1">&#39;requirements_data&#39;</span><span class="p">)</span>
        
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;pc_requirements&#39;</span><span class="p">,</span> <span class="s1">&#39;mac_requirements&#39;</span><span class="p">,</span> <span class="s1">&#39;linux_requirements&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>

<span class="n">reqs_df</span> <span class="o">=</span> <span class="n">process_requirements</span><span class="p">(</span><span class="n">info_df</span><span class="p">,</span> <span class="n">export</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Exported requirements data to &#39;../data/exports/steam_requirements_data.csv&#39;
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[85]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># verify export</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/exports/steam_requirements_data.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[85]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>steam_appid</th>
      <th>pc_requirements</th>
      <th>mac_requirements</th>
      <th>linux_requirements</th>
      <th>minimum</th>
      <th>recommended</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>500 mhz processor, 96mb ram, 16mb video card, ...</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>500 mhz processor, 96mb ram, 16mb video card, ...</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>30</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>500 mhz processor, 96mb ram, 16mb video card, ...</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>500 mhz processor, 96mb ram, 16mb video card, ...</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>50</td>
      <td>{'minimum': '\r\n\t\t\t&lt;p&gt;&lt;strong&gt;Minimum:&lt;/st...</td>
      <td>{'minimum': 'Minimum: OS X  Snow Leopard 10.6....</td>
      <td>{'minimum': 'Minimum: Linux Ubuntu 12.04, Dual...</td>
      <td>500 mhz processor, 96mb ram, 16mb video card, ...</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Processing-Release-Date">Processing Release Date<a class="anchor-link" href="#Processing-Release-Date">&#182;</a></h2><p>We're almost finished, and the final column to clean is <code>release_date</code>. It provides the opportunity for an interesting exploration of code optimisation, so we'll be walking through the development process in a separate post. For now, we'll just include the complete function to run on the dataset.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[86]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># export data for optimisation post</span>
<span class="n">reqs_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../data/exports/steam_partially_clean.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[87]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process_release_date</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">eval_date</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;coming_soon&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span> <span class="c1"># return blank string so can drop missing at end</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span>
    
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;release_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;release_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">eval_date</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">parse_date</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[\d]{1,2} [A-Za-z]</span><span class="si">{3}</span><span class="s1">, [\d]</span><span class="si">{4}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[A-Za-z]</span><span class="si">{3}</span><span class="s1"> [\d]</span><span class="si">{4}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;1 &#39;</span> <span class="o">+</span> <span class="n">x</span>
        <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Should be everything, print out anything left just in case</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;release_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;release_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">parse_date</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;release_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;release_date&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> %b %Y&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;release_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>
    
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can now update the <code>process</code> function once more, and run the full cleaning process on the raw dataset.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[88]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Process data set. Will eventually contain calls to all functions we write.&quot;&quot;&quot;</span>
    
    <span class="c1"># Copy the input dataframe to avoid accidentally modifying original data</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="c1"># Remove duplicate rows - all appids should be unique</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
    
    <span class="c1"># Remove collumns with more than 50% null values</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">drop_null_cols</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    
    <span class="c1"># Process columns</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_name_type</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_age</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_platforms</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_price</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_language</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_developers_and_publishers</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_categories_and_genres</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_achievements_and_descriptors</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>  
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_release_date</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    
    <span class="c1"># Process columns which export data</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_descriptions</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">export</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_media</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">export</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_info</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">export</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_requirements</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">export</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>

<span class="n">steam_data</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">raw_steam_data</span><span class="p">)</span>
<span class="n">steam_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Exported description data to &#39;../data/exports/steam_description_data.csv&#39;
Exported media data to &#39;../data/exports/steam_media_data.csv&#39;
Exported support info to &#39;../data/exports/steam_support_info.csv&#39;
Exported requirements data to &#39;../data/exports/steam_requirements_data.csv&#39;
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[88]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>steam_appid</th>
      <th>required_age</th>
      <th>platforms</th>
      <th>categories</th>
      <th>genres</th>
      <th>achievements</th>
      <th>release_date</th>
      <th>price</th>
      <th>english</th>
      <th>developer</th>
      <th>publisher</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Counter-Strike</td>
      <td>10</td>
      <td>0</td>
      <td>windows;mac;linux</td>
      <td>Multi-player;Online Multi-Player;Local Multi-P...</td>
      <td>Action</td>
      <td>0</td>
      <td>2000-11-01</td>
      <td>7.19</td>
      <td>1</td>
      <td>Valve</td>
      <td>Valve</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Team Fortress Classic</td>
      <td>20</td>
      <td>0</td>
      <td>windows;mac;linux</td>
      <td>Multi-player;Online Multi-Player;Local Multi-P...</td>
      <td>Action</td>
      <td>0</td>
      <td>1999-04-01</td>
      <td>3.99</td>
      <td>1</td>
      <td>Valve</td>
      <td>Valve</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Day of Defeat</td>
      <td>30</td>
      <td>0</td>
      <td>windows;mac;linux</td>
      <td>Multi-player;Valve Anti-Cheat enabled</td>
      <td>Action</td>
      <td>0</td>
      <td>2003-05-01</td>
      <td>3.99</td>
      <td>1</td>
      <td>Valve</td>
      <td>Valve</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Deathmatch Classic</td>
      <td>40</td>
      <td>0</td>
      <td>windows;mac;linux</td>
      <td>Multi-player;Online Multi-Player;Local Multi-P...</td>
      <td>Action</td>
      <td>0</td>
      <td>2001-06-01</td>
      <td>3.99</td>
      <td>1</td>
      <td>Valve</td>
      <td>Valve</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Half-Life: Opposing Force</td>
      <td>50</td>
      <td>0</td>
      <td>windows;mac;linux</td>
      <td>Single-player;Multi-player;Valve Anti-Cheat en...</td>
      <td>Action</td>
      <td>0</td>
      <td>1999-11-01</td>
      <td>3.99</td>
      <td>1</td>
      <td>Gearbox Software</td>
      <td>Valve</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Final-Steps">Final Steps<a class="anchor-link" href="#Final-Steps">&#182;</a></h2><p>That just about does is for cleaning the Steam data. Hopefully we have a cleaned dataset ready to be combined with the data downloaded from SteamSpy, once that is cleaned.</p>
<p>Before we export the cleaned steam data, we'll check that we have eradicated missing values, and have a look at the memory footprint like we did earlier.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[89]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">steam_data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[89]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>name            0
steam_appid     0
required_age    0
platforms       0
categories      0
genres          0
achievements    0
release_date    0
price           0
english         0
developer       0
publisher       0
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[90]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">raw_steam_data</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">memory_usage</span><span class="o">=</span><span class="s2">&quot;deep&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 29235 entries, 0 to 29234
Columns: 39 entries, type to content_descriptors
dtypes: float64(2), int64(1), object(36)
memory usage: 390.0 MB
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[91]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">steam_data</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">memory_usage</span><span class="o">=</span><span class="s2">&quot;deep&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 27332 entries, 0 to 29234
Columns: 12 entries, name to publisher
dtypes: category(1), datetime64[ns](1), float64(1), int64(3), object(6)
memory usage: 13.8 MB
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It looks like we've taken care of all the null values, and the size of the dataset has been reduced considerably.</p>
<p>We'll also check that no unreleased games have slipped through (data was scraped on or before 1st May, 2019).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[92]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">steam_data</span><span class="p">[</span><span class="n">steam_data</span><span class="p">[</span><span class="s1">&#39;release_date&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="s1">&#39;2019-05-01&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[92]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>steam_appid</th>
      <th>required_age</th>
      <th>platforms</th>
      <th>categories</th>
      <th>genres</th>
      <th>achievements</th>
      <th>release_date</th>
      <th>price</th>
      <th>english</th>
      <th>developer</th>
      <th>publisher</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we're happy with our dataframe we are ready to export to file and finish this part of the project.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[93]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">steam_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../data/exports/steam_data_clean.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As I said at the beginning, data cleaning can be a very lengthy process. We definitely could have taken some shortcuts, and didn't have to go into so much depth, but I think it was interesting and valuable to go through the data as thoroughly as we did. A useful side effect of this is that we're now much more familiar with the data, and this should be incredibly useful when it comes to analysis. One of the most important prerequisites for data analysis is having good data, and the foundation of this is built upon solid data cleaning.</p>
<p>Next time we'll take a look at optimising the processing of the <code>release_date</code> column, as mentioned, then move onto cleaning the SteamSpy data. Once that is complete we can begin exploring and analysing the data.</p>

</div>
</div>
</div>
 


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
</p>
<p>Thanks for joining me, and I welcome any feedback or suggestions you may have in the comments below.</p>
        </div>

        <div class="meta">
            <div>
                    <a href="https://nik-davis.github.io/tag/steam.html" class="tag">steam</a>
                    <a href="https://nik-davis.github.io/tag/jupyter.html" class="tag">jupyter</a>
                    <a href="https://nik-davis.github.io/tag/python.html" class="tag">python</a>
                    <a href="https://nik-davis.github.io/tag/data.html" class="tag">data</a>
                    <a href="https://nik-davis.github.io/tag/cleaning.html" class="tag">cleaning</a>
            </div>
        </div>
        <div class="comments">
            <h1>Comments</h1>
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'nikdavis';
                var disqus_identifier = 'posts/2019/steam-data-cleaning/';
                var disqus_url = 'https://nik-davis.github.io/posts/2019/steam-data-cleaning/';
                (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//nikdavis.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
    </article>
</div>

    </div>

<!-- <footer>
    <p>
    © 2012-2017 Nik Davis, license <a href=""> </a>
    unless otherwise noted.
    Generated by <a href= "http://docs.getpelican.com/">Pelican</a>.
    </p>
</footer> -->

</body>
</html>