<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="Nik Davis">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SteamSpy Data Cleaning in Python | Nik Davis</title>

    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="alternate" type="application/atom+xml" title="Nik Davis blog atom feed" href="/feeds/all.atom.xml" />

    <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700'>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
    <link rel="stylesheet" href="/theme/css/style.css"/>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    
<!-- <link rel="stylesheet" type="text/css" href="/theme/css/ipynb.css"/> -->
<!-- <link rel="stylesheet" type="text/css" href="/theme/css/ipynb-from-download.css"/> -->
</head>

<body>
    <nav class="navbar navbar-expand-md navbar-dark">
        <a class="navbar-brand" href="/" title="Home">Nik Davis</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
            <span class="navbar-toggler-icon"></span>
        </button>
        
        <div class="collapse navbar-collapse" id="collapsibleNavbar">
            <ul class="navbar-nav ml-md-auto">
                    <li class="nav-item">
                        <a class="nav-link social" href="http://github.com/nik-davis" rel="me" target="_blank"><i class="fab fa-github"></i></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link social" href="http://twitter.com/nikdavis0" rel="me" target="_blank"><i class="fab fa-twitter"></i></a>
                    </li>                    <li class="nav-item">
                        <a class="nav-link social" href="https://www.linkedin.com/in/nik-davis" rel="me" target="_blank"><i class="fab fa-linkedin-in"></i></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link social" href="https://stackoverflow.com/users/10202890/nik-davis" rel="me" target="_blank"><i class="fab fa-stack-overflow"></i></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/pages/about.html" title="About">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/archives.html" title="Archive">Archive</a>
                    </li>
            </ul>
        </div>
    </nav>

    <div id="wrap">
<div class="container post">
    <article>
        <header>
            <h1>SteamSpy Data Cleaning in Python</h1>
            <time datetime="article.date.isoformat()" pubdate>Thu 13 June 2019</time>
        </header>

        <div class="article_content">
            <p><em>This post forms part of a larger series on downloading, processing and analysing data from the Steam store. <a href="https://nik-davis.github.io/tag/steam.html">See all posts here</a>.</em></p>
<p><em>View original notebook on <a href="https://github.com/nik-davis/steam-data-science-project">github</a> (<a href="http://nik-davis.github.io/notebooks/steam/4-data-cleaning-steamspy.ipynb">Download</a>). Datasets available on <a href="https://www.kaggle.com/nikdavis/datasets">Kaggle</a>.</em></p>
<p>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Hello and welcome back to this final part of data cleaning. Once we're finished here we'll be ready to move on to exploring and analysing the data.</p>
<p>As a quick re-cap, so far we have downloaded information on games from the Steam Store via the Steam API and SteamSpy API. We have cleaned and processed the data from the Steam API, and in this section we'll walkthrough cleaning data downloaded from the SteamSpy API. The overall goal of this project is to collect, clean and analyse data from the Steam Store with the idea of advising a fictional game developer or company.</p>
<p>The previous posts when into great depth about the decisions made and methods used. This post will still go over a number of decisions, but will be more in the style of a brief overview than full discussion.</p>
<h2 id="Import-Libraries-and-Inspect-Data">Import Libraries and Inspect Data<a class="anchor-link" href="#Import-Libraries-and-Inspect-Data">&#182;</a></h2><p>Let's begin by importing the necessary libraries and inspecting the raw downloaded data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># standard library imports</span>
<span class="kn">from</span> <span class="nn">ast</span> <span class="k">import</span> <span class="n">literal_eval</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="c1"># import time</span>
<span class="c1"># import re</span>

<span class="c1"># third-party imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># customisations</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;max_columns&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">raw_steamspy_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/raw/steamspy_data.csv&#39;</span><span class="p">)</span>
<span class="n">raw_steamspy_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[2]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>appid</th>
      <th>name</th>
      <th>developer</th>
      <th>publisher</th>
      <th>score_rank</th>
      <th>positive</th>
      <th>negative</th>
      <th>userscore</th>
      <th>owners</th>
      <th>average_forever</th>
      <th>average_2weeks</th>
      <th>median_forever</th>
      <th>median_2weeks</th>
      <th>price</th>
      <th>initialprice</th>
      <th>discount</th>
      <th>languages</th>
      <th>genre</th>
      <th>ccu</th>
      <th>tags</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>Counter-Strike</td>
      <td>Valve</td>
      <td>Valve</td>
      <td>NaN</td>
      <td>124534</td>
      <td>3339</td>
      <td>0</td>
      <td>10,000,000 .. 20,000,000</td>
      <td>17612</td>
      <td>709</td>
      <td>317</td>
      <td>26</td>
      <td>999.0</td>
      <td>999.0</td>
      <td>0.0</td>
      <td>English, French, German, Italian, Spanish - Sp...</td>
      <td>Action</td>
      <td>14923</td>
      <td>{'Action': 2681, 'FPS': 2048, 'Multiplayer': 1...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>Team Fortress Classic</td>
      <td>Valve</td>
      <td>Valve</td>
      <td>NaN</td>
      <td>3318</td>
      <td>633</td>
      <td>0</td>
      <td>5,000,000 .. 10,000,000</td>
      <td>277</td>
      <td>15</td>
      <td>62</td>
      <td>15</td>
      <td>499.0</td>
      <td>499.0</td>
      <td>0.0</td>
      <td>English, French, German, Italian, Spanish - Sp...</td>
      <td>Action</td>
      <td>87</td>
      <td>{'Action': 208, 'FPS': 188, 'Multiplayer': 172...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>30</td>
      <td>Day of Defeat</td>
      <td>Valve</td>
      <td>Valve</td>
      <td>NaN</td>
      <td>3416</td>
      <td>398</td>
      <td>0</td>
      <td>5,000,000 .. 10,000,000</td>
      <td>187</td>
      <td>0</td>
      <td>34</td>
      <td>0</td>
      <td>499.0</td>
      <td>499.0</td>
      <td>0.0</td>
      <td>English, French, German, Italian, Spanish - Spain</td>
      <td>Action</td>
      <td>130</td>
      <td>{'FPS': 138, 'World War II': 122, 'Multiplayer...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>Deathmatch Classic</td>
      <td>Valve</td>
      <td>Valve</td>
      <td>NaN</td>
      <td>1273</td>
      <td>267</td>
      <td>0</td>
      <td>5,000,000 .. 10,000,000</td>
      <td>258</td>
      <td>0</td>
      <td>184</td>
      <td>0</td>
      <td>499.0</td>
      <td>499.0</td>
      <td>0.0</td>
      <td>English, French, German, Italian, Spanish - Sp...</td>
      <td>Action</td>
      <td>4</td>
      <td>{'Action': 85, 'FPS': 71, 'Multiplayer': 58, '...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>50</td>
      <td>Half-Life: Opposing Force</td>
      <td>Gearbox Software</td>
      <td>Valve</td>
      <td>NaN</td>
      <td>5250</td>
      <td>288</td>
      <td>0</td>
      <td>5,000,000 .. 10,000,000</td>
      <td>624</td>
      <td>0</td>
      <td>415</td>
      <td>0</td>
      <td>499.0</td>
      <td>499.0</td>
      <td>0.0</td>
      <td>English, French, German, Korean</td>
      <td>Action</td>
      <td>71</td>
      <td>{'FPS': 235, 'Action': 211, 'Sci-fi': 166, 'Si...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are a lot of columns here that will overlap with columns we already dealt with in the Steam data. This is fine because it means we don't have to clean them here, and can simply use the columns from the other dataset.</p>
<p>A few columns in this data that could be valuable are <code>positive</code>, <code>negative</code>, <code>userscore</code>, <code>owners</code> and <code>average_forever</code>. We'll begin by looking at the null counts for each column.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">raw_steamspy_data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[3]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>appid                  0
name                   5
developer            197
publisher            280
score_rank         29177
positive               0
negative               0
userscore              0
owners                 0
average_forever        0
average_2weeks         0
median_forever         0
median_2weeks          0
price                 29
initialprice          22
discount              22
languages             94
genre                152
ccu                    0
tags                   0
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Most of the columns look fine, with only a few tens or hundreds of missing values, or none at all. The only column we'll remove for certain is the <code>score_rank</code> column, as it has far too many null values to be useful.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Handling-missing-values">Handling missing values<a class="anchor-link" href="#Handling-missing-values">&#182;</a></h2><p>There are some columns we'll be removing, as they're present in the other dataset. Before we do we can investigate the missing values, to decide whether we should remove these rows first. We don't need to go through every column, but just look at a few individual ones.</p>
<p>In the <code>name</code> column, we have five rows with missing data, and four more rows where the name is 'none'. We'll certainly remove all 9 of these rows.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">raw_steamspy_data</span><span class="p">[</span><span class="n">raw_steamspy_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[4]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>appid</th>
      <th>name</th>
      <th>developer</th>
      <th>publisher</th>
      <th>score_rank</th>
      <th>positive</th>
      <th>negative</th>
      <th>userscore</th>
      <th>owners</th>
      <th>average_forever</th>
      <th>average_2weeks</th>
      <th>median_forever</th>
      <th>median_2weeks</th>
      <th>price</th>
      <th>initialprice</th>
      <th>discount</th>
      <th>languages</th>
      <th>genre</th>
      <th>ccu</th>
      <th>tags</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>481</th>
      <td>17760</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0 .. 20,000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>7235</th>
      <td>396420</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>22</td>
      <td>9</td>
      <td>0</td>
      <td>20,000 .. 50,000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>{'Free to Play': 24, 'Action': 21, 'Indie': 21...</td>
    </tr>
    <tr>
      <th>9553</th>
      <td>460250</td>
      <td>NaN</td>
      <td>Jeroen Wimmers</td>
      <td>Jeroen Wimmers</td>
      <td>NaN</td>
      <td>44</td>
      <td>4</td>
      <td>0</td>
      <td>0 .. 20,000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>899.0</td>
      <td>899.0</td>
      <td>0.0</td>
      <td>English, French, Italian, German, Spanish - Sp...</td>
      <td>Casual, Indie</td>
      <td>0</td>
      <td>{'Indie': 34, 'Casual': 24, 'Puzzle': 15, 'Min...</td>
    </tr>
    <tr>
      <th>22244</th>
      <td>806160</td>
      <td>NaN</td>
      <td>Paleno Games</td>
      <td>Paleno Games</td>
      <td>NaN</td>
      <td>4</td>
      <td>13</td>
      <td>0</td>
      <td>0 .. 20,000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>99.0</td>
      <td>99.0</td>
      <td>0.0</td>
      <td>English, French, Italian, German, Spanish - Sp...</td>
      <td>Action, Adventure, Casual, Indie</td>
      <td>0</td>
      <td>{'Action': 22, 'Indie': 22, 'Casual': 21, 'Adv...</td>
    </tr>
    <tr>
      <th>27324</th>
      <td>965340</td>
      <td>NaN</td>
      <td>2nd Studio</td>
      <td>2nd Studio</td>
      <td>NaN</td>
      <td>31</td>
      <td>1</td>
      <td>0</td>
      <td>0 .. 20,000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>199.0</td>
      <td>199.0</td>
      <td>0.0</td>
      <td>English, German, Danish, Japanese, Russian, Si...</td>
      <td>Action, Indie, Simulation</td>
      <td>0</td>
      <td>{'Indie': 32, 'Sexual Content': 31, 'Action': ...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">raw_steamspy_data</span><span class="p">[</span><span class="n">raw_steamspy_data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[5]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>appid</th>
      <th>name</th>
      <th>developer</th>
      <th>publisher</th>
      <th>score_rank</th>
      <th>positive</th>
      <th>negative</th>
      <th>userscore</th>
      <th>owners</th>
      <th>average_forever</th>
      <th>average_2weeks</th>
      <th>median_forever</th>
      <th>median_2weeks</th>
      <th>price</th>
      <th>initialprice</th>
      <th>discount</th>
      <th>languages</th>
      <th>genre</th>
      <th>ccu</th>
      <th>tags</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4918</th>
      <td>339860</td>
      <td>none</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>84</td>
      <td>32</td>
      <td>0</td>
      <td>50,000 .. 100,000</td>
      <td>309</td>
      <td>0</td>
      <td>325</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>English</td>
      <td>Adventure, Indie, Massively Multiplayer, RPG, ...</td>
      <td>0</td>
      <td>{'Indie': 34, 'RPG': 33, 'Adventure': 32, 'Mas...</td>
    </tr>
    <tr>
      <th>6779</th>
      <td>385020</td>
      <td>none</td>
      <td>none</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14</td>
      <td>26</td>
      <td>0</td>
      <td>20,000 .. 50,000</td>
      <td>262</td>
      <td>0</td>
      <td>272</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>English, French, Italian, German, Spanish - Sp...</td>
      <td>Casual, Indie, Massively Multiplayer, Strategy</td>
      <td>0</td>
      <td>{'Indie': 32, 'Strategy': 31, 'Casual': 21, 'M...</td>
    </tr>
    <tr>
      <th>7350</th>
      <td>398970</td>
      <td>none</td>
      <td>none</td>
      <td>none</td>
      <td>NaN</td>
      <td>10</td>
      <td>21</td>
      <td>0</td>
      <td>20,000 .. 50,000</td>
      <td>259</td>
      <td>0</td>
      <td>272</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>English</td>
      <td>Adventure, Indie, Massively Multiplayer, RPG, ...</td>
      <td>0</td>
      <td>{'Massively Multiplayer': 27, 'Strategy': 23, ...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are 197 rows with missing developer data, and 280 rows with missing publisher data. It's conceivable that a small studio may self-publish, but we'll say that a title must have a developer for it to be kept. We can remove the rows with missing developer data, but then we'll be removing both of these columns as this information is already provided in the Steam data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">raw_steamspy_data</span><span class="p">[</span><span class="n">raw_steamspy_data</span><span class="p">[</span><span class="s1">&#39;developer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>appid</th>
      <th>name</th>
      <th>developer</th>
      <th>publisher</th>
      <th>score_rank</th>
      <th>positive</th>
      <th>negative</th>
      <th>userscore</th>
      <th>owners</th>
      <th>average_forever</th>
      <th>average_2weeks</th>
      <th>median_forever</th>
      <th>median_2weeks</th>
      <th>price</th>
      <th>initialprice</th>
      <th>discount</th>
      <th>languages</th>
      <th>genre</th>
      <th>ccu</th>
      <th>tags</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8774</th>
      <td>439400</td>
      <td>Legends of Callasia Demo</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0 .. 20,000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>568</th>
      <td>23130</td>
      <td>Mole Control</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0 .. 20,000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>18399</th>
      <td>703610</td>
      <td>Space Girls</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>70</td>
      <td>81</td>
      <td>0</td>
      <td>20,000 .. 50,000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>99.0</td>
      <td>99.0</td>
      <td>0.0</td>
      <td>English, Russian</td>
      <td>Sexual Content, Nudity, Action, Casual, Indie</td>
      <td>0</td>
      <td>{'Nudity': 26, 'Sexual Content': 25, 'Action':...</td>
    </tr>
    <tr>
      <th>2207</th>
      <td>247910</td>
      <td>Sniper Elite: Nazi Zombie Army 2</td>
      <td>NaN</td>
      <td>Rebellion</td>
      <td>NaN</td>
      <td>3069</td>
      <td>554</td>
      <td>0</td>
      <td>200,000 .. 500,000</td>
      <td>289</td>
      <td>0</td>
      <td>335</td>
      <td>0</td>
      <td>1499.0</td>
      <td>1499.0</td>
      <td>0.0</td>
      <td>English, French, Italian, German, Spanish - Sp...</td>
      <td>Action, Adventure</td>
      <td>23</td>
      <td>{'Zombies': 294, 'Action': 185, 'Co-op': 171, ...</td>
    </tr>
    <tr>
      <th>15367</th>
      <td>619730</td>
      <td>Mad Driver</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>46</td>
      <td>48</td>
      <td>0</td>
      <td>100,000 .. 200,000</td>
      <td>287</td>
      <td>0</td>
      <td>294</td>
      <td>0</td>
      <td>99.0</td>
      <td>99.0</td>
      <td>0.0</td>
      <td>English, Russian</td>
      <td>Casual, Indie, Racing, Strategy</td>
      <td>0</td>
      <td>{'Strategy': 21, 'Indie': 21, 'Casual': 21, 'R...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">raw_steamspy_data</span><span class="p">[</span><span class="n">raw_steamspy_data</span><span class="p">[</span><span class="s1">&#39;publisher&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>appid</th>
      <th>name</th>
      <th>developer</th>
      <th>publisher</th>
      <th>score_rank</th>
      <th>positive</th>
      <th>negative</th>
      <th>userscore</th>
      <th>owners</th>
      <th>average_forever</th>
      <th>average_2weeks</th>
      <th>median_forever</th>
      <th>median_2weeks</th>
      <th>price</th>
      <th>initialprice</th>
      <th>discount</th>
      <th>languages</th>
      <th>genre</th>
      <th>ccu</th>
      <th>tags</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>22993</th>
      <td>827660</td>
      <td>Feminist Cyborg Vs Last guy(gay)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0 .. 20,000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>489</th>
      <td>18310</td>
      <td>Spectraball - Demo</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0 .. 20,000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>5347</th>
      <td>349260</td>
      <td>BlastZone 2</td>
      <td>Matt Edzenga</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>50</td>
      <td>25</td>
      <td>0</td>
      <td>20,000 .. 50,000</td>
      <td>195</td>
      <td>0</td>
      <td>195</td>
      <td>0</td>
      <td>999.0</td>
      <td>999.0</td>
      <td>0.0</td>
      <td>English</td>
      <td>Action, Indie</td>
      <td>0</td>
      <td>{'Indie': 35, 'Action': 34, "Shoot 'Em Up": 18...</td>
    </tr>
    <tr>
      <th>2493</th>
      <td>259530</td>
      <td>Savant - Ascent</td>
      <td>D-Pad Studio</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2467</td>
      <td>179</td>
      <td>0</td>
      <td>200,000 .. 500,000</td>
      <td>209</td>
      <td>0</td>
      <td>294</td>
      <td>0</td>
      <td>199.0</td>
      <td>199.0</td>
      <td>0.0</td>
      <td>English, Japanese, Korean, Norwegian, Simplifi...</td>
      <td>Action, Indie</td>
      <td>3</td>
      <td>{'Action': 116, 'Indie': 102, 'Great Soundtrac...</td>
    </tr>
    <tr>
      <th>18285</th>
      <td>700580</td>
      <td>Rust - Staging Branch</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0 .. 20,000</td>
      <td>78</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>[]</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are a small number of rows with missing price data. This is another column we don't need, (as well as <code>initialprice</code> and <code>discount</code>), as we already have that data available in the other dataset.</p>
<p>It looks like these rows have a lot of other missing information as well, so if they haven't already been removed when cleaning other columns we'll remove them here.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">raw_steamspy_data</span><span class="p">[</span><span class="n">raw_steamspy_data</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[8]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>appid</th>
      <th>name</th>
      <th>developer</th>
      <th>publisher</th>
      <th>score_rank</th>
      <th>positive</th>
      <th>negative</th>
      <th>userscore</th>
      <th>owners</th>
      <th>average_forever</th>
      <th>average_2weeks</th>
      <th>median_forever</th>
      <th>median_2weeks</th>
      <th>price</th>
      <th>initialprice</th>
      <th>discount</th>
      <th>languages</th>
      <th>genre</th>
      <th>ccu</th>
      <th>tags</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4261</th>
      <td>321210</td>
      <td>Blade Symphony Beta</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0 .. 20,000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>18285</th>
      <td>700580</td>
      <td>Rust - Staging Branch</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0 .. 20,000</td>
      <td>78</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>22496</th>
      <td>813350</td>
      <td>Ben 10 VR</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0 .. 20,000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>15719</th>
      <td>630790</td>
      <td>PSYCHO-PASS</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0 .. 20,000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>12076</th>
      <td>530940</td>
      <td>BIOHAZARD 7 resident evil グロテスクVer.</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0 .. 20,000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>[]</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Again there are a small number of rows with missing language data. There are a couple of bigger titles here, but most are missing other data also. We'll go ahead and remove these rows and this should leave us with most troublesome rows dealt with.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">raw_steamspy_data</span><span class="p">[</span><span class="n">raw_steamspy_data</span><span class="p">[</span><span class="s1">&#39;languages&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[9]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>appid</th>
      <th>name</th>
      <th>developer</th>
      <th>publisher</th>
      <th>score_rank</th>
      <th>positive</th>
      <th>negative</th>
      <th>userscore</th>
      <th>owners</th>
      <th>average_forever</th>
      <th>average_2weeks</th>
      <th>median_forever</th>
      <th>median_2weeks</th>
      <th>price</th>
      <th>initialprice</th>
      <th>discount</th>
      <th>languages</th>
      <th>genre</th>
      <th>ccu</th>
      <th>tags</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>249</th>
      <td>8350</td>
      <td>Strong Bad's Cool Game for Attractive People: ...</td>
      <td>Telltale Games</td>
      <td>Telltale Games</td>
      <td>NaN</td>
      <td>12</td>
      <td>5</td>
      <td>0</td>
      <td>0 .. 20,000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>Adventure</td>
      <td>0</td>
      <td>{'Adventure': 20}</td>
    </tr>
    <tr>
      <th>1233</th>
      <td>94500</td>
      <td>Back to the Future: Ep 2 - Get Tannen!</td>
      <td>Telltale Games</td>
      <td>Telltale Games</td>
      <td>NaN</td>
      <td>1367</td>
      <td>162</td>
      <td>0</td>
      <td>500,000 .. 1,000,000</td>
      <td>91</td>
      <td>0</td>
      <td>91</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2</td>
      <td>{'Adventure': 131, 'Point &amp; Click': 116, 'Epis...</td>
    </tr>
    <tr>
      <th>2120</th>
      <td>243180</td>
      <td>The Harvest</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0 .. 20,000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>757</th>
      <td>34390</td>
      <td>Football Manager 2011 Demo</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0 .. 20,000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>[]</td>
    </tr>
    <tr>
      <th>569</th>
      <td>23140</td>
      <td>KrissX</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0 .. 20,000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>[]</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Remove-unwanted-columns">Remove unwanted columns<a class="anchor-link" href="#Remove-unwanted-columns">&#182;</a></h2><p>As mentioned, there are a number of columns present in the Steam dataset, so we can remove any of those with crossover. It makes sense that these exist because SteamSpy's data is retrieved by looking at Steam's data. We'll remove the <code>score_rank</code> column as it contains too many missing values, and we'll remove the <code>userscore</code> column as most rows have a value of 0 here, so it won't be useful.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">raw_steamspy_data</span><span class="p">[</span><span class="s1">&#39;userscore&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[10]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0      29177
100        4
84         4
95         3
55         3
Name: userscore, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are also three columns - <code>average_2weeks</code>, <code>median_2weeks</code>, (average and median playtime in the last 2 weeks) and <code>ccu</code> (Peak conccurrent users yesterday) - that provide information only relevant to the time the data was collected. Going forward this isn't going to be useful, as we're not interested in how games were performing at that specific time, so we'll remove those.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">drop_cols</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;score_rank&#39;</span><span class="p">,</span> <span class="c1"># too many missing values</span>
    <span class="s1">&#39;userscore&#39;</span><span class="p">,</span> <span class="c1"># too little variance (most have 0)</span>
    <span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="s1">&#39;developer&#39;</span><span class="p">,</span> <span class="s1">&#39;publisher&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="s1">&#39;initialprice&#39;</span><span class="p">,</span> <span class="s1">&#39;discount&#39;</span><span class="p">,</span> <span class="c1"># provided by Steam data</span>
    <span class="s1">&#39;average_2weeks&#39;</span><span class="p">,</span> <span class="s1">&#39;median_2weeks&#39;</span><span class="p">,</span> <span class="s1">&#39;ccu&#39;</span> <span class="c1"># not interested in temporally specific columns</span>
<span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One more column we could remove is the <code>languages</code> column, as we already have the <code>english</code> column in the Steam Data. Here in the SteamSpy data, languages is made up of a comma-separated list of all supported languages. This provides us with some more information so we can keep it for now.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">raw_steamspy_data</span><span class="p">[</span><span class="s1">&#39;languages&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[12]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0    English, French, German, Italian, Spanish - Sp...
1    English, French, German, Italian, Spanish - Sp...
2    English, French, German, Italian, Spanish - Spain
3    English, French, German, Italian, Spanish - Sp...
4                      English, French, German, Korean
Name: languages, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Process-&amp;-Export-Tags-Column">Process &amp; Export Tags Column<a class="anchor-link" href="#Process-&amp;-Export-Tags-Column">&#182;</a></h2><p>There are a couple of columns that require more specific handling, and the <code>tags</code> column is one of them. There will be a lot of overlap with the <code>genres</code> column, but the tags might provide just enough unique information to be worthwhile keeping.</p>
<p>Below we separate out the tags data for experimentation, then have a look a the first few rows. Each tag for a game has an associated number, corresponding to the amount of votes that game has for that tag. A game's tags with higher votes means that more people think it is a relevant tag for that title.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tags</span> <span class="o">=</span> <span class="n">raw_steamspy_data</span><span class="p">[</span><span class="s1">&#39;tags&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">tags</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">tags</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;Action&#39;: 2681, &#39;FPS&#39;: 2048, &#39;Multiplayer&#39;: 1659, &#39;Shooter&#39;: 1420, &#39;Classic&#39;: 1344, &#39;Team-Based&#39;: 943, &#39;First-Person&#39;: 799, &#39;Competitive&#39;: 790, &#39;Tactical&#39;: 734, &#34;1990&#39;s&#34;: 564, &#39;e-sports&#39;: 550, &#39;PvP&#39;: 480, &#39;Military&#39;: 367, &#39;Strategy&#39;: 329, &#39;Score Attack&#39;: 200, &#39;Survival&#39;: 192, &#39;Old School&#39;: 164, &#39;Assassin&#39;: 151, &#39;1980s&#39;: 144, &#39;Violent&#39;: 40}
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[13]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0    {&#39;Action&#39;: 2681, &#39;FPS&#39;: 2048, &#39;Multiplayer&#39;: 1...
1    {&#39;Action&#39;: 208, &#39;FPS&#39;: 188, &#39;Multiplayer&#39;: 172...
2    {&#39;FPS&#39;: 138, &#39;World War II&#39;: 122, &#39;Multiplayer...
3    {&#39;Action&#39;: 85, &#39;FPS&#39;: 71, &#39;Multiplayer&#39;: 58, &#39;...
4    {&#39;FPS&#39;: 235, &#39;Action&#39;: 211, &#39;Sci-fi&#39;: 166, &#39;Si...
Name: tags, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Just by looking at the first row you can see that there are probably going to be far too many tags to include without disrupting the dataset. We have a couple of options here. We could include just the names of the top 3 or 5 tags for a game - which should be easy enough as it looks like the tags are already in order from most votes to least - or we could create new columns for each tag, and the number of votes as the row values, like this:</p>
<table>
<thead><tr>
<th>appid</th>
<th>name</th>
<th>action</th>
<th>fps</th>
<th>multiplayer</th>
</tr>
</thead>
<tbody>
<tr>
<td>10</td>
<td>Shoot 'em up</td>
<td>2681</td>
<td>2048</td>
<td>0</td>
</tr>
<tr>
<td>20</td>
<td>Big Brawl</td>
<td>208</td>
<td>0</td>
<td>172</td>
</tr>
</tbody>
</table>
<p>In a way, we'll do both.</p>
<p>Because including the full tag information in the dataset may make it bulky and unwieldy, we'll only include the top three tags in the core dataset. As we did when cleaning the Steam Data, we'll also export the full tag data as a separate file. This means that if we want to use it as part of our analysis we can import and merge the data quite easily.</p>
<p>Before we can do that, we have to figure out how to handle and process the data. As we've seen previously, the data in each row is stored as a string containing a dictionary, so we have to use <code>literal_eval</code> to get python to "recognise" the dictionary first.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">eval_row</span> <span class="o">=</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">tags</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">eval_row</span><span class="p">[</span><span class="s1">&#39;Action&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eval_row</span><span class="p">[</span><span class="s1">&#39;FPS&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>2681
2048
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We also have to figure out how to get a list of all the different unique tags from across the dataset. As each row only contains the tags that it has votes for, we don't know from the outset the tag names or even how many different tags there are.</p>
<p>We could loop through the data and build a list of all the unique tag names using a dictionary or something similar, but instead we'll achieve the same thing much more easily using the <a href="https://docs.python.org/3/library/itertools.html?highlight=itertools#itertools.chain">chain</a> function from itertools. As seen below, it will take a variety of iterables and unpack them into a single sequence (we have to use list() here to force the generator to evaluate). We can then use the set function to obtain just the unique values from the returned sequence.</p>
<p>As you can see below, we can pass lists, tuples and dictionaries and they will all be handled. Also notice how only the key from the dictionary is returned (d) and not the value inside the key (e). This is really useful and means we can just pass the evaluated tags data as a series, and itertools will just extract the individual keys.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="c1"># list</span>
    <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">),</span> <span class="c1"># tuple</span>
    <span class="p">{</span><span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="s1">&#39;e&#39;</span><span class="p">}</span>  <span class="c1"># dictionary</span>
<span class="p">]</span>

<span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[15]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[&#39;a&#39;, &#39;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[16]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>{&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we tried to define a function now, we might run into a problem. It turns out not all of the rows have data stored as dictionaries. Seen below, there are a few hundred rows with an empty list.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tags</span><span class="p">[</span><span class="n">tags</span> <span class="o">==</span> <span class="s1">&#39;[]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[17]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>656</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This doesn't cause an issue when we generate our set of unique tag names, as any empty lists are ignored.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">parsed_tags</span> <span class="o">=</span> <span class="n">tags</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="n">cols</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">parsed_tags</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of unique tags:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">First few tags:&#39;</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">cols</span><span class="p">))[:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of unique tags: 371

First few tags: [&#39;1980s&#39;, &#34;1990&#39;s&#34;, &#39;2.5D&#39;, &#39;2D&#39;, &#39;2D Fighter&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>However to create the new dataframe from the tags and votes, we need to look inside the dictionaries in each row. We'll expand the logic to parse the tags using the <code>isintance</code> function to check each row for its type. If it is a dictionary, we return the dictionary. If it is a list, we'll return an empty dictionary <code>{}</code>. We'll also include an extra check in case there is anything else in the rows we haven't found yet.</p>
<p>Next, we loop through the tags store in <code>cols</code>, standardise the format of the new column names, then extract the vote count of each tag by checking if the tag name is in each row's dictionary of tags.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">parse_tags</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Something other than dict or list found&#39;</span><span class="p">)</span>

<span class="n">parsed_tags</span> <span class="o">=</span> <span class="n">tags</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">parse_tags</span><span class="p">)</span>
        
<span class="n">tag_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
    <span class="c1"># standardise column names</span>
    <span class="n">col_name</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="c1"># check if column in row&#39;s dictionary of tags and return that value if it is, or 0 if it isn&#39;t</span>
    <span class="n">tag_data</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">parsed_tags</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">tag_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[19]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1980s</th>
      <th>1990s</th>
      <th>2.5d</th>
      <th>2d</th>
      <th>2d_fighter</th>
      <th>360_video</th>
      <th>3d</th>
      <th>3d_platformer</th>
      <th>3d_vision</th>
      <th>4_player_local</th>
      <th>4x</th>
      <th>6dof</th>
      <th>atv</th>
      <th>abstract</th>
      <th>action</th>
      <th>action_rpg</th>
      <th>action_adventure</th>
      <th>addictive</th>
      <th>adventure</th>
      <th>agriculture</th>
      <th>aliens</th>
      <th>alternate_history</th>
      <th>america</th>
      <th>animation_&amp;_modeling</th>
      <th>anime</th>
      <th>arcade</th>
      <th>arena_shooter</th>
      <th>artificial_intelligence</th>
      <th>assassin</th>
      <th>asynchronous_multiplayer</th>
      <th>atmospheric</th>
      <th>audio_production</th>
      <th>bmx</th>
      <th>base_building</th>
      <th>baseball</th>
      <th>based_on_a_novel</th>
      <th>basketball</th>
      <th>batman</th>
      <th>battle_royale</th>
      <th>beat_em_up</th>
      <th>beautiful</th>
      <th>benchmark</th>
      <th>bikes</th>
      <th>blood</th>
      <th>board_game</th>
      <th>bowling</th>
      <th>building</th>
      <th>bullet_hell</th>
      <th>bullet_time</th>
      <th>crpg</th>
      <th>...</th>
      <th>text_based</th>
      <th>third_person</th>
      <th>third_person_shooter</th>
      <th>thriller</th>
      <th>time_attack</th>
      <th>time_management</th>
      <th>time_manipulation</th>
      <th>time_travel</th>
      <th>top_down</th>
      <th>top_down_shooter</th>
      <th>touch_friendly</th>
      <th>tower_defense</th>
      <th>trackir</th>
      <th>trading</th>
      <th>trading_card_game</th>
      <th>trains</th>
      <th>transhumanism</th>
      <th>turn_based</th>
      <th>turn_based_combat</th>
      <th>turn_based_strategy</th>
      <th>turn_based_tactics</th>
      <th>tutorial</th>
      <th>twin_stick_shooter</th>
      <th>typing</th>
      <th>underground</th>
      <th>underwater</th>
      <th>unforgiving</th>
      <th>utilities</th>
      <th>vr</th>
      <th>vr_only</th>
      <th>vampire</th>
      <th>video_production</th>
      <th>villain_protagonist</th>
      <th>violent</th>
      <th>visual_novel</th>
      <th>voice_control</th>
      <th>voxel</th>
      <th>walking_simulator</th>
      <th>war</th>
      <th>wargame</th>
      <th>warhammer_40k</th>
      <th>web_publishing</th>
      <th>werewolves</th>
      <th>western</th>
      <th>word_game</th>
      <th>world_war_i</th>
      <th>world_war_ii</th>
      <th>wrestling</th>
      <th>zombies</th>
      <th>e_sports</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>144</td>
      <td>564</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2681</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>151</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>550</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>71</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>208</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>15</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>26</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>99</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>80</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>122</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>85</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>22</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>77</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>211</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>87</td>
      <td>0</td>
      <td>122</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>73</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 371 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll have to add in the AppIDs, but apart from that this makes up the tag data that we'll export. Next we have to figure out how to extract just the top three tags for use in the core dataset.</p>
<p>It turns out this is a relatively simple process. As the keys are in order of highest votes to least, we can just extract the first 3 keys for each row. This may not be the safest approach, as dictionaries don't necessarily preserve key order, but it's fine for our purposes. We can then join these keys on a semicolon to create a list of the tags.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">parse_tags</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span><span class="mi">3</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    
<span class="n">tags</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">parse_tags</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[20]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0          Action;FPS;Multiplayer
1          Action;FPS;Multiplayer
2    FPS;World War II;Multiplayer
3          Action;FPS;Multiplayer
4               FPS;Action;Sci-fi
Name: tags, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Handle-Owners-Column">Handle Owners Column<a class="anchor-link" href="#Handle-Owners-Column">&#182;</a></h2><p>The final column we'll look at before defining a function to perform the cleaning is the <code>owners</code> column. This column is made up of the lower and upper bound of an estimation for the amount of owners for each title. For privacy reasons, SteamSpy can't get exact figures from Steam (though it <a href="https://www.polygon.com/2018/4/12/17229752/steam-spy-charts-new-privacy-rules-valve">used to</a>), so we'll have to make do with the figures we have here.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">owners</span> <span class="o">=</span> <span class="n">raw_steamspy_data</span><span class="p">[</span><span class="s1">&#39;owners&#39;</span><span class="p">]</span>
<span class="n">owners</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[21]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0    10,000,000 .. 20,000,000
1     5,000,000 .. 10,000,000
2     5,000,000 .. 10,000,000
3     5,000,000 .. 10,000,000
4     5,000,000 .. 10,000,000
Name: owners, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have a couple of options for how to deal with the data. We could remove the commas and split the data, keeping the lower or upper bound.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">owners_split</span> <span class="o">=</span> <span class="n">owners</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; .. &#39;</span><span class="p">)</span>
<span class="n">owners_split</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[22]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0    10000000
1     5000000
2     5000000
3     5000000
4     5000000
Name: owners, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We could calculate the mid-point between the points, and keep that.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">owners_split</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[23]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0    15000000
1     7500000
2     7500000
3     7500000
4     7500000
Name: owners, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Or we could reformat the data slightly, but pretty much keep it as is.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">owners</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; .. &#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[24]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0    10000000-20000000
1     5000000-10000000
2     5000000-10000000
3     5000000-10000000
4     5000000-10000000
Name: owners, dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll go with this last option. It allows us to keep the ranges and also easily modify the data in the future.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Define-Function">Define Function<a class="anchor-link" href="#Define-Function">&#182;</a></h2><p>We're now ready to define the functions to clean the data. We'll wrap all the logic inside a <code>process</code> function, and for most of the columns there isn't much code to write so we can confine it here. The only logic we'll separate out is for processing the tags column, as it is a more complex endeavour.</p>
<p>In the next code cell we clean the data, export the full tags data to file, and inspect the clean dataframe. After that we inspect the exported data, verifying everything went as planned.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">process_tags</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">export</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">export</span><span class="p">:</span> 
        
        <span class="n">tag_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;appid&#39;</span><span class="p">,</span> <span class="s1">&#39;tags&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        
        <span class="k">def</span> <span class="nf">parse_export_tags</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">x</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">{}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Something other than dict or list found&#39;</span><span class="p">)</span>

        <span class="n">tag_data</span><span class="p">[</span><span class="s1">&#39;tags&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tag_data</span><span class="p">[</span><span class="s1">&#39;tags&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">parse_export_tags</span><span class="p">)</span>

        <span class="n">cols</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">tag_data</span><span class="p">[</span><span class="s1">&#39;tags&#39;</span><span class="p">]))</span>

        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
            <span class="n">col_name</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

            <span class="n">tag_data</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tag_data</span><span class="p">[</span><span class="s1">&#39;tags&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">tag_data</span> <span class="o">=</span> <span class="n">tag_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;tags&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">tag_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../data/exports/steamspy_tag_data.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exported tag data to &#39;../data/exports/steamspy_tag_data.csv&#39;&quot;</span><span class="p">)</span>
        
        
    <span class="k">def</span> <span class="nf">parse_tags</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">literal_eval</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">keys</span><span class="p">())[:</span><span class="mi">3</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;tags&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;tags&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">parse_tags</span><span class="p">)</span>
    
    <span class="c1"># rows with null tags seem to be superseded by newer release, so remove (e.g. dead island)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tags&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>
    
    <span class="k">return</span> <span class="n">df</span>


<span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    
    <span class="c1"># handle missing values</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">)]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;developer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;languages&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()]</span>
    
    <span class="c1"># remove unwanted columns</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span>
        <span class="s1">&#39;genre&#39;</span><span class="p">,</span> <span class="s1">&#39;developer&#39;</span><span class="p">,</span> <span class="s1">&#39;publisher&#39;</span><span class="p">,</span> <span class="s1">&#39;score_rank&#39;</span><span class="p">,</span> <span class="s1">&#39;userscore&#39;</span><span class="p">,</span> <span class="s1">&#39;average_2weeks&#39;</span><span class="p">,</span>
        <span class="s1">&#39;median_2weeks&#39;</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="s1">&#39;initialprice&#39;</span><span class="p">,</span> <span class="s1">&#39;discount&#39;</span><span class="p">,</span> <span class="s1">&#39;ccu&#39;</span>
    <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="c1"># keep top tags, exporting full tag data to file</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">process_tags</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">export</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># reformat owners column</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;owners&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;owners&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; .. &#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">df</span>


<span class="n">steamspy_data</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">raw_steamspy_data</span><span class="p">)</span>
<span class="n">steamspy_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Exported tag data to &#39;../data/exports/steamspy_tag_data.csv&#39;
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[25]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>appid</th>
      <th>name</th>
      <th>positive</th>
      <th>negative</th>
      <th>owners</th>
      <th>average_forever</th>
      <th>median_forever</th>
      <th>languages</th>
      <th>tags</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>Counter-Strike</td>
      <td>124534</td>
      <td>3339</td>
      <td>10000000-20000000</td>
      <td>17612</td>
      <td>317</td>
      <td>English, French, German, Italian, Spanish - Sp...</td>
      <td>Action;FPS;Multiplayer</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>Team Fortress Classic</td>
      <td>3318</td>
      <td>633</td>
      <td>5000000-10000000</td>
      <td>277</td>
      <td>62</td>
      <td>English, French, German, Italian, Spanish - Sp...</td>
      <td>Action;FPS;Multiplayer</td>
    </tr>
    <tr>
      <th>2</th>
      <td>30</td>
      <td>Day of Defeat</td>
      <td>3416</td>
      <td>398</td>
      <td>5000000-10000000</td>
      <td>187</td>
      <td>34</td>
      <td>English, French, German, Italian, Spanish - Spain</td>
      <td>FPS;World War II;Multiplayer</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>Deathmatch Classic</td>
      <td>1273</td>
      <td>267</td>
      <td>5000000-10000000</td>
      <td>258</td>
      <td>184</td>
      <td>English, French, German, Italian, Spanish - Sp...</td>
      <td>Action;FPS;Multiplayer</td>
    </tr>
    <tr>
      <th>4</th>
      <td>50</td>
      <td>Half-Life: Opposing Force</td>
      <td>5250</td>
      <td>288</td>
      <td>5000000-10000000</td>
      <td>624</td>
      <td>415</td>
      <td>English, French, German, Korean</td>
      <td>FPS;Action;Sci-fi</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># inspect tag data</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/exports/steamspy_tag_data.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[26]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>appid</th>
      <th>1980s</th>
      <th>1990s</th>
      <th>2.5d</th>
      <th>2d</th>
      <th>2d_fighter</th>
      <th>360_video</th>
      <th>3d</th>
      <th>3d_platformer</th>
      <th>3d_vision</th>
      <th>4_player_local</th>
      <th>4x</th>
      <th>6dof</th>
      <th>atv</th>
      <th>abstract</th>
      <th>action</th>
      <th>action_rpg</th>
      <th>action_adventure</th>
      <th>addictive</th>
      <th>adventure</th>
      <th>agriculture</th>
      <th>aliens</th>
      <th>alternate_history</th>
      <th>america</th>
      <th>animation_&amp;_modeling</th>
      <th>anime</th>
      <th>arcade</th>
      <th>arena_shooter</th>
      <th>artificial_intelligence</th>
      <th>assassin</th>
      <th>asynchronous_multiplayer</th>
      <th>atmospheric</th>
      <th>audio_production</th>
      <th>bmx</th>
      <th>base_building</th>
      <th>baseball</th>
      <th>based_on_a_novel</th>
      <th>basketball</th>
      <th>batman</th>
      <th>battle_royale</th>
      <th>beat_em_up</th>
      <th>beautiful</th>
      <th>benchmark</th>
      <th>bikes</th>
      <th>blood</th>
      <th>board_game</th>
      <th>bowling</th>
      <th>building</th>
      <th>bullet_hell</th>
      <th>bullet_time</th>
      <th>...</th>
      <th>text_based</th>
      <th>third_person</th>
      <th>third_person_shooter</th>
      <th>thriller</th>
      <th>time_attack</th>
      <th>time_management</th>
      <th>time_manipulation</th>
      <th>time_travel</th>
      <th>top_down</th>
      <th>top_down_shooter</th>
      <th>touch_friendly</th>
      <th>tower_defense</th>
      <th>trackir</th>
      <th>trading</th>
      <th>trading_card_game</th>
      <th>trains</th>
      <th>transhumanism</th>
      <th>turn_based</th>
      <th>turn_based_combat</th>
      <th>turn_based_strategy</th>
      <th>turn_based_tactics</th>
      <th>tutorial</th>
      <th>twin_stick_shooter</th>
      <th>typing</th>
      <th>underground</th>
      <th>underwater</th>
      <th>unforgiving</th>
      <th>utilities</th>
      <th>vr</th>
      <th>vr_only</th>
      <th>vampire</th>
      <th>video_production</th>
      <th>villain_protagonist</th>
      <th>violent</th>
      <th>visual_novel</th>
      <th>voice_control</th>
      <th>voxel</th>
      <th>walking_simulator</th>
      <th>war</th>
      <th>wargame</th>
      <th>warhammer_40k</th>
      <th>web_publishing</th>
      <th>werewolves</th>
      <th>western</th>
      <th>word_game</th>
      <th>world_war_i</th>
      <th>world_war_ii</th>
      <th>wrestling</th>
      <th>zombies</th>
      <th>e_sports</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>144</td>
      <td>564</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2681</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>151</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>550</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>0</td>
      <td>71</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>208</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>15</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>26</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>30</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>99</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>80</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>122</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>85</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>22</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>50</td>
      <td>0</td>
      <td>77</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>211</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>87</td>
      <td>0</td>
      <td>122</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>73</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 372 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Merge-and-Export-Clean-Data">Merge and Export Clean Data<a class="anchor-link" href="#Merge-and-Export-Clean-Data">&#182;</a></h2><p>Before we wrap up, we'll check for any missing values and export the SteamSpy data to its own csv file. Then we'll look at combining the previously cleaned Steam data and the newly cleaned SteamSpy data into one cohesive dataset. This will give us options and flexibility for analysis in the future, and means we will have one csv file to begin looking at.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">steamspy_data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[27]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>appid              0
name               0
positive           0
negative           0
owners             0
average_forever    0
median_forever     0
languages          0
tags               0
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">steamspy_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../data/exports/steamspy_clean.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To combine the dataframes we can use the pandas <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.merge.html">merge</a> function, specifying which columns to merge upon. We'll keep the default <code>how='inner'</code> behaviour, meaning we only keep rows with data in both dataframes.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">steam_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/exports/steam_data_clean.csv&#39;</span><span class="p">)</span>
    
<span class="n">merged</span> <span class="o">=</span> <span class="n">steam_data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">steamspy_data</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;steam_appid&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;appid&#39;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;_steamspy&#39;</span><span class="p">))</span>
<span class="n">merged</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[29]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>steam_appid</th>
      <th>required_age</th>
      <th>platforms</th>
      <th>categories</th>
      <th>genres</th>
      <th>achievements</th>
      <th>release_date</th>
      <th>price</th>
      <th>english</th>
      <th>developer</th>
      <th>publisher</th>
      <th>appid</th>
      <th>name_steamspy</th>
      <th>positive</th>
      <th>negative</th>
      <th>owners</th>
      <th>average_forever</th>
      <th>median_forever</th>
      <th>languages</th>
      <th>tags</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Counter-Strike</td>
      <td>10</td>
      <td>0</td>
      <td>windows;mac;linux</td>
      <td>Multi-player;Online Multi-Player;Local Multi-P...</td>
      <td>Action</td>
      <td>0</td>
      <td>2000-11-01</td>
      <td>7.19</td>
      <td>1</td>
      <td>Valve</td>
      <td>Valve</td>
      <td>10</td>
      <td>Counter-Strike</td>
      <td>124534</td>
      <td>3339</td>
      <td>10000000-20000000</td>
      <td>17612</td>
      <td>317</td>
      <td>English, French, German, Italian, Spanish - Sp...</td>
      <td>Action;FPS;Multiplayer</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Team Fortress Classic</td>
      <td>20</td>
      <td>0</td>
      <td>windows;mac;linux</td>
      <td>Multi-player;Online Multi-Player;Local Multi-P...</td>
      <td>Action</td>
      <td>0</td>
      <td>1999-04-01</td>
      <td>3.99</td>
      <td>1</td>
      <td>Valve</td>
      <td>Valve</td>
      <td>20</td>
      <td>Team Fortress Classic</td>
      <td>3318</td>
      <td>633</td>
      <td>5000000-10000000</td>
      <td>277</td>
      <td>62</td>
      <td>English, French, German, Italian, Spanish - Sp...</td>
      <td>Action;FPS;Multiplayer</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Day of Defeat</td>
      <td>30</td>
      <td>0</td>
      <td>windows;mac;linux</td>
      <td>Multi-player;Valve Anti-Cheat enabled</td>
      <td>Action</td>
      <td>0</td>
      <td>2003-05-01</td>
      <td>3.99</td>
      <td>1</td>
      <td>Valve</td>
      <td>Valve</td>
      <td>30</td>
      <td>Day of Defeat</td>
      <td>3416</td>
      <td>398</td>
      <td>5000000-10000000</td>
      <td>187</td>
      <td>34</td>
      <td>English, French, German, Italian, Spanish - Spain</td>
      <td>FPS;World War II;Multiplayer</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Deathmatch Classic</td>
      <td>40</td>
      <td>0</td>
      <td>windows;mac;linux</td>
      <td>Multi-player;Online Multi-Player;Local Multi-P...</td>
      <td>Action</td>
      <td>0</td>
      <td>2001-06-01</td>
      <td>3.99</td>
      <td>1</td>
      <td>Valve</td>
      <td>Valve</td>
      <td>40</td>
      <td>Deathmatch Classic</td>
      <td>1273</td>
      <td>267</td>
      <td>5000000-10000000</td>
      <td>258</td>
      <td>184</td>
      <td>English, French, German, Italian, Spanish - Sp...</td>
      <td>Action;FPS;Multiplayer</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Half-Life: Opposing Force</td>
      <td>50</td>
      <td>0</td>
      <td>windows;mac;linux</td>
      <td>Single-player;Multi-player;Valve Anti-Cheat en...</td>
      <td>Action</td>
      <td>0</td>
      <td>1999-11-01</td>
      <td>3.99</td>
      <td>1</td>
      <td>Gearbox Software</td>
      <td>Valve</td>
      <td>50</td>
      <td>Half-Life: Opposing Force</td>
      <td>5250</td>
      <td>288</td>
      <td>5000000-10000000</td>
      <td>624</td>
      <td>415</td>
      <td>English, French, German, Korean</td>
      <td>FPS;Action;Sci-fi</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we can remove, reorder and rename some rows before exporting the complete, clean dataset.</p>
<p>We'll remove the SteamSpy rows with overlap - name, languages and AppID. Next we reindex the dataframe, reordering the columns so it makes a little more logical sense to look at, and then we rename some of the columns to make it a bit clearer what they describe.</p>
<p>This is a quick and simple step, but as we'll be making this data available for public use it's a very good idea to make it as user-friendly as possible.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># remove overlapping columns</span>
<span class="n">steam_clean</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;name_steamspy&#39;</span><span class="p">,</span> <span class="s1">&#39;languages&#39;</span><span class="p">,</span> <span class="s1">&#39;steam_appid&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># reindex to reorder columns</span>
<span class="n">steam_clean</span> <span class="o">=</span> <span class="n">steam_clean</span><span class="p">[[</span>
    <span class="s1">&#39;appid&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name&#39;</span><span class="p">,</span>
    <span class="s1">&#39;release_date&#39;</span><span class="p">,</span>
    <span class="s1">&#39;english&#39;</span><span class="p">,</span>
    <span class="s1">&#39;developer&#39;</span><span class="p">,</span>
    <span class="s1">&#39;publisher&#39;</span><span class="p">,</span>
    <span class="s1">&#39;platforms&#39;</span><span class="p">,</span>
    <span class="s1">&#39;required_age&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">,</span>
    <span class="s1">&#39;genres&#39;</span><span class="p">,</span>
    <span class="s1">&#39;tags&#39;</span><span class="p">,</span>
    <span class="s1">&#39;achievements&#39;</span><span class="p">,</span>
    <span class="s1">&#39;positive&#39;</span><span class="p">,</span>
    <span class="s1">&#39;negative&#39;</span><span class="p">,</span>
    <span class="s1">&#39;average_forever&#39;</span><span class="p">,</span>
    <span class="s1">&#39;median_forever&#39;</span><span class="p">,</span>
    <span class="s1">&#39;owners&#39;</span><span class="p">,</span>
    <span class="s1">&#39;price&#39;</span>
<span class="p">]]</span>

<span class="n">steam_clean</span> <span class="o">=</span> <span class="n">steam_clean</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span>
    <span class="s1">&#39;tags&#39;</span><span class="p">:</span> <span class="s1">&#39;steamspy_tags&#39;</span><span class="p">,</span>
    <span class="s1">&#39;positive&#39;</span><span class="p">:</span> <span class="s1">&#39;positive_ratings&#39;</span><span class="p">,</span>
    <span class="s1">&#39;negative&#39;</span><span class="p">:</span> <span class="s1">&#39;negative_ratings&#39;</span><span class="p">,</span>
    <span class="s1">&#39;average_forever&#39;</span><span class="p">:</span> <span class="s1">&#39;average_playtime&#39;</span><span class="p">,</span>
    <span class="s1">&#39;median_forever&#39;</span><span class="p">:</span> <span class="s1">&#39;median_playtime&#39;</span>
<span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">steam_clean</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[30]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>appid</th>
      <th>name</th>
      <th>release_date</th>
      <th>english</th>
      <th>developer</th>
      <th>publisher</th>
      <th>platforms</th>
      <th>required_age</th>
      <th>categories</th>
      <th>genres</th>
      <th>steamspy_tags</th>
      <th>achievements</th>
      <th>positive_ratings</th>
      <th>negative_ratings</th>
      <th>average_playtime</th>
      <th>median_playtime</th>
      <th>owners</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>Counter-Strike</td>
      <td>2000-11-01</td>
      <td>1</td>
      <td>Valve</td>
      <td>Valve</td>
      <td>windows;mac;linux</td>
      <td>0</td>
      <td>Multi-player;Online Multi-Player;Local Multi-P...</td>
      <td>Action</td>
      <td>Action;FPS;Multiplayer</td>
      <td>0</td>
      <td>124534</td>
      <td>3339</td>
      <td>17612</td>
      <td>317</td>
      <td>10000000-20000000</td>
      <td>7.19</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20</td>
      <td>Team Fortress Classic</td>
      <td>1999-04-01</td>
      <td>1</td>
      <td>Valve</td>
      <td>Valve</td>
      <td>windows;mac;linux</td>
      <td>0</td>
      <td>Multi-player;Online Multi-Player;Local Multi-P...</td>
      <td>Action</td>
      <td>Action;FPS;Multiplayer</td>
      <td>0</td>
      <td>3318</td>
      <td>633</td>
      <td>277</td>
      <td>62</td>
      <td>5000000-10000000</td>
      <td>3.99</td>
    </tr>
    <tr>
      <th>2</th>
      <td>30</td>
      <td>Day of Defeat</td>
      <td>2003-05-01</td>
      <td>1</td>
      <td>Valve</td>
      <td>Valve</td>
      <td>windows;mac;linux</td>
      <td>0</td>
      <td>Multi-player;Valve Anti-Cheat enabled</td>
      <td>Action</td>
      <td>FPS;World War II;Multiplayer</td>
      <td>0</td>
      <td>3416</td>
      <td>398</td>
      <td>187</td>
      <td>34</td>
      <td>5000000-10000000</td>
      <td>3.99</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>Deathmatch Classic</td>
      <td>2001-06-01</td>
      <td>1</td>
      <td>Valve</td>
      <td>Valve</td>
      <td>windows;mac;linux</td>
      <td>0</td>
      <td>Multi-player;Online Multi-Player;Local Multi-P...</td>
      <td>Action</td>
      <td>Action;FPS;Multiplayer</td>
      <td>0</td>
      <td>1273</td>
      <td>267</td>
      <td>258</td>
      <td>184</td>
      <td>5000000-10000000</td>
      <td>3.99</td>
    </tr>
    <tr>
      <th>4</th>
      <td>50</td>
      <td>Half-Life: Opposing Force</td>
      <td>1999-11-01</td>
      <td>1</td>
      <td>Gearbox Software</td>
      <td>Valve</td>
      <td>windows;mac;linux</td>
      <td>0</td>
      <td>Single-player;Multi-player;Valve Anti-Cheat en...</td>
      <td>Action</td>
      <td>FPS;Action;Sci-fi</td>
      <td>0</td>
      <td>5250</td>
      <td>288</td>
      <td>624</td>
      <td>415</td>
      <td>5000000-10000000</td>
      <td>3.99</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># export clean dataset</span>
<span class="n">steam_clean</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../data/steam_clean.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And with that, we have come to the end of the cleaning process. It's been a long journey and hopefully you've picked up something useful along the way, and now we can look ahead to analysing the data, creating some visualisations, and gaining some insights into the multi-billion dollar industry that is videogaming.</p>

</div>
</div>
</div>
 


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
</p>
<p>Thanks for joining me, and as always I welcome any feedback or suggestions you may have in the comments below.</p>
        </div>

        <div class="meta">
            <div>
                    <a href="https://nik-davis.github.io/tag/steam.html" class="tag">steam</a>
                    <a href="https://nik-davis.github.io/tag/jupyter.html" class="tag">jupyter</a>
                    <a href="https://nik-davis.github.io/tag/python.html" class="tag">python</a>
                    <a href="https://nik-davis.github.io/tag/data.html" class="tag">data</a>
                    <a href="https://nik-davis.github.io/tag/cleaning.html" class="tag">cleaning</a>
            </div>
        </div>
    </article>
</div>

    </div>

<!-- <footer>
    <p>
    © 2012-2017 Nik Davis, license <a href=""> </a>
    unless otherwise noted.
    Generated by <a href= "http://docs.getpelican.com/">Pelican</a>.
    </p>
</footer> -->

</body>
</html>